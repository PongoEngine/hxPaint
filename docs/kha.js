(function(tb,Ed){function na(a,b){function c(){}c.prototype=a;var d=new c,f;for(f in b)d[f]=b[f];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function wb(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=De++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}tb.kha=tb.kha||{};tb.kha.input=tb.kha.input||{};tb.kha._Color=
tb.kha._Color||{};var m={},w=function(){return E.__string_rec(this,"")},Nc=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};m.EReg=Nc;Nc.__name__=!0;Nc.prototype={r:null,match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new r("EReg::matched");},__class__:Nc};var G=function(){};m.HxOverrides=G;G.__name__=!0;G.strDate=function(a){switch(a.length){case 8:a=
a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return b=a.split(" "),a=b[0].split("-"),b=b[1].split(":"),new Date(a[0],a[1]-1,a[2],b[0],b[1],b[2]);default:throw new r("Invalid date format : "+a);}};G.cca=function(a,b){var c=a.charCodeAt(b);if(c==c)return c};G.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,
c)};G.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};G.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var Fd=function(){this.length=0};m.List=Fd;Fd.__name__=!0;Fd.prototype={h:null,q:null,length:null,add:function(a){a=new Gd(a,null);null==this.h?this.h=a:this.q.next=a;this.q=a;this.length++},iterator:function(){return new Hd(this.h)},__class__:Fd};var Gd=function(a,b){this.item=
a;this.next=b};m["_List.ListNode"]=Gd;Gd.__name__=!0;Gd.prototype={item:null,next:null,__class__:Gd};var Hd=function(a){this.head=a};m["_List.ListIterator"]=Hd;Hd.__name__=!0;Hd.prototype={head:null,hasNext:function(){return null!=this.head},next:function(){var a=this.head.item;this.head=this.head.next;return a},__class__:Hd};var me=function(){};m.Main=me;me.__name__=!0;me.main=function(){L.init({title:"hxPaint",width:1366,height:768},function(){C.loadEverything(function(){var a=new kb;a.window.addChild((new id(a)).addChild((new jd(a)).addChild(new Va(a)).addChild(new Va(a)).addChild(new Va(a)).addChild(new Va(a)).addChild(new Va(a))).addChild(new kd(a))).addChild((new ld(a)).addChild((new Jb(a,
"File")).addChild((new Wa(a)).addChild(new Xa(a,"New")).addChild(new Xa(a,"Save")))).addChild((new Jb(a,"Edit")).addChild((new Wa(a)).addChild(new Xa(a,"Undo")))).addChild((new Jb(a,"Help")).addChild((new Wa(a)).addChild(new Xa(a,"Documentation")).addChild(new Xa(a,"MiniGame")).addChild(new Xa(a,"About khaPow")))));a._layout.initLayout();var b=!1;L.notifyOnRender(function(c){b||(c.get_g2().set_font(C.fonts.Roboto_Black),c.get_g2().set_fontSize(18),b=!0);c.get_g2().begin(null,-1);a.render(c);c.get_g2().end()});
n.addTimeTask(function(){a.update(.016666666666666666)},0,.016666666666666666)})})};Math.__name__=!0;var ia=function(){};m.Reflect=ia;ia.__name__=!0;ia.field=function(a,b){try{return a[b]}catch(c){return null}};ia.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};var Ga=function(){};m.Std=Ga;Ga.__name__=!0;Ga.string=function(a){return E.__string_rec(a,"")};Ga.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=G.cca(a,1)&&88!=G.cca(a,1)||(b=parseInt(a));return isNaN(b)?
null:b};var oa=function(){};m.StringTools=oa;oa.__name__=!0;oa.endsWith=function(a,b){var c=b.length,d=a.length;return d>=c?G.substr(a,d-c,c)==b:!1};var fa=function(){};m.Type=fa;fa.__name__=!0;fa.resolveClass=function(a){a=m[a];return null!=a&&a.__name__?a:null};fa.resolveEnum=function(a){a=m[a];return null!=a&&a.__ename__?a:null};fa.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};fa.createEnum=function(a,b,c){var d=ia.field(a,b);if(null==d)throw new r("No such constructor "+
b);if(ia.isFunction(d)){if(null==c)throw new r("Constructor "+b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw new r("Constructor "+b+" does not need parameters");return d};fa.getInstanceFields=function(a){var b=[],c;for(c in a.prototype)b.push(c);G.remove(b,"__class__");G.remove(b,"__properties__");return b};var S={};m["_UInt.UInt_Impl_"]=S;S.__name__=!0;S.gt=function(a,b){var c=0>a;return c!=0>b?c:a>b};S.gte=function(a,b){var c=0>a;return c!=0>b?c:a>=b};S.toFloat=function(a){return 0>
a?4294967296+a:a+0};var Xb=function(){};m["haxe.IMap"]=Xb;Xb.__name__=!0;Xb.prototype={get:null,set:null,exists:null,remove:null,__class__:Xb};var ge=function(a,b){this.high=a;this.low=b};m["haxe._Int64.___Int64"]=ge;ge.__name__=!0;ge.prototype={high:null,low:null,__class__:ge};var T=function(){};m["haxe.Log"]=T;T.__name__=!0;T.trace=function(a,b){E.__trace(a,b)};var md=function(){};m["haxe._Unserializer.DefaultResolver"]=md;md.__name__=!0;md.prototype={resolveClass:function(a){return fa.resolveClass(a)},
resolveEnum:function(a){return fa.resolveEnum(a)},__class__:md};var Y=function(a){this.buf=a;this.length=a.length;this.pos=0;this.scache=[];this.cache=[];a=Y.DEFAULT_RESOLVER;null==a&&(a=new md,Y.DEFAULT_RESOLVER=a);this.resolver=a};m["haxe.Unserializer"]=Y;Y.__name__=!0;Y.initCodes=function(){for(var a=[],b=0,c=Y.BASE64.length;b<c;){var d=b++;a[Y.BASE64.charCodeAt(d)]=d}return a};Y.run=function(a){return(new Y(a)).unserialize()};Y.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,
readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45==d){if(this.pos!=c)break;b=!0}else{if(48>d||57<d)break;a=10*a+(d-48)}this.pos++}b&&(a*=-1);return a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return parseFloat(G.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new r("Invalid object");if(103==
this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new r("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw new r("Invalid enum format");var c=this.readDigits();if(0==c)return fa.createEnum(a,b);for(var d=[];0<c--;)d.push(this.unserialize());return fa.createEnum(a,b,d)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);
if(null==b)throw new r("Class not found "+a);return b;case 66:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new r("Enum not found "+a);return b;case 67:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new r("Class not found "+a);a=fa.createEmptyInstance(b);this.cache.push(a);a.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw new r("Invalid custom data");return a;case 77:a=new Yb;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)b=
this.unserialize(),a.set(b,this.unserialize());this.pos++;return a;case 82:a=this.readDigits();if(0>a||a>=this.scache.length)throw new r("Invalid string reference");return this.scache[a];case 97:a=[];for(this.cache.push(a);;){b=this.buf.charCodeAt(this.pos);if(104==b){this.pos++;break}117==b?(this.pos++,b=this.readDigits(),a[a.length+b-1]=null):a.push(this.unserialize())}return a;case 98:a=new Oc;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);){b=this.unserialize();var c=this.unserialize();
null!=pb[b]?a.setReserved(b,c):a.h[b]=c}this.pos++;return a;case 99:a=this.unserialize();b=this.resolver.resolveClass(a);if(null==b)throw new r("Class not found "+a);a=fa.createEmptyInstance(b);this.cache.push(a);this.unserializeObject(a);return a;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new r("Enum not found "+a);this.pos++;c=this.readDigits();var d=b.__constructs__.slice()[c];
if(null==d)throw new r("Unknown enum index "+a+"@"+c);a=this.unserializeEnum(b,d);this.cache.push(a);return a;case 107:return NaN;case 108:a=new Fd;for(this.cache.push(a);104!=this.buf.charCodeAt(this.pos);)a.add(this.unserialize());this.pos++;return a;case 109:return-Infinity;case 110:return null;case 111:return a={},this.cache.push(a),this.unserializeObject(a),a;case 112:return Infinity;case 113:a=new Cb;this.cache.push(a);for(b=this.buf.charCodeAt(this.pos++);58==b;)b=this.readDigits(),c=this.unserialize(),
a.h[b]=c,b=this.buf.charCodeAt(this.pos++);if(104!=b)throw new r("Invalid IntMap format");return a;case 114:a=this.readDigits();if(0>a||a>=this.cache.length)throw new r("Invalid reference");return this.cache[a];case 115:a=this.readDigits();d=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw new r("Invalid bytes length");var f=Y.CODES;null==f&&(f=Y.initCodes(),Y.CODES=f);var h=this.pos,g=a&3,e=h+(a-g);b=new ha(new pa(3*(a>>2)+(2<=g?g-1:0)));for(c=0;h<e;){var k=f[d.charCodeAt(h++)],
y=f[d.charCodeAt(h++)];b.b[c++]=(k<<2|y>>4)&255;k=f[d.charCodeAt(h++)];b.b[c++]=(y<<4|k>>2)&255;y=f[d.charCodeAt(h++)];b.b[c++]=(k<<6|y)&255}2<=g&&(y=f[d.charCodeAt(h++)],e=f[d.charCodeAt(h++)],b.b[c++]=(y<<2|e>>4)&255,3==g&&(d=f[d.charCodeAt(h++)],b.b[c++]=(e<<4|d>>2)&255));this.pos+=a;this.cache.push(b);return b;case 116:return!0;case 118:return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+
2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(a=G.strDate(G.substr(this.buf,this.pos,19)),this.pos+=19):(a=this.readFloat(),a=new Date(a)),this.cache.push(a),a;case 119:a=this.unserialize();b=this.resolver.resolveEnum(a);if(null==b)throw new r("Enum not found "+a);a=this.unserializeEnum(b,this.unserialize());this.cache.push(a);return a;case 120:throw r.wrap(this.unserialize());case 121:a=this.readDigits();
if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<a)throw new r("Invalid string length");b=G.substr(this.buf,this.pos,a);this.pos+=a;b=decodeURIComponent(b.split("+").join(" "));this.scache.push(b);return b;case 122:return 0}this.pos--;throw new r("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos);},__class__:Y};var ha=function(a){this.length=a.byteLength;this.b=new la(a);this.b.bufferValue=a;a.hxBytes=this;a.bytes=this.b};m["haxe.io.Bytes"]=ha;ha.__name__=!0;ha.ofData=
function(a){var b=a.hxBytes;return null!=b?b:new ha(a)};ha.prototype={length:null,b:null,data:null,blit:function(a,b,c,d){if(0>a||0>c||0>d||a+d>this.length||c+d>b.length)throw new r(Q.OutsideBounds);0==c&&d==b.b.byteLength?this.b.set(b.b,a):this.b.set(b.b.subarray(c,c+d),a)},sub:function(a,b){if(0>a||0>b||a+b>this.length)throw new r(Q.OutsideBounds);return new ha(this.b.buffer.slice(a+this.b.byteOffset,a+this.b.byteOffset+b))},getFloat:function(a){null==this.data&&(this.data=new we(this.b.buffer,
this.b.byteOffset,this.b.byteLength));return this.data.getFloat32(a,!0)},setInt32:function(a,b){null==this.data&&(this.data=new we(this.b.buffer,this.b.byteOffset,this.b.byteLength));this.data.setInt32(a,b,!0)},getString:function(a,b){if(0>a||0>b||a+b>this.length)throw new r(Q.OutsideBounds);for(var c="",d=this.b,f=String.fromCharCode,h=a,g=a+b;h<g;){var e=d[h++];if(128>e){if(0==e)break;c+=f(e)}else if(224>e)c+=f((e&63)<<6|d[h++]&127);else if(240>e){var k=d[h++];c+=f((e&31)<<12|(k&127)<<6|d[h++]&
127)}else{k=d[h++];var y=d[h++];e=(e&15)<<18|(k&127)<<12|(y&127)<<6|d[h++]&127;c+=f((e>>10)+55232);c+=f(e&1023|56320)}}return c},toString:function(){return this.getString(0,this.length)},__class__:ha};var Cb=function(){this.h={}};m["haxe.ds.IntMap"]=Cb;Cb.__name__=!0;Cb.__interfaces__=[Xb];Cb.prototype={h:null,set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];
return!0},__class__:Cb};var Yb=function(){this.h={__keys__:{}}};m["haxe.ds.ObjectMap"]=Yb;Yb.__name__=!0;Yb.__interfaces__=[Xb];Yb.prototype={h:null,set:function(a,b){var c=a.__id__||(a.__id__=++Yb.count);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},remove:function(a){a=a.__id__;if(null==this.h.__keys__[a])return!1;delete this.h[a];delete this.h.__keys__[a];return!0},__class__:Yb};var Oc=function(){this.h={}};
m["haxe.ds.StringMap"]=Oc;Oc.__name__=!0;Oc.__interfaces__=[Xb];Oc.prototype={h:null,rh:null,set:function(a,b){null!=pb[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=pb[a]?this.getReserved(a):this.h[a]},exists:function(a){return null!=pb[a]?this.existsReserved(a):this.h.hasOwnProperty(a)},setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+
a)},remove:function(a){if(null!=pb[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},__class__:Oc};var Id=function(){this.b=[]};m["haxe.io.BytesBuffer"]=Id;Id.__name__=!0;Id.prototype={b:null,getBytes:function(){var a=new ha((new la(this.b)).buffer);this.b=null;return a},__class__:Id};var nd=function(){};m["haxe.io.Input"]=nd;nd.__name__=!0;nd.prototype={bigEndian:null,readByte:function(){throw new r("Not implemented");
},readBytes:function(a,b,c){var d=c,f=a.b;if(0>b||0>c||b+c>a.length)throw new r(Q.OutsideBounds);try{for(;0<d;)f[b]=this.readByte(),++b,--d}catch(h){if(h instanceof r&&(h=h.val),!E.__instanceof(h,qb))throw h;}return c-d},readFullBytes:function(a,b,c){for(;0<c;){var d=this.readBytes(a,b,c);if(0==d)throw new r(Q.Blocked);b+=d;c-=d}},read:function(a){for(var b=new ha(new pa(a)),c=0;0<a;){var d=this.readBytes(b,c,a);if(0==d)throw new r(Q.Blocked);c+=d;a-=d}return b},readInt32:function(){var a=this.readByte(),
b=this.readByte(),c=this.readByte(),d=this.readByte();return this.bigEndian?d|c<<8|b<<16|a<<24:a|b<<8|c<<16|d<<24},readString:function(a){var b=new ha(new pa(a));this.readFullBytes(b,0,a);return b.toString()},__class__:nd};var Zb=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);if(0>b||0>c||b+c>a.length)throw new r(Q.OutsideBounds);this.b=a.b;this.pos=b;this.totlen=this.len=c};m["haxe.io.BytesInput"]=Zb;Zb.__name__=!0;Zb.__super__=nd;Zb.prototype=na(nd.prototype,{b:null,pos:null,len:null,totlen:null,
set_position:function(a){0>a?a=0:a>this.totlen&&(a=this.totlen);this.len=this.totlen-a;return this.pos=a},readByte:function(){if(0==this.len)throw new r(new qb);this.len--;return this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw new r(Q.OutsideBounds);if(0==this.len&&0<c)throw new r(new qb);this.len<c&&(c=this.len);var d=this.b;a=a.b;for(var f=0,h=c;f<h;){var g=f++;a[b+g]=d[this.pos+g]}this.pos+=c;this.len-=c;return c},__class__:Zb});var od=function(){};m["haxe.io.Output"]=
od;od.__name__=!0;od.prototype={bigEndian:null,writeByte:function(a){throw new r("Not implemented");},writeBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw new r(Q.OutsideBounds);a=a.b;for(var d=c;0<d;)this.writeByte(a[b]),++b,--d;return c},write:function(a){for(var b=a.length,c=0;0<b;){var d=this.writeBytes(a,c,b);if(0==d)throw new r(Q.Blocked);c+=d;b-=d}},writeFloat:function(a){this.writeInt32(Qa.floatToI32(a))},writeInt32:function(a){this.bigEndian?(this.writeByte(a>>>24),this.writeByte(a>>
16&255),this.writeByte(a>>8&255),this.writeByte(a&255)):(this.writeByte(a&255),this.writeByte(a>>8&255),this.writeByte(a>>16&255),this.writeByte(a>>>24))},__class__:od};var Pc=function(){this.b=new Id};m["haxe.io.BytesOutput"]=Pc;Pc.__name__=!0;Pc.__super__=od;Pc.prototype=na(od.prototype,{b:null,writeByte:function(a){this.b.b.push(a)},writeBytes:function(a,b,c){var d=this.b;if(0>b||0>c||b+c>a.length)throw new r(Q.OutsideBounds);a=a.b;var f=b;for(b+=c;f<b;){var h=f++;d.b.push(a[h])}return c},getBytes:function(){return this.b.getBytes()},
__class__:Pc});var qb=function(){};m["haxe.io.Eof"]=qb;qb.__name__=!0;qb.prototype={toString:function(){return"Eof"},__class__:qb};var Q=m["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Q.Blocked=["Blocked",0];Q.Blocked.toString=w;Q.Blocked.__enum__=Q;Q.Overflow=["Overflow",1];Q.Overflow.toString=w;Q.Overflow.__enum__=Q;Q.OutsideBounds=["OutsideBounds",2];Q.OutsideBounds.toString=w;Q.OutsideBounds.__enum__=Q;Q.Custom=function(a){a=["Custom",3,a];a.__enum__=
Q;a.toString=w;return a};var Qa=function(){};m["haxe.io.FPHelper"]=Qa;Qa.__name__=!0;Qa.i32ToFloat=function(a){var b=a>>>23&255,c=a&8388607;return 0==c&&0==b?0:(1-(a>>>31<<1))*(1+Math.pow(2,-23)*c)*Math.pow(2,b-127)};Qa.floatToI32=function(a){if(0==a)return 0;var b=0>a?-a:a,c=Math.floor(Math.log(b)/.6931471805599453);-127>c?c=-127:128<c&&(c=128);b=Math.round(8388608*(b/Math.pow(2,c)-1));8388608==b&&128>c&&(b=0,++c);return(0>a?-2147483648:0)|c+127<<23|b};Qa.i64ToDouble=function(a,b){var c=(b>>20&2047)-
1023,d=4294967296*(b&1048575)+2147483648*(a>>>31)+(a&2147483647);return 0==d&&-1023==c?0:(1-(b>>>31<<1))*(1+Math.pow(2,-52)*d)*Math.pow(2,c)};Qa.doubleToI64=function(a){var b=Qa.i64tmp;if(0==a)b.low=0,b.high=0;else if(isFinite(a)){var c=0>a?-a:a,d=Math.floor(Math.log(c)/.6931471805599453);c=Math.round(4503599627370496*(c/Math.pow(2,d)-1));b.low=c|0;b.high=(0>a?-2147483648:0)|d+1023<<20|c/4294967296|0}else 0<a?(b.low=0,b.high=2146435072):(b.low=0,b.high=-1048576);return b};var ne={};m["haxe.io._UInt8Array.UInt8Array_Impl_"]=
ne;ne.__name__=!0;ne.fromBytes=function(a,b,c){null==b&&(b=0);null==c&&(c=a.length-b);return new la(a.b.bufferValue,b,c)};var kb=function(){this.window=new pd(this);new Db(this.window);this._layout=new Ka(this.window)};m["hxPaint.Paint"]=kb;kb.__name__=!0;kb.render_impl=function(a,b){b.get_g2().scissor(Math.round(a.x.m_value),Math.round(a.y.m_value),Math.round(a.width.m_value),Math.round(a.height.m_value));a.draw(b);for(var c=0,d=a.children;c<d.length;){var f=d[c];++c;kb.render_impl(f,b)}};kb.update_impl=
function(a,b){a.update(b);for(var c=0,d=a.children;c<d.length;){var f=d[c];++c;kb.update_impl(f,b)}};kb.prototype={window:null,render:function(a){kb.render_impl(this.window,a)},update:function(a){kb.update_impl(this.window,a)},_layout:null,__class__:kb};var da=function(a){this.paint=a;this.x=new $b("");this.y=new $b("");this.width=new $b("");this.height=new $b("");this.children=[]};m["hxPaint.element.Rectangle"]=da;da.__name__=!0;da.getAll_impl=function(a,b,c){for(var d=0,f=a.children;d<f.length;){var h=
f[d];++d;(null==h?null:E.getClass(h))==b&&c.push(h)}d=0;for(a=a.children;d<a.length;)f=a[d],++d,da.getAll_impl(f,b,c)};da.prototype={x:null,y:null,width:null,height:null,children:null,paint:null,addChild:function(a){this.children.push(a);return this},update:function(a){},afterSolved:function(){},solve:function(a,b,c){},draw:function(a){},onDown:function(a,b){},onMove:function(a,b){},onUp:function(a,b){},getAll:function(a){var b=[];da.getAll_impl(this,a,b);return b},__class__:da};var id=function(a){da.call(this,
a)};m["hxPaint.element.Body"]=id;id.__name__=!0;id.__super__=da;id.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addValue(b.x,0)));a.addConstraint(x.equalsExpression(t.addVariable(this.y,this.height),t.addVariable(b.y,b.height)));c=this.height;var d=t.subtractValue(b.height,35);a.addConstraint(x.equalsVariable(d,c));a.addConstraint(t.equalsVariable(this.width,b.width))},__class__:id});var Va=function(a){da.call(this,a)};m["hxPaint.element.Button"]=
Va;Va.__name__=!0;Va.__super__=da;Va.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),x.addValue(t.addValue(b.x,0),5)));var d=this.width,f=t.subtractValue(b.width,10);a.addConstraint(x.equalsVariable(f,d));a.addConstraint(t.equalsVariable(this.height,this.width));null==c?a.addConstraint(x.equalsExpression(t.addValue(this.y,0),x.addValue(t.addValue(b.y,0),5))):a.addConstraint(x.equalsExpression(t.addValue(this.y,0),x.addValue(t.addVariable(c.y,
c.height),5)))},draw:function(a){a.get_g2().set_color(-14606047);a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value);this._isOn&&(a.get_g2().set_color(-5054501),a.get_g2().drawRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value,2))},onUp:function(a,b){this._isOn?this.turnOff():this.turnOn();this.turnOffOthers()},turnOn:function(){this._isOn=!0},turnOff:function(){this._isOn=!1},turnOffOthers:function(){for(var a=this.paint.window.getAll(Va),
b=0;b<a.length;){var c=a[b];++b;c!=this&&c.turnOff()}},_isOn:null,__class__:Va});var jd=function(a){da.call(this,a)};m["hxPaint.element.LeftColumn"]=jd;jd.__name__=!0;jd.__super__=da;jd.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addValue(b.x,0)));a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addValue(b.y,0)));a.addConstraint(t.equalsVariable(this.height,b.height));a.addConstraint(t.equalsValue(this.width,60))},draw:function(a){a.get_g2().set_color(-12040120);
a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value)},__class__:jd});var kd=function(a){da.call(this,a)};m["hxPaint.element.PixelContainer"]=kd;kd.__name__=!0;kd.__super__=da;kd.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addVariable(c.x,c.width)));a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addValue(b.y,0)));var d=this.width;c=t.subtractVariable(b.width,c.width);a.addConstraint(x.equalsVariable(c,
d));a.addConstraint(t.equalsVariable(this.height,b.height))},draw:function(a){a.get_g2().set_color(-1118482);a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value);a.get_g2().set_color(-12040120);a.get_g2().drawRect(this.x.m_value+2,this.y.m_value+1,this.width.m_value-2,this.height.m_value-2)},__class__:kd});var pd=function(a){da.call(this,a)};m["hxPaint.element.Window"]=pd;pd.__name__=!0;pd.__super__=da;pd.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(t.equalsValue(this.x,
0));a.addConstraint(t.equalsValue(this.y,0));a.addConstraint(t.equalsValue(this.width,L.windowWidth()));a.addConstraint(t.equalsValue(this.height,L.windowHeight()))},__class__:pd});var ld=function(a){da.call(this,a)};m["hxPaint.element.header.Header"]=ld;ld.__name__=!0;ld.__super__=da;ld.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addValue(b.x,0)));a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addValue(b.y,0)));var d=this.height;
c=t.subtractVariable(b.height,c.height);a.addConstraint(x.equalsVariable(c,d));a.addConstraint(t.equalsVariable(this.width,b.width))},draw:function(a){a.get_g2().set_color(-14606047);a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value)},__class__:ld});var Jb=function(a,b){da.call(this,a);this._title=b;this._isOpen=!1;this._width=C.fonts.Roboto_Black.width(18,this._title);this._height=C.fonts.Roboto_Black.height(18)};m["hxPaint.element.header.HeaderButton"]=Jb;
Jb.__name__=!0;Jb.__super__=da;Jb.prototype=na(da.prototype,{solve:function(a,b,c){null==c?a.addConstraint(x.equalsExpression(t.addValue(this.x,0),x.addValue(t.addValue(b.x,0),2))):a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addVariable(c.x,c.width)));a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addValue(b.y,0)));a.addConstraint(t.equalsVariable(this.height,b.height));a.addConstraint(t.equalsValue(this.width,this._width+50))},onUp:function(a,b){this._isOpen?this.close():
this.open();this.closeOthers()},open:function(){this._isOpen=!0;E.__cast(this.children[0],Wa).open()},close:function(){this._isOpen=!1;E.__cast(this.children[0],Wa).close()},closeOthers:function(){for(var a=this.paint.window.getAll(Jb),b=0;b<a.length;){var c=a[b];++b;c!=this&&c.close()}},draw:function(a){var b=this._isOpen?-16777216:-14606047;a.get_g2().set_color(b);a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value);a.get_g2().set_color(-1);b=this.x.m_value-
this._width/2+this.width.m_value/2;var c=this.y.m_value-this._height/2+this.height.m_value/2;a.get_g2().drawString(this._title,b,c)},_isOpen:null,_title:null,_width:null,_height:null,__class__:Jb});var Wa=function(a){da.call(this,a)};m["hxPaint.element.header.HeaderList"]=Wa;Wa.__name__=!0;Wa.__super__=da;Wa.prototype=na(da.prototype,{solve:function(a,b,c){a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addValue(b.x,0)));a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addVariable(b.y,
b.height)));a.addConstraint(t.equalsValue(this.width,180));b=this.children[this.children.length-1];a.addConstraint(x.equalsExpression(t.addVariable(this.y,this.height),t.addVariable(b.y,b.height)))},open:function(){for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;E.__cast(c,Xa).open()}},close:function(){for(var a=0,b=this.children;a<b.length;){var c=b[a];++a;E.__cast(c,Xa).close()}},draw:function(a){a.get_g2().set_color(-12040120);a.get_g2().fillRect(this.x.m_value,this.y.m_value,this.width.m_value,
this.height.m_value);a.get_g2().set_color(-14606047);a.get_g2().drawRect(this.x.m_value,this.y.m_value,this.width.m_value,this.height.m_value,2)},__class__:Wa});var Xa=function(a,b){da.call(this,a);this._title=b;this._height=C.fonts.Roboto_Black.height(18)};m["hxPaint.element.header.HeaderListItem"]=Xa;Xa.__name__=!0;Xa.__super__=da;Xa.prototype=na(da.prototype,{solve:function(a,b,c){null==c?a.addConstraint(x.equalsExpression(t.addValue(this.y,0),t.addValue(b.y,0))):a.addConstraint(x.equalsExpression(t.addValue(this.y,
0),t.addVariable(c.y,c.height)));a.addConstraint(x.equalsExpression(t.addValue(this.x,0),t.addValue(b.x,0)));a.addConstraint(t.equalsVariable(this.width,b.width));a.addEditVariable(this.height,1E3)},open:function(){this.paint._layout.suggest(this.height,40)},close:function(){this.paint._layout.suggest(this.height,0)},draw:function(a){a.get_g2().set_color(-1);var b=this.y.m_value-this._height/2+this.height.m_value/2;a.get_g2().drawString(this._title,this.x.m_value+20,b);a.get_g2().set_color(-14606047);
a.get_g2().drawLine(this.x.m_value,this.y.m_value,this.x.m_value+this.width.m_value,this.y.m_value,1)},_title:null,_height:null,__class__:Xa});var Db=function(a){this.initMouse(a)};m["hxPaint.input.Mouse"]=Db;Db.__name__=!0;Db.hitTest_impl=function(a,b,c,d){var f=a.x.m_value,h=a.width.m_value+f,g=a.y.m_value,e=a.height.m_value+g;f=f<=b&&h>=b&&g<=c&&e>=c;h=!1;for(g=a.children.length;0<g--;)if(Db.hitTest_impl(a.children[g],b,c,d)){h=!0;break}if(!h&&f)switch(d){case 0:a.onDown(b,c);break;case 1:a.onUp(b,
c);break;case 2:a.onMove(b,c)}return f?!0:h};Db.prototype={initMouse:function(a){fb.get().notify(function(b,c,d){Db.hitTest_impl(a,c,d,0)},function(b,c,d){Db.hitTest_impl(a,c,d,1)},function(b,c,d,f){Db.hitTest_impl(a,b,c,2)},function(a){})},__class__:Db};var Ka=function(a){this._solver=new Qc;this._window=a};m["hxPaint.layout.Layout"]=Ka;Ka.__name__=!0;Ka.solve_impl=function(a,b,c,d){a.solve(d,b,c);b=null;c=0;for(var f=a.children;c<f.length;){var h=f[c];++c;Ka.solve_impl(h,a,b,d);b=h}};Ka.afterSolved_impl=
function(a){a.afterSolved();var b=0;for(a=a.children;b<a.length;){var c=a[b];++b;Ka.afterSolved_impl(c)}};Ka.prototype={initLayout:function(){oe.reset(this._solver);Ka.solve_impl(this._window,null,null,this._solver);this._solver.updateVariables();Ka.afterSolved_impl(this._window)},suggest:function(a,b){this._solver.suggestValue(a,b);this._solver.updateVariables();Ka.afterSolved_impl(this._window)},_solver:null,_window:null,__class__:Ka};var Kb=function(a,b,c){this.m_expression=a;this.m_op=b;this.m_strength=
c};m["jasper._Constraint_"]=Kb;Kb.__name__=!0;Kb.fromExpression=function(a,b,c){a=Kb.reduce(a);c=he.clip(c);return new Kb(a,b,c)};Kb.reduce=function(a){for(var b=new cb,c=0,d=a.m_terms;c<d.length;){var f=d[c];++c;var h=f.m_variable,g=b;f=(g._map.exists(h)?g._map.get(h):0)+f.m_coefficient;g._map.exists(h)||g._keys.push(h);g._map.set(h,f)}c=[];for(d=G.iter(b._keys);d.hasNext();)h=d.next(),h=new db(h,b._map.exists(h)?b._map.get(h):0),c.push(h);return new Ya(c,a.m_constant)};Kb.prototype={m_expression:null,
m_strength:null,m_op:null,toString:function(){return"expression: ("+Ga.string(this.m_expression)+") strength: "+this.m_strength+" operator: "+Ga.string(this.m_op)},__class__:Kb};var gb=m["jasper.RelationalOperator"]={__ename__:!0,__constructs__:["OP_LE","OP_GE","OP_EQ"]};gb.OP_LE=["OP_LE",0];gb.OP_LE.toString=w;gb.OP_LE.__enum__=gb;gb.OP_GE=["OP_GE",1];gb.OP_GE.toString=w;gb.OP_GE.__enum__=gb;gb.OP_EQ=["OP_EQ",2];gb.OP_EQ.toString=w;gb.OP_EQ.__enum__=gb;var Jd={};m["jasper._Constraint.Constraint_Impl_"]=
Jd;Jd.__name__=!0;Jd._new=function(a,b,c){null==c&&(c=1001001E3);return Kb.fromExpression(a,b,c)};var qd=function(a){T.trace("UnsatisfiableConstraint: "+Ga.string(a),{fileName:"Errors.hx",lineNumber:16,className:"jasper.UnsatisfiableConstraint",methodName:"new"})};m["jasper.UnsatisfiableConstraint"]=qd;qd.__name__=!0;qd.prototype={__class__:qd};var Kd=function(a){T.trace("DuplicateConstraint: "+Ga.string(a),{fileName:"Errors.hx",lineNumber:32,className:"jasper.DuplicateConstraint",methodName:"new"})};
m["jasper.DuplicateConstraint"]=Kd;Kd.__name__=!0;Kd.prototype={__class__:Kd};var Ld=function(a){T.trace("UnknownEditVariable: "+Ga.string(a),{fileName:"Errors.hx",lineNumber:40,className:"jasper.UnknownEditVariable",methodName:"new"})};m["jasper.UnknownEditVariable"]=Ld;Ld.__name__=!0;Ld.prototype={__class__:Ld};var Md=function(a){T.trace("DuplicateEditVariable: "+Ga.string(a),{fileName:"Errors.hx",lineNumber:48,className:"jasper.DuplicateEditVariable",methodName:"new"})};m["jasper.DuplicateEditVariable"]=
Md;Md.__name__=!0;Md.prototype={__class__:Md};var Nd=function(){T.trace("BadRequiredStrength",{fileName:"Errors.hx",lineNumber:56,className:"jasper.BadRequiredStrength",methodName:"new"})};m["jasper.BadRequiredStrength"]=Nd;Nd.__name__=!0;Nd.prototype={__class__:Nd};var Od=function(a){T.trace("InternalSolverError: "+a,{fileName:"Errors.hx",lineNumber:64,className:"jasper.InternalSolverError",methodName:"new"})};m["jasper.InternalSolverError"]=Od;Od.__name__=!0;Od.prototype={__class__:Od};var Ya=function(a,
b){this.m_terms=a;this.m_constant=b};m["jasper._Expression_"]=Ya;Ya.__name__=!0;Ya.prototype={m_terms:null,m_constant:null,__class__:Ya};var x={};m["jasper._Expression.Expression_Impl_"]=x;x.__name__=!0;x.multiplyValue=function(a,b){for(var c=[],d=0,f=a.m_terms;d<f.length;){var h=f[d];++d;c.push(Za.multiplyValue(h,b))}return new Ya(c,a.m_constant*b)};x.negateExpression=function(a){return x.multiplyValue(a,-1)};x.addExpression=function(a,b){for(var c=[],d=0,f=a.m_terms;d<f.length;){var h=f[d];++d;
c.push(h)}d=0;for(f=b.m_terms;d<f.length;)h=f[d],++d,c.push(h);return new Ya(c,a.m_constant+b.m_constant)};x.addValue=function(a,b){return new Ya(a.m_terms,a.m_constant+b)};x.subtractExpression=function(a,b){return x.addExpression(a,x.negateExpression(b))};x.equalsExpression=function(a,b){return Jd._new(x.subtractExpression(a,b),gb.OP_EQ)};x.equalsTerm=function(a,b){var c=new Ya([b],0);return x.equalsExpression(a,c)};x.equalsVariable=function(a,b){var c=new db(b,1);return x.equalsTerm(a,c)};x.equalsValue=
function(a,b){var c=new Ya([],b);return x.equalsExpression(a,c)};var Lb=function(a){null==a&&(a=0);this.m_cells=new cb;this.m_constant=a};m["jasper.Row"]=Lb;Lb.__name__=!0;Lb.prototype={m_constant:null,m_cells:null,add:function(a){return this.m_constant+=a},insertSymbol:function(a,b){null==b&&(b=1);var c=this.m_cells,d=(c._map.exists(a)?c._map.get(a):0)+b;c._map.exists(a)||c._keys.push(a);c._map.set(a,d);ac.nearZero(d)&&(c=this.m_cells,c._map.remove(a)&&G.remove(c._keys,a))},insertRow:function(a,
b){null==b&&(b=1);this.m_constant+=a.m_constant*b;for(var c=new Ba(a.m_cells);c.hasNext();){var d=c.next(),f=d.second*b,h=d.first,g=this.m_cells;f=(g._map.exists(h)?g._map.get(h):0)+f;g._map.exists(h)||g._keys.push(h);g._map.set(h,f);ac.nearZero(f)&&(h=this.m_cells,d=d.first,h._map.remove(d)&&G.remove(h._keys,d))}},remove:function(a){var b=this.m_cells;b._map.remove(a)&&G.remove(b._keys,a)},reverseSign:function(){this.m_constant=-this.m_constant;for(var a=new Ba(this.m_cells);a.hasNext();){var b=
a.next(),c=this.m_cells,d=b.first;b=-b.second;c._map.exists(d)||c._keys.push(d);c._map.set(d,b)}},solveFor:function(a){var b=this.m_cells;b=-1/(b._map.exists(a)?b._map.get(a):0);var c=this.m_cells;c._map.remove(a)&&G.remove(c._keys,a);this.m_constant*=b;for(a=new Ba(this.m_cells);a.hasNext();){c=a.next().first;var d=this.m_cells,f=(d._map.exists(c)?d._map.get(c):0)*b;d._map.exists(c)||d._keys.push(c);d._map.set(c,f)}},solveForSymbols:function(a,b){this.insertSymbol(a,-1);this.solveFor(b)},coefficientFor:function(a){var b=
this.m_cells;return b._map.exists(a)?b._map.get(a):0},substitute:function(a,b){if(this.m_cells._map.exists(a)){var c=this.m_cells;c=c._map.exists(a)?c._map.get(a):0;var d=this.m_cells;d._map.remove(a)&&G.remove(d._keys,a);this.insertRow(b,c)}},__class__:Lb};var oe={};m["jasper._Solver.Solver_Impl_"]=oe;oe.__name__=!0;oe.reset=function(a){a.reset()};var Pd=function(){this.marker=new Ea;this.other=new Ea};m["jasper.Tag"]=Pd;Pd.__name__=!0;Pd.prototype={marker:null,other:null,__class__:Pd};var Qc=function(){this.m_cns=
new cb;this.m_rows=new cb;this.m_vars=new cb;this.m_edits=new cb;this.m_infeasible_rows=[];this.m_objective=new Lb;this.m_artificial=null};m["jasper.SolverImpl"]=Qc;Qc.__name__=!0;Qc.prototype={addConstraint:function(a){if(this.m_cns._map.exists(a))throw new r(new Kd(a));var b=new Pd,c=this.createRow(a,b),d=this.chooseSubject(c,b);if(0==d.m_type&&this.allDummies(c))if(ac.nearZero(c.m_constant))d=b.marker;else throw new r(new qd(a));if(0==d.m_type){if(!this.addWithArtificialVariable(c))throw new r(new qd(a));
}else{c.solveFor(d);this.substitute(d,c);var f=this.m_rows;f._map.exists(d)||f._keys.push(d);f._map.set(d,c)}c=this.m_cns;c._map.exists(a)||c._keys.push(a);c._map.set(a,b);this.optimize(this.m_objective)},addEditVariable:function(a,b){if(this.m_edits._map.exists(a))throw new r(new Md(a));b=he.clip(b);if(1001001E3==b)throw new r(new Nd);var c=new db(a,1);c=new Ya([c],0);var d=Jd._new(c,gb.OP_EQ,b);this.addConstraint(d);c={};c.tag=this.m_cns._map.get(d);c.constraint=d;c.constant=0;d=this.m_edits;d._map.exists(a)||
d._keys.push(a);d._map.set(a,c)},suggestValue:function(a,b){if(!this.m_edits._map.exists(a))throw new r(new Ld(a));var c=this.m_edits._map.get(a),d=b-c.constant;c.constant=b;if(this.m_rows._map.exists(c.tag.marker))0>this.m_rows._map.get(c.tag.marker).add(-d)&&this.m_infeasible_rows.push(c.tag.marker);else if(this.m_rows._map.exists(c.tag.other))0>this.m_rows._map.get(c.tag.other).add(d)&&this.m_infeasible_rows.push(c.tag.other);else for(var f=new Ba(this.m_rows);f.hasNext();){var h=f.next(),g=h.second.coefficientFor(c.tag.marker);
0!=g&&0>h.second.add(d*g)&&1!=h.first.m_type&&this.m_infeasible_rows.push(h.first)}this.dualOptimize()},updateVariables:function(){for(var a=new Ba(this.m_vars);a.hasNext();){var b=a.next(),c=b.first;this.m_rows._map.exists(b.second)?c.m_value=this.m_rows._map.get(b.second).m_constant:c.m_value=0}},reset:function(){this.m_cns=new cb;this.m_rows=new cb;this.m_vars=new cb;this.m_edits=new cb;this.m_infeasible_rows=[];this.m_objective=new Lb;this.m_artificial=null},getVarSymbol:function(a){if(this.m_vars._map.exists(a))return this.m_vars._map.get(a);
var b=new Ea(1),c=this.m_vars;c._map.exists(a)||c._keys.push(a);c._map.set(a,b);return b},createRow:function(a,b){var c=a.m_expression,d=new Lb(c.m_constant),f=0;for(c=c.m_terms;f<c.length;){var h=c[f];++f;if(!ac.nearZero(h.m_coefficient)){var g=this.getVarSymbol(h.m_variable);this.m_rows._map.exists(g)?d.insertRow(this.m_rows._map.get(g),h.m_coefficient):d.insertSymbol(g,h.m_coefficient)}}switch(a.m_op[1]){case 0:f=new Ea(2);b.marker=f;d.insertSymbol(f,1);1001001E3>a.m_strength&&(f=new Ea(3),b.other=
f,d.insertSymbol(f,-1),this.m_objective.insertSymbol(f,a.m_strength));break;case 1:f=new Ea(2);b.marker=f;d.insertSymbol(f,-1);1001001E3>a.m_strength&&(f=new Ea(3),b.other=f,d.insertSymbol(f,1),this.m_objective.insertSymbol(f,a.m_strength));break;case 2:1001001E3>a.m_strength?(f=new Ea(3),c=new Ea(3),b.marker=f,b.other=c,d.insertSymbol(f,-1),d.insertSymbol(c,1),this.m_objective.insertSymbol(f,a.m_strength),this.m_objective.insertSymbol(c,a.m_strength)):(f=new Ea(4),b.marker=f,d.insertSymbol(f))}0>
d.m_constant&&d.reverseSign();return d},chooseSubject:function(a,b){for(var c=new Ba(a.m_cells);c.hasNext();){var d=c.next();if(1==d.first.m_type)return d.first}return(2==b.marker.m_type||3==b.marker.m_type)&&0>a.coefficientFor(b.marker)?b.marker:(2==b.other.m_type||3==b.other.m_type)&&0>a.coefficientFor(b.other)?b.other:new Ea},addWithArtificialVariable:function(a){for(var b=new Ea(2),c=this.m_rows,d=new Lb(a.m_constant),f=new Ba(a.m_cells);f.hasNext();){var h=f.next(),g=d.m_cells,e=h.first;h=h.second;
g._map.exists(e)||g._keys.push(e);g._map.set(e,h)}c._map.exists(b)||c._keys.push(b);c._map.set(b,d);c=new Lb(a.m_constant);for(a=new Ba(a.m_cells);a.hasNext();)g=a.next(),d=c.m_cells,f=g.first,g=g.second,d._map.exists(f)||d._keys.push(f),d._map.set(f,g);this.m_artificial=c;this.optimize(this.m_artificial);a=ac.nearZero(this.m_artificial.m_constant);this.m_artificial=null;if(this.m_rows._map.exists(b)){c=this.m_rows._map.get(b);d=this.m_rows;d._map.remove(b)&&G.remove(d._keys,b);if(c.m_cells.empty())return a;
d=this.anyPivotableSymbol(c);if(0==d.m_type)return!1;c.solveForSymbols(b,d);this.substitute(d,c);f=this.m_rows;f._map.exists(d)||f._keys.push(d);f._map.set(d,c)}for(c=new Ba(this.m_rows);c.hasNext();)c.next().second.remove(b);this.m_objective.remove(b);return a},substitute:function(a,b){for(var c=new Ba(this.m_rows);c.hasNext();){var d=c.next();d.second.substitute(a,b);1!=d.first.m_type&&0>d.second.m_constant&&this.m_infeasible_rows.push(d.first)}this.m_objective.substitute(a,b);null!=this.m_artificial&&
this.m_artificial.substitute(a,b)},optimize:function(a){for(;;){var b=this.getEnteringSymbol(a);if(0==b.m_type)break;var c=this.getLeavingRow(b);if(null==c)throw new r(new Od("The objective is unbounded."));var d=this.m_rows,f=c.first;d._map.remove(f)&&G.remove(d._keys,f);c.second.solveForSymbols(c.first,b);this.substitute(b,c.second);d=this.m_rows;c=c.second;d._map.exists(b)||d._keys.push(b);d._map.set(b,c)}},dualOptimize:function(){for(;0!=this.m_infeasible_rows.length;){var a=this.m_infeasible_rows.pop(),
b=this.m_rows._map.get(a);if(null!=b&&0>b.m_constant){var c=this.getDualEnteringSymbol(b);if(0==c.m_type)throw new r(new Od("Dual optimize failed."));var d=this.m_rows;d._map.remove(a)&&G.remove(d._keys,a);b.solveForSymbols(a,c);this.substitute(c,b);a=this.m_rows;a._map.exists(c)||a._keys.push(c);a._map.set(c,b)}}},getEnteringSymbol:function(a){for(a=new Ba(a.m_cells);a.hasNext();){var b=a.next();if(4!=b.first.m_type&&0>b.second)return b.first}return new Ea},getDualEnteringSymbol:function(a){var b=
null,c=1.79769313486231E308;for(a=new Ba(a.m_cells);a.hasNext();){var d=a.next();if(0<d.second&&4!=d.first.m_type){var f=this.m_objective.coefficientFor(d.first)/d.second;f<c&&(c=f,b=d.first)}}return b},anyPivotableSymbol:function(a){for(a=new Ba(a.m_cells);a.hasNext();){var b=a.next();if(2==b.first.m_type||3==b.first.m_type)return b.first}return new Ea},getLeavingRow:function(a){for(var b=null,c=new Ba(this.m_rows);c.hasNext();){var d=c.next();if(1!=d.first.m_type){var f=d.second.coefficientFor(a);
if(0>f&&1.79769313486231E308>-d.second.m_constant/f){b=d;break}}}return b},allDummies:function(a){for(a=new Ba(a.m_cells);a.hasNext();)if(4!=a.next().first.m_type)return!1;return!0},m_cns:null,m_rows:null,m_vars:null,m_edits:null,m_infeasible_rows:null,m_objective:null,m_artificial:null,__class__:Qc};var he={};m["jasper._Strength.Strength_Impl_"]=he;he.__name__=!0;he.clip=function(a){return Math.max(0,Math.min(1001001E3,a))};var Ea=function(a){null==a&&(a=0);this.m_type=a};m["jasper.Symbol"]=Ea;Ea.__name__=
!0;Ea.prototype={m_type:null,__class__:Ea};var db=function(a,b){this.m_variable=a;this.m_coefficient=b};m["jasper._Term_"]=db;db.__name__=!0;db.prototype={m_variable:null,m_coefficient:null,__class__:db};var Za={};m["jasper._Term.Term_Impl_"]=Za;Za.__name__=!0;Za.multiplyValue=function(a,b){return new db(a.m_variable,a.m_coefficient*b)};Za.addTerm=function(a,b){var c=[];c.push(a);c.push(b);return new Ya(c,0)};Za.addVariable=function(a,b){var c=new db(b,1);return Za.addTerm(a,c)};Za.addValue=function(a,
b){return new Ya([a],b)};Za.equalsVariable=function(a,b){var c=new Ya([a],0);return x.equalsVariable(c,b)};Za.equalsValue=function(a,b){var c=new Ya([a],0);return x.equalsValue(c,b)};var ac=function(){};m["jasper.Util"]=ac;ac.__name__=!0;ac.nearZero=function(a){return 0>a?1E-8>-a:1E-8>a};var $b=function(a){this.m_name=a;this.m_value=0};m["jasper._Variable_"]=$b;$b.__name__=!0;$b.prototype={m_name:null,m_value:null,toString:function(){return"name: "+this.m_name+" value: "+this.m_value},__class__:$b};
var t={};m["jasper._Variable.Variable_Impl_"]=t;t.__name__=!0;t.multiplyValue=function(a,b){return new db(a,b)};t.negateVariable=function(a){return t.multiplyValue(a,-1)};t.addVariable=function(a,b){var c=new db(a,1);return Za.addVariable(c,b)};t.addValue=function(a,b){var c=new db(a,1);return Za.addValue(c,b)};t.subtractVariable=function(a,b){var c=t.negateVariable(b);return Za.addVariable(c,a)};t.subtractValue=function(a,b){return t.addValue(a,-b)};t.equalsVariable=function(a,b){var c=new db(a,
1);return Za.equalsVariable(c,b)};t.equalsValue=function(a,b){var c=new db(a,1);return Za.equalsValue(c,b)};var cb=function(){this._keys=[];this._map=new Yb};m["jasper.ds.JasperMap"]=cb;cb.__name__=!0;cb.__interfaces__=[Xb];cb.prototype={empty:function(){return 0==this._keys.length},exists:function(a){return null!=this._map.h.__keys__[a.__id__]},get:function(a){return this._map.h[a.__id__]},remove:function(a){return this._map.remove(a)?G.remove(this._keys,a):!1},set:function(a,b){null==this._map.h.__keys__[a.__id__]&&
this._keys.push(a);this._map.set(a,b)},_map:null,_keys:null,__class__:cb};var Ba=function(a){this._index=0;this._map=a;this._item={first:null,second:null}};m["jasper.ds._JasperMap.KeyValIterator"]=Ba;Ba.__name__=!0;Ba.prototype={hasNext:function(){return this._index<this._map._keys.length},next:function(){this._item.first=this._map._keys[this._index++];var a=this._map._map.get(this._item.first);this._item.second=a;return this._item},_map:null,_index:null,_item:null,__class__:Ba};var r=function(a){Error.call(this);
this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,r)};m["js._Boot.HaxeError"]=r;r.__name__=!0;r.wrap=function(a){return a instanceof Error?a:new r(a)};r.__super__=Error;r.prototype=na(Error.prototype,{val:null,__class__:r});var E=function(){};m["js.Boot"]=E;E.__name__=!0;E.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};E.__trace=function(a,b){var c=null!=b?b.fileName+":"+b.lineNumber+": ":"";c+=E.__string_rec(a,
"");if(null!=b&&null!=b.customParams)for(var d=0,f=b.customParams;d<f.length;){var h=f[d];++d;c+=","+E.__string_rec(h,"")}if("undefined"!=typeof document){var g=document.getElementById("haxe:trace");d=null!=g}else d=!1;d?g.innerHTML+=E.__unhtml(c)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(c)};E.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=E.__nativeClassName(a);return null!=a?E.__resolveNativeClass(a):null};
E.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,f=a.length;d<f;){var h=d++;c=2!=h?c+(","+E.__string_rec(a[h],b)):c+E.__string_rec(a[h],b)}return c+")"}c=a.length;d="[";b+="\t";for(f=0;f<c;)h=f++,d+=(0<h?",":"")+E.__string_rec(a[h],b);return d+
"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";f=null!=a.hasOwnProperty;for(c in a)f&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+E.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};E.__interfLoop=function(a,b){if(null==
a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,f=c.length;d<f;){var h=d++;h=c[h];if(h==b||E.__interfLoop(h,b))return!0}return E.__interfLoop(a.__super__,b)};E.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case xe:return"boolean"==typeof a;case Ee:return!0;case ye:return"number"==typeof a;case Fe:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==
typeof b){if(a instanceof b||E.__interfLoop(E.getClass(a),b))return!0}else{if("object"==typeof b&&E.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==Ge&&null!=a.__name__||b==He&&null!=a.__ename__?!0:a.__enum__==b}};E.__cast=function(a,b){if(E.__instanceof(a,b))return a;throw new r("Cannot cast "+Ga.string(a)+" to "+Ga.string(b));};E.__nativeClassName=function(a){a=E.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};E.__isNativeObj=function(a){return null!=
E.__nativeClassName(a)};E.__resolveNativeClass=function(a){return Ed[a]};var Ra=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};m["js.html.compat.ArrayBuffer"]=Ra;Ra.__name__=!0;Ra.sliceImpl=function(a,b){var c=new la(this,a,null==b?null:b-a),d=new pa(c.byteLength);(new la(d)).set(c);return d};Ra.prototype={byteLength:null,a:null,slice:function(a,b){return new Ra(this.a.slice(a,b))},__class__:Ra};
var Qd=function(a,b,c){this.buf=a;this.offset=null==b?0:b;this.length=null==c?a.byteLength-this.offset:c;if(0>this.offset||0>this.length||this.offset+this.length>a.byteLength)throw new r(Q.OutsideBounds);this.byteLength=this.length;this.byteOffset=this.offset;this.buffer=this.buf};m["js.html.compat.DataView"]=Qd;Qd.__name__=!0;Qd.prototype={buf:null,offset:null,length:null,byteLength:null,byteOffset:null,buffer:null,getInt8:function(a){a=this.buf.a[this.offset+a];return 128<=a?a-256:a},getUint8:function(a){return this.buf.a[this.offset+
a]},getInt16:function(a,b){var c=this.getUint16(a,b);return 32768<=c?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],f=this.buf.a[c++],h=this.buf.a[c++];c=this.buf.a[c++];return b?d|f<<8|h<<16|c<<24:c|h<<8|f<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return 0>c?c+4294967296:c},getFloat32:function(a,b){return Qa.i32ToFloat(this.getInt32(a,
b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return Qa.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){this.buf.a[a+this.offset]=0>b?b+128&255:b&255},setUint8:function(a,b){this.buf.a[a+this.offset]=b&255},setInt16:function(a,b,c){this.setUint16(a,0>b?b+65536:b,c)},setUint16:function(a,b,c){a+=this.offset;c?(this.buf.a[a]=b&255,this.buf.a[a++]=b>>8&255):(this.buf.a[a++]=b>>8&255,this.buf.a[a]=b&255)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,
b,c){a+=this.offset;c?(this.buf.a[a++]=b&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>>24):(this.buf.a[a++]=b>>>24,this.buf.a[a++]=b>>16&255,this.buf.a[a++]=b>>8&255,this.buf.a[a++]=b&255)},setFloat32:function(a,b,c){this.setUint32(a,Qa.floatToI32(b),c)},setFloat64:function(a,b,c){b=Qa.doubleToI64(b);c?(this.setUint32(a,b.low),this.setUint32(a,b.high)):(this.setUint32(a,b.high),this.setUint32(a,b.low))},__class__:Qd};var Eb=function(){};m["js.html.compat.Float32Array"]=
Eb;Eb.__name__=!0;Eb._new=function(a,b,c){if("number"==typeof a){var d=[];for(b=0;b<a;){var f=b++;d[f]=0}d.byteLength=d.length<<2;d.byteOffset=0;a=[];b=0;for(f=d.length<<2;b<f;)b++,a.push(0);d.buffer=new Ra(a)}else if(E.__instanceof(a,Ra)){null==b&&(b=0);null==c&&(c=a.byteLength-b>>2);d=[];for(f=0;f<c;){f++;var h=a.a[b++]|a.a[b++]<<8|a.a[b++]<<16|a.a[b++]<<24;d.push(Qa.i32ToFloat(h))}d.byteLength=d.length<<2;d.byteOffset=b;d.buffer=a}else if(a instanceof Array&&null==a.__enum__){d=a.slice();a=[];
for(b=0;b<d.length;)f=d[b],++b,f=Qa.floatToI32(f),a.push(f&255),a.push(f>>8&255),a.push(f>>16&255),a.push(f>>>24);d.byteLength=d.length<<2;d.byteOffset=0;d.buffer=new Ra(a)}else throw new r("TODO "+Ga.string(a));d.subarray=Eb._subarray;d.set=Eb._set;return d};Eb._set=function(a,b){if(E.__instanceof(a.buffer,Ra)){if(a.byteLength+b>this.byteLength)throw new r("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var f=c++;this[f+b]=a[f]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+
b>this.byteLength)throw new r("set() outside of range");c=0;for(d=a.length;c<d;)f=c++,this[f+b]=a[f]}else throw new r("TODO");};Eb._subarray=function(a,b){var c=Eb._new(this.slice(a,b));c.byteOffset=4*a;return c};var rb=function(){};m["js.html.compat.Uint8Array"]=rb;rb.__name__=!0;rb._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new Ra(c)}else if(E.__instanceof(a,Ra))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:
a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new Ra(c);else throw new r("TODO "+Ga.string(a));c.subarray=rb._subarray;c.set=rb._set;return c};rb._set=function(a,b){if(E.__instanceof(a.buffer,Ra)){if(a.byteLength+b>this.byteLength)throw new r("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var f=c++;this[f+b]=a[f]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+
b>this.byteLength)throw new r("set() outside of range");c=0;for(d=a.length;c<d;)f=c++,this[f+b]=a[f]}else throw new r("TODO");};rb._subarray=function(a,b){var c=rb._new(this.slice(a,b));c.byteOffset=a;return c};var Rc=function(){this.names=[]};m["kha._Assets.ImageList"]=Rc;Rc.__name__=!0;Rc.prototype={names:null,__class__:Rc};var Sc=function(){this.names=[]};m["kha._Assets.SoundList"]=Sc;Sc.__name__=!0;Sc.prototype={names:null,__class__:Sc};var Tc=function(){this.names=[]};m["kha._Assets.BlobList"]=
Tc;Tc.__name__=!0;Tc.prototype={names:null,__class__:Tc};var Uc=function(){this.names=["Roboto_Black"];this.Roboto_BlackDescription={files:["Roboto-Black.ttf"],type:"font",name:"Roboto_Black"};this.Roboto_BlackName="Roboto_Black";this.Roboto_Black=null};m["kha._Assets.FontList"]=Uc;Uc.__name__=!0;Uc.prototype={Roboto_Black:null,Roboto_BlackName:null,Roboto_BlackDescription:null,Roboto_BlackLoad:function(a){C.loadFont("Roboto_Black",function(b){a()})},Roboto_BlackUnload:function(){this.Roboto_Black.unload();
this.Roboto_Black=null},names:null,__class__:Uc};var rd=function(){this.names=[]};m["kha._Assets.VideoList"]=rd;rd.__name__=!0;rd.prototype={names:null,__class__:rd};var C=function(){};m["kha.Assets"]=C;C.__name__=!0;C.loadEverything=function(a,b,c){for(var d=0,f=0,h=fa.getInstanceFields(Tc);f<h.length;){var g=h[f];++f;oa.endsWith(g,"Load")&&(d+=1)}f=0;for(h=fa.getInstanceFields(Rc);f<h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&(d+=1);f=0;for(h=fa.getInstanceFields(Sc);f<h.length;)g=h[f],++f,oa.endsWith(g,
"Load")&&(d+=1);f=0;for(h=fa.getInstanceFields(Uc);f<h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&(d+=1);f=0;for(h=fa.getInstanceFields(rd);f<h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&(d+=1);if(0==d)a();else{var e=d;f=0;for(h=fa.getInstanceFields(Tc);f<h.length;)if(g=h[f],++f,oa.endsWith(g,"Load")){var k=G.substr(g,0,g.length-4);k=ia.field(C.blobs,k+"Description");null==b||b(k)?ia.field(C.blobs,g)(function(){--e;C.progress=1-e/d;0==e&&a()}):(--e,C.progress=1-e/d,0==e&&a())}f=0;for(h=fa.getInstanceFields(Rc);f<
h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&(k=G.substr(g,0,g.length-4),k=ia.field(C.images,k+"Description"),null==b||b(k)?ia.field(C.images,g)(function(){--e;C.progress=1-e/d;0==e&&a()}):(--e,C.progress=1-e/d,0==e&&a()));f=0;for(h=fa.getInstanceFields(Sc);f<h.length;)g=[h[f]],++f,oa.endsWith(g[0],"Load")&&(k=G.substr(g[0],0,g[0].length-4),k=[ia.field(C.sounds,k+"Description")],null==b||b(k[0])?ia.field(C.sounds,g[0])(function(b,f){return function(){null==c||c(b[0])?ia.field(C.sounds,f[0].substring(0,
f[0].length-4)).uncompress(function(){return function(){--e;C.progress=1-e/d;0==e&&a()}}()):(--e,C.progress=1-e/d,0==e&&a())}}(k,g)):(--e,C.progress=1-e/d,0==e&&a()));f=0;for(h=fa.getInstanceFields(Uc);f<h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&(k=G.substr(g,0,g.length-4),k=ia.field(C.fonts,k+"Description"),null==b||b(k)?ia.field(C.fonts,g)(function(){--e;C.progress=1-e/d;0==e&&a()}):(--e,C.progress=1-e/d,0==e&&a()));f=0;for(h=fa.getInstanceFields(rd);f<h.length;)g=h[f],++f,oa.endsWith(g,"Load")&&
(k=G.substr(g,0,g.length-4),k=ia.field(C.videos,k+"Description"),null==b||b(k)?ia.field(C.videos,g)(function(){--e;C.progress=1-e/d;0==e&&a()}):(--e,C.progress=1-e/d,0==e&&a()))}};C.loadImage=function(a,b){var c=ia.field(C.images,a+"Description");ta.loadImageFromDescription(c,function(c){C.images[a]=c;b(c)})};C.loadImageFromPath=function(a,b,c){ta.loadImageFromDescription({files:[a],readable:b},c)};C.get_imageFormats=function(){return ta.getImageFormats()};C.loadBlob=function(a,b){var c=ia.field(C.blobs,
a+"Description");ta.loadBlobFromDescription(c,function(c){C.blobs[a]=c;b(c)})};C.loadBlobFromPath=function(a,b){ta.loadBlobFromDescription({files:[a]},b)};C.loadSound=function(a,b){var c=ia.field(C.sounds,a+"Description");ta.loadSoundFromDescription(c,function(c){C.sounds[a]=c;b(c)})};C.loadSoundFromPath=function(a,b){ta.loadSoundFromDescription({files:[a]},b)};C.get_soundFormats=function(){return ta.getSoundFormats()};C.loadFont=function(a,b){var c=ia.field(C.fonts,a+"Description");ta.loadFontFromDescription(c,
function(c){C.fonts[a]=c;b(c)})};C.loadFontFromPath=function(a,b){ta.loadFontFromDescription({files:[a]},b)};C.get_fontFormats=function(){return["ttf"]};C.loadVideo=function(a,b){var c=ia.field(C.videos,a+"Description");ta.loadVideoFromDescription(c,function(c){C.videos[a]=c;b(c)})};C.loadVideoFromPath=function(a,b){ta.loadVideoFromDescription({files:[a]},b)};C.get_videoFormats=function(){return ta.getVideoFormats()};var Mb=function(){};m["kha.Canvas"]=Mb;Mb.__name__=!0;Mb.prototype={get_width:null,
get_height:null,get_g4:null,__class__:Mb};var Nb=function(){};m["kha.Resource"]=Nb;Nb.__name__=!0;var qa=function(){};m["kha.Image"]=qa;qa.__name__=!0;qa.__interfaces__=[Nb,Mb];qa.create=function(a,b,c,d){null==c&&(c=U.RGBA32);return null==e.gl?new eb(a,b,c,!1):new Ca(a,b,c,!1,0)};qa.fromImage=function(a,b){if(null==e.gl){var c=new eb(a.width,a.height,U.RGBA32,!1);c.image=a;c.createTexture();return c}c=new Ca(a.width,a.height,U.RGBA32,!1,0);c.image=a;c.createTexture();return c};qa.fromBytes=function(a,
b,c,d,f){null==d&&(d=U.RGBA32);return null!=e.gl?(b=new Ca(b,c,d,!1,0),b.image=b.bytesToArray(a),b.createTexture(),b):null};qa.fromVideo=function(a){if(null==e.gl){var b=new eb(a.element.videoWidth,a.element.videoHeight,U.RGBA32,!1);b.video=a.element;b.createTexture();return b}b=new Ca(a.element.videoWidth,a.element.videoHeight,U.RGBA32,!1,0);b.video=a.element;b.createTexture();return b};qa.get_nonPow2Supported=function(){return null!=e.gl};qa.prototype={lock:function(a){return null},unlock:function(){},
get_width:function(){return 0},get_height:function(){return 0},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g4:function(){return null},__class__:qa};var eb=function(a,b,c,d){this.myWidth=a;this.myHeight=b;this.format=c;this.renderTarget=d;this.video=this.image=null;d&&this.createTexture()};m["kha.CanvasImage"]=eb;eb.__name__=!0;eb.init=function(){var a=window.document.createElement("canvas");null!=a&&(eb.context=a.getContext("2d"),a.width=2048,a.height=2048,eb.context.globalCompositeOperation=
"copy")};eb.__super__=qa;eb.prototype=na(qa.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=e.gl&&(this.texture=e.gl.createTexture(),e.gl.bindTexture(3553,this.texture),e.gl.texParameteri(3553,
10240,9729),e.gl.texParameteri(3553,10241,9729),e.gl.texParameteri(3553,10242,33071),e.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=e.gl.createFramebuffer(),e.gl.bindFramebuffer(36160,this.frameBuffer),e.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),e.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),e.gl.bindFramebuffer(36160,null)):null!=this.video?e.gl.texImage2D(3553,0,6408,6408,5121,this.video):e.gl.texImage2D(3553,0,6408,
6408,5121,this.image),e.gl.bindTexture(3553,null))},bytes:null,lock:function(a){return this.bytes=new ha(new pa(this.format==U.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height()))},unlock:function(){if(null!=e.gl){this.texture=e.gl.createTexture();e.gl.bindTexture(3553,this.texture);e.gl.texParameteri(3553,10240,9729);e.gl.texParameteri(3553,10241,9729);e.gl.texParameteri(3553,10242,33071);e.gl.texParameteri(3553,10243,33071);e.gl.texImage2D(3553,0,6409,this.get_width(),
this.get_height(),0,6409,5121,new la(this.bytes.b.bufferValue));if(1282==e.gl.getError()){for(var a=new ha(new pa(this.get_width()*this.get_height()*4)),b=0,c=this.get_height();b<c;)for(var d=b++,f=0,h=this.get_width();f<h;){var g=f++,l=this.bytes,k=d*this.get_width()+g;l=l.b[k];k=d*this.get_width()*4+4*g;a.b[k]=l&255;k=d*this.get_width()*4+4*g+1;a.b[k]=l&255;k=d*this.get_width()*4+4*g+2;a.b[k]=l&255;g=d*this.get_width()*4+4*g+3;a.b[g]=255}e.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),
0,6408,5121,new la(a.b.bufferValue))}e.gl.bindTexture(3553,null);this.bytes=null}},__class__:eb});var bc=tb.kha._Color.Color_Impl_={};m["kha._Color.Color_Impl_"]=bc;bc.__name__=!0;bc.fromBytes=function(a,b,c,d){null==d&&(d=255);return bc._new(d<<24|a<<16|b<<8|c)};bc._new=function(a){return a};var pe=function(){};m["kha.CompilerDefines"]=pe;pe.__name__=!0;var Vc=function(){};m["kha.EnvironmentVariables"]=Vc;Vc.__name__=!0;Vc.prototype={__class__:Vc};var cc=function(a,b,c,d){this.windowId=a;this.graphics1=
b;this.graphics2=c;this.graphics4=d};m["kha.Framebuffer"]=cc;cc.__name__=!0;cc.__interfaces__=[Mb];cc.prototype={windowId:null,graphics1:null,graphics2:null,graphics4:null,init:function(a,b,c){this.graphics1=a;this.graphics2=b;this.graphics4=c},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return L.windowWidth(this.windowId)},get_height:function(){return L.windowHeight(this.windowId)},__class__:cc};var Rd=function(){};m["kha.AlignedQuad"]=Rd;
Rd.__name__=!0;Rd.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:Rd};var Sd=function(a,b,c,d,f,h,g,e){this.mySize=a;this.width=f;this.height=h;this.chars=g;this.baseline=b;for(a=0;a<g.length;)b=g[a],++a,b.yoff+=this.baseline;this.texture=qa.create(f,h,U.L8);g=this.texture.lock();for(b=a=0;b<h;)for(b++,c=0,d=f;c<d;){c++;var k=e.readU8(a);g.b[a]=k&255;++a}this.texture.unlock()};m["kha.KravurImage"]=Sd;Sd.__name__=!0;Sd.prototype={mySize:null,chars:null,
texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(a,b,c){if(a>=this.chars.length)return null;var d=1/this.width,f=1/this.height;a=this.chars[a];if(null==a)return null;b=Math.round(b+a.xoff);c=Math.round(c+a.yoff);var h=new Rd;h.x0=b;h.y0=c;h.x1=b+a.x1-a.x0;h.y1=c+a.y1-a.y0;h.s0=a.x0*d;h.t0=a.y0*f;h.s1=a.x1*d;h.t1=a.y1*f;h.xadvance=a.xadvance;return h},getCharWidth:function(a){return 32>a||a-32>=this.chars.length?0:this.chars[a-32].xadvance},
getHeight:function(){return this.mySize},stringWidth:function(a){a=new String(a);for(var b=0,c=0,d=a.length;c<d;){var f=c++;b+=this.getCharWidth(G.cca(a,f))}return b},charactersWidth:function(a,b,c){var d=0,f=b;for(b+=c;f<b;)c=f++,d+=this.getCharWidth(a[c]);return d},getBaselinePosition:function(){return this.baseline},__class__:Sd};var Ob=function(a){this.images=new Cb;this.blob=a};m["kha.Kravur"]=Ob;Ob.__name__=!0;Ob.__interfaces__=[Nb];Ob.prototype={blob:null,images:null,_get:function(a,b){var c=
null==b?a:1E4*a+b.length;if(!this.images.h.hasOwnProperty(c)){if(null==b){b=[];for(var d=32;256>d;){var f=d++;b.push(f)}}d=64;f=32;for(var h=Array(b.length),g=0,e=h.length;g<e;){var k=g++;h[k]=new Td}g=null;for(e=-1;0>e;)f<d?f*=2:d*=2,g=P.alloc(d*f),e=z.stbtt_BakeFontBitmap(this.blob,0,a,g,d,f,b,h);k=new Wc;z.stbtt_InitFont(k,this.blob,0);e=z.stbtt_GetFontVMetrics(k);k=z.stbtt_ScaleForPixelHeight(k,a);d=new Sd(a|0,Math.round(e.ascent*k),Math.round(e.descent*k),Math.round(e.lineGap*k),d,f,h,g);return this.images.h[c]=
d}return this.images.h[c]},height:function(a){return this._get(a).getHeight()},width:function(a,b){return this._get(a).stringWidth(b)},unload:function(){this.images=this.blob=null},__class__:Ob};var ta=function(){};m["kha.LoaderImpl"]=ta;ta.__name__=!0;ta.getImageFormats=function(){return["png","jpg","hdr"]};ta.loadImageFromDescription=function(a,b){var c=Object.prototype.hasOwnProperty.call(a,"readable")&&a.readable;if(oa.endsWith(a.files[0],".hdr"))ta.loadBlobFromDescription(a,function(a){a=K.parse(a.toBytes());
a=qa.fromBytes(ha.ofData(a.data.buffer),a.width,a.height,U.RGBA128,c?ua.DynamicUsage:ua.StaticUsage);b(a)});else{var d=window.document.createElement("img");d.onload=function(a){a=qa.fromImage(d,c);b(a)};d.src=a.files[0];d.crossOrigin=""}};ta.getSoundFormats=function(){var a=window.document.createElement("audio"),b=[];""!=a.canPlayType("audio/mp4")&&b.push("mp4");(e._hasWebAudio||""!=a.canPlayType("audio/ogg"))&&b.push("ogg");return b};ta.loadSoundFromDescription=function(a,b){if(e._hasWebAudio){if(""!=
window.document.createElement("audio").canPlayType("audio/mp4"))for(var c=0,d=a.files.length;c<d;){var f=c++;f=a.files[f];if(oa.endsWith(f,".mp4")){new sd(f,b);return}}c=0;for(d=a.files.length;c<d;)if(f=c++,f=a.files[f],oa.endsWith(f,".ogg")){new sd(f,b);break}}else if(e.mobile){if(""!=window.document.createElement("audio").canPlayType("audio/mp4"))for(c=0,d=a.files.length;c<d;)if(f=c++,f=a.files[f],oa.endsWith(f,".mp4")){new Xc(f,b);return}c=0;for(d=a.files.length;c<d;)if(f=c++,f=a.files[f],oa.endsWith(f,
".ogg")){new Xc(f,b);break}}else new Pb(a.files,b)};ta.getVideoFormats=function(){return["mp4","webm"]};ta.loadVideoFromDescription=function(a,b){dc.fromFile(a.files,b)};ta.loadBlobFromDescription=function(a,b){var c=new XMLHttpRequest;c.open("GET",a.files[0],!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(4==c.readyState)if(200<=c.status&&400>c.status||0==c.status&&""==c.statusText){var d=null,f=c.response;if(null!=f)d=new la(f),d=ha.ofData(d);else if(null!=c.responseBody){f=
VBArray(c.responseBody).toArray();d=new ha(new pa(f.length));for(var h=0,g=f.length;h<g;){var e=h++;d.b[e]=f[e]&255}}else T.trace("Error loading "+a.files[0],{fileName:"LoaderImpl.hx",lineNumber:145,className:"kha.LoaderImpl",methodName:"loadBlobFromDescription"}),window.console.log("loadBlob failed");b(new P(d))}else T.trace("Error loading "+a.files[0],{fileName:"LoaderImpl.hx",lineNumber:151,className:"kha.LoaderImpl",methodName:"loadBlobFromDescription"}),window.console.log("loadBlob failed")};
c.send(null)};ta.loadFontFromDescription=function(a,b){ta.loadBlobFromDescription(a,function(a){b(new Ob(a))})};var Ud=function(){};m["kha.TimeTask"]=Ud;Ud.__name__=!0;Ud.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:Ud};var qe=function(){};m["kha.FrameTask"]=qe;qe.__name__=!0;qe.prototype={task:null,priority:null,active:null,paused:null,__class__:qe};var n=function(){};m["kha.Scheduler"]=n;n.__name__=!0;n.init=function(){n.deltas=
[];for(var a=0,b=n.DIF_COUNT;a<b;){var c=a++;n.deltas[c]=0}n.stopped=!0;n.frame_tasks_sorted=!0;n.current=n.lastTime=n.realTime();n.currentFrameTaskId=0;n.currentTimeTaskId=0;n.currentGroupId=0;n.timeTasks=[];n.pausedTimeTasks=[];n.outdatedTimeTasks=[];n.timeTasksScratchpad=[];n.frameTasks=[];n.toDeleteFrame=[]};n.start=function(a){null==a&&(a=!1);n.vsync=L.get_vsync();var b=L.get_refreshRate();57<=b&&63>=b&&(b=60);n.onedifhz=1/b;n.stopped=!1;n.resetTime();n.lastTime=n.realTime()-n.startTime;b=0;
for(var c=n.DIF_COUNT;b<c;){var d=b++;n.deltas[d]=0}if(a){a=0;for(b=n.timeTasks;a<b.length;)c=b[a],++a,c.paused=!1;a=0;for(b=n.frameTasks;a<b.length;)c=b[a],++a,c.paused=!1}};n.executeFrame=function(){var a=n.realTime()-n.startTime-n.lastTime,b=n.current;if(!(0>a)){if(a>n.maxframetime)n.startTime+=a-n.maxframetime,a=n.maxframetime,b+=a;else if(n.vsync){for(var c=n.onedifhz;c<a-n.onedifhz;)c+=n.onedifhz;a=c;for(var d=0,f=n.DIF_COUNT-2;d<f;){var h=d++;a+=n.deltas[h];n.deltas[h]=n.deltas[h+1]}a+=n.deltas[n.DIF_COUNT-
2];a/=n.DIF_COUNT;n.deltas[n.DIF_COUNT-2]=c;b+=a}else{c=0;for(d=n.DIF_COUNT-1;c<d;)f=c++,n.deltas[f]=n.deltas[f+1];n.deltas[n.DIF_COUNT-1]=a;d=c=0;for(f=n.DIF_COUNT;d<f;)h=d++,c+=n.deltas[h];c/=n.DIF_COUNT;b+=c}n.lastTime=b;n.stopped||(n.current=b);c=0;for(d=n.pausedTimeTasks;c<d.length;)f=d[c],++c,f.next+=a;if(n.stopped)for(c=0,d=n.timeTasks;c<d.length;)f=d[c],++c,f.next+=a;for(;0<n.timeTasks.length;)if(n.activeTimeTask=n.timeTasks[0],n.activeTimeTask.next<=b)n.activeTimeTask.next+=n.activeTimeTask.period,
G.remove(n.timeTasks,n.activeTimeTask),n.activeTimeTask.active&&n.activeTimeTask.task()?0<n.activeTimeTask.period&&(0==n.activeTimeTask.duration||n.activeTimeTask.duration>=n.activeTimeTask.start+n.activeTimeTask.next)?n.insertSorted(n.timeTasks,n.activeTimeTask):n.archiveTimeTask(n.activeTimeTask,b):(n.activeTimeTask.active=!1,n.archiveTimeTask(n.activeTimeTask,b));else break;n.activeTimeTask=null;n.sortFrameTasks();a=0;for(b=n.frameTasks;a<b.length;)c=b[a],++a,n.stopped||c.paused||!c.active||c.task()||
(c.active=!1);a=0;for(b=n.frameTasks;a<b.length;)c=b[a],++a,c.active||n.toDeleteFrame.push(c);for(;0<n.toDeleteFrame.length;)G.remove(n.frameTasks,n.toDeleteFrame.pop())}};n.archiveTimeTask=function(a,b){};n.realTime=function(){return L.get_time()};n.resetTime=function(){var a=L.get_time(),b=a-n.startTime;n.startTime=a;a=0;for(var c=n.timeTasks;a<c.length;){var d=c[a];++a;d.start-=b;d.next-=b}b=0;for(a=n.DIF_COUNT;b<a;)c=b++,n.deltas[c]=0;n.current=0;n.lastTime=0};n.addBreakableTimeTaskToGroup=function(a,
b,c,d,f){null==f&&(f=0);null==d&&(d=0);var h=new Ud;h.active=!0;h.task=b;h.id=++n.currentTimeTaskId;h.groupId=a;h.start=n.current+c;h.period=0;0!=d&&(h.period=d);h.duration=0;0!=f&&(h.duration=h.start+f);h.next=h.start;n.insertSorted(n.timeTasks,h);return h.id};n.addTimeTaskToGroup=function(a,b,c,d,f){null==f&&(f=0);null==d&&(d=0);return n.addBreakableTimeTaskToGroup(a,function(){b();return!0},c,d,f)};n.addTimeTask=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);return n.addTimeTaskToGroup(0,a,b,
c,d)};n.insertSorted=function(a,b){for(var c=0,d=a.length;c<d;){var f=c++;if(a[f].next>b.next){a.splice(f,0,b);return}}a.push(b)};n.sortFrameTasks=function(){n.frame_tasks_sorted||(n.frameTasks.sort(function(a,b){return a.priority>b.priority?1:a.priority<b.priority?-1:0}),n.frame_tasks_sorted=!0)};var xa=m["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"]};xa.RotationNone=["RotationNone",0];xa.RotationNone.toString=w;xa.RotationNone.__enum__=
xa;xa.Rotation90=["Rotation90",1];xa.Rotation90.toString=w;xa.Rotation90.__enum__=xa;xa.Rotation180=["Rotation180",2];xa.Rotation180.toString=w;xa.Rotation180.__enum__=xa;xa.Rotation270=["Rotation270",3];xa.Rotation270.toString=w;xa.Rotation270.__enum__=xa;var A=function(){};m["kha.Shaders"]=A;A.__name__=!0;A.init=function(){for(var a=[],b=0;3>b;){var c=b++;c=ia.field(A,"painter_colored_fragData"+c);c=Y.run(c);a.push(P.fromBytes(c))}A.painter_colored_frag=new Yc(a,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl",
"painter-colored-webgl2.frag.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_colored_vertData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_colored_vert=new ec(a,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_image_fragData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_image_frag=new Yc(a,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);a=[];
for(b=0;3>b;)c=b++,c=ia.field(A,"painter_image_vertData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_image_vert=new ec(a,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_text_fragData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_text_frag=new Yc(a,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_text_vertData"+
c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_text_vert=new ec(a,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_video_fragData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_video_frag=new Yc(a,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);a=[];for(b=0;3>b;)c=b++,c=ia.field(A,"painter_video_vertData"+c),c=Y.run(c),a.push(P.fromBytes(c));A.painter_video_vert=
new ec(a,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"])};var Ha=function(){};m["kha.Sound"]=Ha;Ha.__name__=!0;Ha.__interfaces__=[Nb];Ha.prototype={compressedData:null,uncompressedData:null,uncompress:function(a){var b=new Pc,c=hb.readAll(this.compressedData,b,!0);b=b.getBytes();var d=b.length/4|0;if(1==c.channel)for(this.uncompressedData=Array(2*d),c=0;c<d;){var f=c++;this.uncompressedData[2*f]=b.getFloat(4*f);this.uncompressedData[2*f+1]=b.getFloat(4*
f)}else for(this.uncompressedData=Array(d),c=0;c<d;)f=c++,this.uncompressedData[f]=b.getFloat(4*f);this.compressedData=null;a()},__class__:Ha};var L=function(){};m["kha.System"]=L;L.__name__=!0;L.init=function(a,b){null==a.title&&(a.title="Kha");null==a.width&&(a.width=800);null==a.height&&(a.height=600);null==a.samplesPerPixel&&(a.samplesPerPixel=1);null==a.vSync&&(a.vSync=!0);null==a.windowMode&&(a.windowMode=lb.Window);null==a.resizable&&(a.resizable=!1);null==a.maximizable&&(a.maximizable=!1);
null==a.minimizable&&(a.minimizable=!0);L.theTitle=a.title;e.init(a,b)};L.notifyOnRender=function(a,b){for(null==b&&(b=0);b>=L.renderListeners.length;)L.renderListeners.push([]);L.renderListeners[b].push(a)};L.render=function(a,b){if(0!=L.renderListeners.length)for(var c=0,d=L.renderListeners[a];c<d.length;){var f=d[c];++c;f(b)}};L.foreground=function(){for(var a=0,b=L.foregroundListeners;a<b.length;){var c=b[a];++a;c()}};L.background=function(){for(var a=0,b=L.backgroundListeners;a<b.length;){var c=
b[a];++a;c()}};L.get_time=function(){return e.getTime()};L.windowWidth=function(a){null==a&&(a=0);return e.windowWidth(a)};L.windowHeight=function(a){null==a&&(a=0);return e.windowHeight(a)};L.get_vsync=function(){return e.getVsync()};L.get_refreshRate=function(){return e.getRefreshRate()};var Vd=function(){this.axes=[];this.buttons=[]};m["kha.GamepadStates"]=Vd;Vd.__name__=!0;Vd.prototype={axes:null,buttons:null,__class__:Vd};var e=function(){};m["kha.SystemImpl"]=e;e.__name__=!0;e.init=function(a,
b){e.options=a;e.mobile=e.isMobile();e.chrome=e.isChrome();e.firefox=e.isFirefox();e.init2();b()};e.isMobile=function(){var a=window.navigator.userAgent;return 0<=a.indexOf("Android")||0<=a.indexOf("webOS")||0<=a.indexOf("iPhone")||0<=a.indexOf("iPad")||0<=a.indexOf("iPod")||0<=a.indexOf("BlackBerry")||0<=a.indexOf("Windows Phone")?!0:!1};e.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")?!0:!1};e.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")?
!0:!1};e.windowWidth=function(a){return 0==e.khanvas.width&&null!=e.options.width?e.options.width:e.khanvas.width};e.windowHeight=function(a){return 0==e.khanvas.height&&null!=e.options.height?e.options.height:e.khanvas.height};e.setCanvas=function(a){e.khanvas=a};e.getTime=function(){return(window.performance?window.performance:window.Date).now()/1E3};e.getVsync=function(){return!0};e.getRefreshRate=function(){return 60};e.init2=function(a){T.trace=E.__trace;e.keyboard=new fc;e.mouse=new Wd;e.surface=
new Xd;e.gamepads=[];e.gamepadStates=[];for(a=0;4>a;){var b=a++;e.gamepads[b]=new gc(b);e.gamepadStates[b]=new Vd}e.pressedKeys=[];for(a=0;256>a;)a++,e.pressedKeys.push(!1);for(a=0;256>a;)a++,e.pressedKeys.push(null);window.document.addEventListener("copy",function(a){if(null!=L.copyListener){var b=L.copyListener();null!=b&&a.clipboardData.setData("text/plain",b);a.preventDefault()}});window.document.addEventListener("cut",function(a){if(null!=L.cutListener){var b=L.cutListener();null!=b&&a.clipboardData.setData("text/plain",
b);a.preventDefault()}});window.document.addEventListener("paste",function(a){if(null!=L.pasteListener){var b=a.clipboardData.getData("text/plain");L.pasteListener(b);a.preventDefault()}});eb.init();n.init();e.loadFinished();Vc.instance=new Zc};e.getMouse=function(a){return 0!=a?null:e.mouse};e.checkGamepad=function(a){for(var b=0,c=a.axes.length;b<c;){var d=b++;if(null!=a.axes[d]&&e.gamepadStates[a.index].axes[d]!=a.axes[d]){var f=a.axes[d];1==d%2&&(f=-f);e.gamepadStates[a.index].axes[d]=f;e.gamepads[a.index].sendAxisEvent(d,
f)}}b=0;for(c=a.buttons.length;b<c;)d=b++,null!=a.buttons[d]&&e.gamepadStates[a.index].buttons[d]!=a.buttons[d].value&&(e.gamepadStates[a.index].buttons[d]=a.buttons[d].value,e.gamepads[a.index].sendButtonEvent(d,a.buttons[d].value));4>=a.axes.length&&7<a.buttons.length&&(e.gamepadStates[a.index].axes[4]=a.buttons[6].value,e.gamepads[a.index].sendAxisEvent(4,a.buttons[6].value),e.gamepadStates[a.index].axes[5]=a.buttons[7].value,e.gamepads[a.index].sendAxisEvent(5,a.buttons[7].value))};e.loadFinished=
function(){var a=e.khanvas;null==a&&(a=window.document.getElementById(pe.canvas_id));a.style.cursor="default";var b=!1;try{e.gl=a.getContext("webgl2",{alpha:!1,antialias:1<e.options.samplesPerPixel,stencil:!0,preserveDrawingBuffer:!0}),e.gl.pixelStorei(37441,1),e.halfFloat={HALF_FLOAT_OES:5131},e.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},e.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},e.elementIndexUint=!0,e.gl.getExtension("EXT_color_buffer_float"),e.gl.getExtension("OES_texture_float_linear"),
e.gl.getExtension("OES_texture_half_float_linear"),e.anisotropicFilter=e.gl.getExtension("EXT_texture_filter_anisotropic"),null==e.anisotropicFilter&&(e.anisotropicFilter=e.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),b=!0,e.gl2=!0,A.init()}catch(h){T.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"SystemImpl.hx",lineNumber:327,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!e.gl2)try{e.gl=a.getContext("experimental-webgl",{alpha:!1,antialias:1<e.options.samplesPerPixel,
stencil:!0,preserveDrawingBuffer:!0}),null!=e.gl&&(e.gl.pixelStorei(37441,1),e.gl.getExtension("OES_texture_float"),e.gl.getExtension("OES_texture_float_linear"),e.halfFloat=e.gl.getExtension("OES_texture_half_float"),e.gl.getExtension("OES_texture_half_float_linear"),e.depthTexture=e.gl.getExtension("WEBGL_depth_texture"),e.gl.getExtension("EXT_shader_texture_lod"),e.gl.getExtension("OES_standard_derivatives"),e.anisotropicFilter=e.gl.getExtension("EXT_texture_filter_anisotropic"),null==e.anisotropicFilter&&
(e.anisotropicFilter=e.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),e.drawBuffers=e.gl.getExtension("WEBGL_draw_buffers"),e.elementIndexUint=e.gl.getExtension("OES_element_index_uint"),b=!0,A.init())}catch(h){T.trace("Could not initialize WebGL, falling back to Canvas.",{fileName:"SystemImpl.hx",lineNumber:351,className:"kha.SystemImpl",methodName:"loadFinished"})}e.setCanvas(a);b?(b=new ka,e.frame=new cc(0,null,null,b),e.frame.init(new td(e.frame),new Yd(e.frame),b)):(Ob=Qb,b=new ud(a.getContext("2d")),
e.frame=new cc(0,null,b,null),e.frame.init(new td(e.frame),b,null));!e.mobile&&R._init()?(e._hasWebAudio=!0,ea._init()):e.mobile?(e._hasWebAudio=!1,Ja._init(),ea=Ja):(e._hasWebAudio=!1,hc._compile(),ea=hc);ic.instance=new vd;n.start();b=window;var c=b.requestAnimationFrame;null==c&&(c=b.mozRequestAnimationFrame);null==c&&(c=b.webkitRequestAnimationFrame);null==c&&(c=b.msRequestAnimationFrame);var d=null,f=d=function(b){b=window;null==c?b.setTimeout(d,16.666666666666668):c(d);b=e.getGamepads();if(null!=
b)for(var f=0,h=b.length;f<h;){var k=f++;k=b[k];null!=k&&e.checkGamepad(k)}n.executeFrame();if(a.getContext){b=a.clientWidth;f=a.clientHeight;if(a.width!=b||a.height!=f)a.width=b,a.height=f;L.render(0,e.frame);null!=e.gl&&(e.gl.clearColor(1,1,1,1),e.gl.colorMask(!1,!1,!1,!0),e.gl.clear(16384),e.gl.colorMask(!0,!0,!0,!0))}};null==c?b.setTimeout(f,16.666666666666668):c(f);null==a.getAttribute("tabindex")&&a.setAttribute("tabindex","0");a.focus();a.oncontextmenu=function(a){a.stopPropagation();a.preventDefault()};
a.onmousedown=e.mouseDown;a.onmousemove=e.mouseMove;null!=e.keyboard&&(a.onkeydown=e.keyDown,a.onkeyup=e.keyUp,a.onkeypress=e.keyPress);a.onblur=e.onBlur;a.onfocus=e.onFocus;a.onmousewheel=a.onwheel=e.mouseWheel;a.onmouseleave=e.mouseLeave;a.addEventListener("wheel mousewheel",e.mouseWheel,!1);a.addEventListener("touchstart",e.touchDown,!1);a.addEventListener("touchend",e.touchUp,!1);a.addEventListener("touchmove",e.touchMove,!1);window.addEventListener("unload",e.unload)};e.unload=function(a){};
e.setMouseXY=function(a){var b=e.khanvas.getBoundingClientRect(),c=e.khanvas.clientLeft,d=e.khanvas.clientTop;e.mouseX=(a.clientX-b.left-c)*e.khanvas.width/(b.width-2*c)|0;e.mouseY=(a.clientY-b.top-d)*e.khanvas.height/(b.height-2*d)|0};e.unlockSoundOnIOS=function(){if(e.mobile&&!e.iosSoundEnabled){var a=Ja._context.createBuffer(1,1,22050),b=Ja._context.createBufferSource();b.buffer=a;b.connect(Ja._context.destination);b.noteOn&&b.noteOn(0);e.iosSoundEnabled=!0}};e.mouseLeave=function(){e.mouse.sendLeaveEvent(0)};
e.mouseWheel=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();a.preventDefault();return 0==a.deltaMode?(0>a.deltaY?e.mouse.sendWheelEvent(0,-1):0<a.deltaY&&e.mouse.sendWheelEvent(0,1),e.insideInputEvent=!1):1==a.deltaMode?(e.minimumScroll=Math.min(e.minimumScroll,Math.abs(a.deltaY))|0,e.mouse.sendWheelEvent(0,a.deltaY/e.minimumScroll|0),e.insideInputEvent=!1):e.insideInputEvent=!1};e.mouseDown=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();e.setMouseXY(a);1==a.which?(a.ctrlKey?(e.leftMouseCtrlDown=
!0,e.mouse.sendDownEvent(0,1,e.mouseX,e.mouseY)):(e.leftMouseCtrlDown=!1,e.mouse.sendDownEvent(0,0,e.mouseX,e.mouseY)),null!=(wd=e.khanvas,wb(wd,wd.setCapture))?e.khanvas.setCapture():e.khanvas.ownerDocument.addEventListener("mousemove",e.documentMouseMove,!0),e.khanvas.ownerDocument.addEventListener("mouseup",e.mouseLeftUp)):2==a.which?(e.mouse.sendDownEvent(0,2,e.mouseX,e.mouseY),e.khanvas.ownerDocument.addEventListener("mouseup",e.mouseMiddleUp)):3==a.which&&(e.mouse.sendDownEvent(0,1,e.mouseX,
e.mouseY),e.khanvas.ownerDocument.addEventListener("mouseup",e.mouseRightUp));e.insideInputEvent=!1};e.mouseLeftUp=function(a){e.unlockSoundOnIOS();1==a.which&&(e.insideInputEvent=!0,e.khanvas.ownerDocument.removeEventListener("mouseup",e.mouseLeftUp),null!=(wd=e.khanvas,wb(wd,wd.releaseCapture))?e.khanvas.ownerDocument.releaseCapture():e.khanvas.ownerDocument.removeEventListener("mousemove",e.documentMouseMove,!0),e.leftMouseCtrlDown?e.mouse.sendUpEvent(0,1,e.mouseX,e.mouseY):e.mouse.sendUpEvent(0,
0,e.mouseX,e.mouseY),e.leftMouseCtrlDown=!1,e.insideInputEvent=!1)};e.mouseMiddleUp=function(a){e.unlockSoundOnIOS();2==a.which&&(e.insideInputEvent=!0,e.khanvas.ownerDocument.removeEventListener("mouseup",e.mouseMiddleUp),e.mouse.sendUpEvent(0,2,e.mouseX,e.mouseY),e.insideInputEvent=!1)};e.mouseRightUp=function(a){e.unlockSoundOnIOS();3==a.which&&(e.insideInputEvent=!0,e.khanvas.ownerDocument.removeEventListener("mouseup",e.mouseRightUp),e.mouse.sendUpEvent(0,1,e.mouseX,e.mouseY),e.insideInputEvent=
!1)};e.documentMouseMove=function(a){a.stopPropagation();e.mouseMove(a)};e.mouseMove=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();var b=e.mouseX,c=e.mouseY;e.setMouseXY(a);var d=a.movementX,f=a.movementY;null==a.movementX&&(d=null!=a.mozMovementX?a.mozMovementX:null!=a.webkitMovementX?a.webkitMovementX:e.mouseX-b,f=null!=a.mozMovementY?a.mozMovementY:null!=a.webkitMovementY?a.webkitMovementY:e.mouseY-c);e.firefox&&(d=d*window.devicePixelRatio|0,f=f*window.devicePixelRatio|0);e.mouse.sendMoveEvent(0,
e.mouseX,e.mouseY,d,f);e.insideInputEvent=!1};e.setTouchXY=function(a){var b=e.khanvas.getBoundingClientRect(),c=e.khanvas.clientLeft,d=e.khanvas.clientTop;e.touchX=(a.clientX-b.left-c)*e.khanvas.width/(b.width-2*c)|0;e.touchY=(a.clientY-b.top-d)*e.khanvas.height/(b.height-2*d)|0};e.touchDown=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();a.stopPropagation();a.preventDefault();var b=0;for(a=a.changedTouches;b<a.length;){var c=a[b];++b;e.setTouchXY(c);e.mouse.sendDownEvent(0,0,e.touchX,e.touchY);
e.surface.sendTouchStartEvent(c.identifier,e.touchX,e.touchY)}e.insideInputEvent=!1};e.touchUp=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();var b=0;for(a=a.changedTouches;b<a.length;){var c=a[b];++b;e.setTouchXY(c);e.mouse.sendUpEvent(0,0,e.touchX,e.touchY);e.surface.sendTouchEndEvent(c.identifier,e.touchX,e.touchY)}e.insideInputEvent=!1};e.touchMove=function(a){e.insideInputEvent=!0;e.unlockSoundOnIOS();var b=0,c=0;for(a=a.changedTouches;c<a.length;){var d=a[c];++c;e.setTouchXY(d);if(0==
b){var f=e.touchX-e.lastFirstTouchX,h=e.touchY-e.lastFirstTouchY;e.lastFirstTouchX=e.touchX;e.lastFirstTouchY=e.touchY;e.mouse.sendMoveEvent(0,e.touchX,e.touchY,f,h)}e.surface.sendMoveEvent(d.identifier,e.touchX,e.touchY);++b}e.insideInputEvent=!1};e.onBlur=function(){L.background()};e.onFocus=function(){L.foreground()};e.keyDown=function(a){a.stopPropagation();e.pressedKeys[a.keyCode]?a.preventDefault():(e.pressedKeys[a.keyCode]=!0,e.keyboard.sendDownEvent(a.keyCode))};e.keyUp=function(a){a.preventDefault();
a.stopPropagation();e.pressedKeys[a.keyCode]=!1;e.keyboard.sendUpEvent(a.keyCode)};e.keyPress=function(a){a.stopPropagation();(!e.firefox||0!=a.which&&8!=a.which)&&e.keyboard.sendPressEvent(String.fromCharCode(a.which))};e.getGamepads=function(){return e.chrome&&ic.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null};var $c=function(){};m["kha.Video"]=$c;$c.__name__=!0;$c.__interfaces__=[Nb];$c.prototype={__class__:$c};var Ca=function(a,b,c,d,f){this.frameBuffer=
this.renderBuffer=this.texture=this.depthTexture=null;this.myWidth=a;this.myHeight=b;this.format=c;this.renderTarget=d;this.video=this.image=null;this.depthStencilFormat=f;Ca.init();d&&this.createTexture()};m["kha.WebGLImage"]=Ca;Ca.__name__=!0;Ca.init=function(){if(null==Ca.context){var a=window.document.createElement("canvas");null!=a&&(Ca.context=a.getContext("2d"),a.width=2048,a.height=2048,Ca.context.globalCompositeOperation="copy")}};Ca.formatByteSize=function(a){switch(a[1]){case 0:return 4;
case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}};Ca.__super__=qa;Ca.prototype=na(qa.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics4:null,depthStencilFormat:null,get_g4:function(){null==this.graphics4&&(this.graphics4=new ka(this));return this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},
get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=e.gl){this.texture=e.gl.createTexture();e.gl.bindTexture(3553,this.texture);e.gl.texParameteri(3553,10240,9729);e.gl.texParameteri(3553,10241,9729);e.gl.texParameteri(3553,10242,33071);e.gl.texParameteri(3553,10243,33071);if(this.renderTarget){this.frameBuffer=e.gl.createFramebuffer();e.gl.bindFramebuffer(36160,this.frameBuffer);switch(this.format[1]){case 0:e.gl.texImage2D(3553,
0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:e.gl.texImage2D(3553,0,e.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:e.gl.texImage2D(3553,0,e.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:e.gl.texImage2D(3553,0,e.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,e.halfFloat.HALF_FLOAT_OES,null);break;case 5:e.gl.texImage2D(3553,0,e.gl2?33326:6406,this.get_realWidth(),
this.get_realHeight(),0,e.gl2?6403:6406,5126,null);break;case 6:e.gl.texImage2D(3553,0,e.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,e.gl2?6403:6406,e.halfFloat.HALF_FLOAT_OES,null);break;default:e.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==U.DEPTH16){if(e.gl.texParameteri(3553,10240,9728),e.gl.texParameteri(3553,10241,9728),e.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),-1==navigator.appVersion.indexOf("Win")){var a=
e.gl.createTexture();e.gl.bindTexture(3553,a);e.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);e.gl.framebufferTexture2D(36160,36064,3553,a,0);e.gl.bindTexture(3553,this.texture)}}else e.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat);36053!=e.gl.checkFramebufferStatus(36160)&&T.trace("WebGL error: Framebuffer incomplete",{fileName:"WebGLImage.hx",lineNumber:206,className:"kha.WebGLImage",methodName:"createTexture"});
e.gl.bindRenderbuffer(36161,null);e.gl.bindFramebuffer(36160,null)}else if(null!=this.video)e.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format[1]){case 0:E.__instanceof(this.image,la)?e.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):e.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 2:e.gl.texImage2D(3553,0,e.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:e.gl.texImage2D(3553,0,e.gl2?34842:6408,this.myWidth,
this.myHeight,0,6408,e.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:e.gl.texImage2D(3553,0,e.gl2?33326:6406,this.myWidth,this.myHeight,0,e.gl2?6403:6406,5126,this.image);break;case 6:e.gl.texImage2D(3553,0,e.gl2?33325:6406,this.myWidth,this.myHeight,0,e.gl2?6403:6406,e.halfFloat.HALF_FLOAT_OES,this.image);break;default:e.gl.texImage2D(3553,0,6408,6408,5121,this.image)}e.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(a){switch(a){case 1:case 5:null==e.depthTexture?(this.renderBuffer=
e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(36161,this.renderBuffer),e.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),e.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=e.gl.createTexture(),e.gl.bindTexture(3553,this.depthTexture),1==a?e.gl.texImage2D(3553,0,e.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):e.gl.texImage2D(3553,0,e.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,
null),e.gl.texParameteri(3553,10240,9728),e.gl.texParameteri(3553,10241,9728),e.gl.texParameteri(3553,10242,33071),e.gl.texParameteri(3553,10243,33071),e.gl.bindFramebuffer(36160,this.frameBuffer),e.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==e.depthTexture?(this.renderBuffer=e.gl.createRenderbuffer(),e.gl.bindRenderbuffer(36161,this.renderBuffer),e.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),e.gl.framebufferRenderbuffer(36160,
33306,36161,this.renderBuffer)):(this.depthTexture=e.gl.createTexture(),e.gl.bindTexture(3553,this.depthTexture),e.gl.texImage2D(3553,0,e.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,e.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),e.gl.texParameteri(3553,10240,9728),e.gl.texParameteri(3553,10241,9728),e.gl.texParameteri(3553,10242,33071),e.gl.texParameteri(3553,10243,33071),e.gl.bindFramebuffer(36160,this.frameBuffer),e.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,
0))}},set:function(a){e.gl.activeTexture(33984+a);e.gl.bindTexture(3553,this.texture);null!=this.video&&e.gl.texImage2D(3553,0,6408,6408,5121,this.video)},bytesToArray:function(a){switch(this.format[1]){case 0:case 1:return new la(a.b.bufferValue);case 2:case 4:case 5:case 6:return new se(a.b.bufferValue);default:return new la(a.b.bufferValue)}},bytes:null,lock:function(a){return this.bytes=new ha(new pa(Ca.formatByteSize(this.format)*this.get_width()*this.get_height()))},unlock:function(){if(null!=
e.gl){this.texture=e.gl.createTexture();e.gl.bindTexture(3553,this.texture);e.gl.texParameteri(3553,10240,9729);e.gl.texParameteri(3553,10241,9729);e.gl.texParameteri(3553,10242,33071);e.gl.texParameteri(3553,10243,33071);switch(this.format[1]){case 0:e.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:e.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes));if(1282==e.gl.getError()){for(var a=
new ha(new pa(this.get_width()*this.get_height()*4)),b=0,c=this.get_height();b<c;)for(var d=b++,f=0,h=this.get_width();f<h;){var g=f++,l=this.bytes,k=d*this.get_width()+g;l=l.b[k];k=d*this.get_width()*4+4*g;a.b[k]=l&255;k=d*this.get_width()*4+4*g+1;a.b[k]=l&255;k=d*this.get_width()*4+4*g+2;a.b[k]=l&255;g=d*this.get_width()*4+4*g+3;a.b[g]=255}e.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(a))}break;case 2:e.gl.texImage2D(3553,0,e.gl2?34836:6408,this.get_width(),
this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:e.gl.texImage2D(3553,0,e.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,e.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:e.gl.texImage2D(3553,0,e.gl2?33326:6406,this.get_width(),this.get_height(),0,e.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:e.gl.texImage2D(3553,0,e.gl2?33325:6406,this.get_width(),this.get_height(),0,e.gl2?6403:6406,e.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));
break;default:e.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}e.gl.bindTexture(3553,null);this.bytes=null}},__class__:Ca});var lb=m["kha.WindowMode"]={__ename__:!0,__constructs__:["Window","BorderlessWindow","Fullscreen"]};lb.Window=["Window",0];lb.Window.toString=w;lb.Window.__enum__=lb;lb.BorderlessWindow=["BorderlessWindow",1];lb.BorderlessWindow.toString=w;lb.BorderlessWindow.__enum__=lb;lb.Fullscreen=["Fullscreen",2];lb.Fullscreen.toString=
w;lb.Fullscreen.__enum__=lb;var jc=function(){};m["kha.audio1.AudioChannel"]=jc;jc.__name__=!0;jc.prototype={__class__:jc};var R=function(){};m["kha.audio2.Audio"]=R;R.__name__=!0;R.initContext=function(){try{R._context=new AudioContext;return}catch(a){}try{this._context=new webkitAudioContext}catch(a){}};R._init=function(){R.initContext();if(null==R._context)return!1;R.buffer=new Zd(8192,2,R._context.sampleRate|0);R.processingNode=R._context.createScriptProcessor(2048,0,2);R.processingNode.onaudioprocess=
function(a){var b=a.outputBuffer.getChannelData(0),c=a.outputBuffer.getChannelData(1);if(null!=R.audioCallback){R.audioCallback(2*a.outputBuffer.length,R.buffer);var d=0;for(a=a.outputBuffer.length;d<a;){var f=d++;b[f]=R.buffer.data[R.buffer.readLocation];R.buffer.readLocation+=1;c[f]=R.buffer.data[R.buffer.readLocation];R.buffer.readLocation+=1;R.buffer.readLocation>=R.buffer.size&&(R.buffer.readLocation=0)}}else for(d=0,a=a.outputBuffer.length;d<a;)f=d++,b[f]=0,c[f]=0};R.processingNode.connect(R._context.destination);
return!0};var ea=function(){};m["kha.audio2.Audio1"]=ea;ea.__name__=!0;ea._init=function(){ea.soundChannels=Array(16);ea.streamChannels=Array(16);ea.internalSoundChannels=Array(16);ea.internalStreamChannels=Array(16);ea.sampleCache1=Array(512);ea.sampleCache2=Array(512);R.audioCallback=ea.mix};ea.mix=function(a,b){ea.sampleCache1.length<a&&(ea.sampleCache1=Array(a),ea.sampleCache2=Array(a));for(var c=0;c<a;){var d=c++;ea.sampleCache2[d]=0}for(c=0;16>c;)d=c++,ea.internalSoundChannels[d]=ea.soundChannels[d];
for(c=0;16>c;)d=c++,ea.internalStreamChannels[d]=ea.streamChannels[d];c=0;for(d=ea.internalSoundChannels;c<d.length;){var f=d[c];++c;if(null!=f&&!f.get_finished()){f.nextSamples(ea.sampleCache1,a,b.samplesPerSecond);for(var h=0,g=a;h<g;){var e=h++,k=e,y=ea.sampleCache2;e=ea.sampleCache1[e]*f.get_volume();y[k]+=e}}}c=0;for(d=ea.internalStreamChannels;c<d.length;)if(f=d[c],++c,null!=f&&!f.get_finished())for(f.nextSamples(ea.sampleCache1,a,b.samplesPerSecond),h=0,g=a;h<g;)k=e=h++,y=ea.sampleCache2,e=
ea.sampleCache1[e]*f.get_volume(),y[k]+=e;for(c=0;c<a;)d=c++,d=ea.sampleCache2[d],d=1>d?d:1,b.data[b.writeLocation]=-1<d?d:-1,b.writeLocation+=1,b.writeLocation>=b.size&&(b.writeLocation=0)};var $d=function(){this.paused=!1};m["kha.audio2.AudioChannel"]=$d;$d.__name__=!0;$d.__interfaces__=[jc];$d.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(a,b,c){if(this.paused)for(c=0;c<b;){var d=c++;a[d]=0}else{for(d=c=0;c<b;){var f=this.data.length-this.myPosition;
for(f=f<b?f:b;d<f;)a[c]=this.data[this.myPosition],++this.myPosition,++d,++c;if(this.looping)d=0,this.myPosition>=this.data.length&&(this.myPosition=0);else break}for(;c<b;)a[c]=0,++c}},get_volume:function(){return this.myVolume},get_finished:function(){return this.myPosition>=this.data.length},__class__:$d};var Zd=function(a,b,c){this.size=a;this.data=Array(a);this.channels=b;this.samplesPerSecond=c;this.writeLocation=this.readLocation=0};m["kha.audio2.Buffer"]=Zd;Zd.__name__=!0;Zd.prototype={channels:null,
samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Zd};var ae=function(){this.atend=this.paused=!1};m["kha.audio2.StreamChannel"]=ae;ae.__name__=!0;ae.__interfaces__=[jc];ae.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(a,b,c){if(this.paused)for(c=0;c<b;){var d=c++;a[d]=0}else if(c=2*this.reader.read(a,b/2|0,2,c,!0),c<b)for(this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;c<b;)d=c++,a[d]=0},get_volume:function(){return this.myVolume},
get_finished:function(){return this.atend},__class__:ae};var Fb=function(){};m["kha.audio2.ogg.tools.Crc32"]=Fb;Fb.__name__=!0;Fb.init=function(){if(null==Fb.table){Fb.table=Array(256);for(var a=0;256>a;){for(var b=a++,c=b<<24,d=0;8>d;)d++,c=c<<1^(S.gte(c,-2147483648)?79764919:0);Fb.table[b]=c}}};var hb=function(a,b,c){this.seekFunc=b;this.inputLength=c;this.decoder=kc.start(a);this.decoder.setupSampleNumber(b,c);this.loopStart=this.get_header().comment.get_loopStart();this.loopLength=this.get_header().comment.get_loopLength()};
m["kha.audio2.ogg.vorbis.Reader"]=hb;hb.__name__=!0;hb.openFromBytes=function(a){var b=new Zb(a);return new hb(b,function(a){hb.seekBytes(b,a)},a.length)};hb.seekBytes=function(a,b){a.set_position(b)};hb.readAll=function(a,b,c){null==c&&(c=!1);var d=new Zb(a),f=kc.start(d);f.setupSampleNumber(function(a){hb.seekBytes(d,a)},a.length);a=f.header;for(var h=Array(4096*a.channel);;){for(var g=f.read(h,4096,a.channel,a.sampleRate,c),e=0,k=g*a.channel;e<k;){var y=e++;b.writeFloat(h[y])}if(0==g)break}return f.header};
hb.prototype={decoder:null,get_header:function(){return this.decoder.header},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(a){this.decoder.seek(this.seekFunc,this.inputLength,a);return this.decoder.currentSample},get_currentMillisecond:function(){var a=this.get_currentSample(),b=this.get_header().sampleRate;return S.toFloat(a)/S.toFloat(b)*1E3},set_currentMillisecond:function(a){a/=1E3;var b=this.get_header().sampleRate;this.set_currentSample(Math.floor(S.toFloat(b)*
a));return this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(a,b,c,d,f){null==f&&(f=!1);this.decoder.ensurePosition(this.seekFunc);null==b&&(b=this.decoder.totalSample);null==c&&(c=this.get_header().channel);null==d&&(d=this.get_header().sampleRate);return this.decoder.read(a,b,c,d,f)},__class__:hb};var Rb=function(a){this.nextSeg=0;this.firstDecode=!1;this.validBits=this.bytesInSeg=0;this.input=a;this.inputPosition=0;this.page=new xd;Fb.init()};
m["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Rb;Rb.__name__=!0;Rb.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(a,b){this.inputPosition+=1;var c=this.input.readByte();this.inputPosition+=
c;for(var d=Array(c),f=0;f<c;){var h=f++;d[h]=this.input.readByte()}this.segments=d;this.endSegWithKnownLoc=-2;if(-1!=a||-1!=b)for(d=c-1;0<=d&&!(255>this.segments[d]);)0<=d&&(this.endSegWithKnownLoc=d,this.knownLocForPacket=a),--d;if(this.firstDecode){d=0;f=new yd;for(h=0;h<c;){var g=h++;d+=this.segments[g]}f.pageStart=this.firstAudioPageOffset;f.pageEnd=f.pageStart+(d+(27+c));f.firstDecodedSample=0;f.lastDecodedSample=a;this.pFirst=f}this.nextSeg=0},clone:function(a){var b=fa.createEmptyInstance(Rb);
a(this.inputPosition);b.input=this.input;b.eof=this.eof;b.validBits=this.validBits;b.discardSamplesDeferred=this.discardSamplesDeferred;b.firstDecode=this.firstDecode;b.nextSeg=this.nextSeg;b.bytesInSeg=this.bytesInSeg;b.acc=b.acc;b.lastSeg=this.lastSeg;b.lastSegWhich=this.lastSegWhich;b.currentLoc=this.currentLoc;b.currentLocValid=this.currentLocValid;b.inputPosition=this.inputPosition;b.firstAudioPageOffset=this.firstAudioPageOffset;b.error=this.error;b.segments=this.segments;b.pFirst=this.pFirst;
b.pLast=this.pLast;b.page=this.page.clone();return b},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(b){b instanceof r&&(b=b.val);if(E.__instanceof(b,H))return this.lastSeg=!0,this.error=b,0;throw b;}if(0==(this.page.flag&1))throw new r(new H(q.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}));}var a=this.segments[this.nextSeg++];
255>a&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1);this.nextSeg>=this.segments.length&&(this.nextSeg=-1);return this.bytesInSeg=a},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(this.page.flag&1))throw new r(new H(q.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1;this.bytesInSeg=this.validBits=0},maybeStartPacket:function(){if(-1==this.nextSeg){var a=
!1;try{this.inputPosition+=1;var b=this.input.readByte()}catch(c){if(c instanceof r&&(c=c.val),E.__instanceof(c,qb))a=!0,b=0;else throw c;}if(a)return!1;79==b?(this.inputPosition+=1,a=103!=this.input.readByte()):a=!0;a?a=!0:(this.inputPosition+=1,a=103!=this.input.readByte());a?a=!0:(this.inputPosition+=1,a=83!=this.input.readByte());if(a)throw new r(new H(q.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));
this.page.startWithoutCapturePattern(this)}this.startPacket();return!0},readBits:function(a){if(0>this.validBits)return 0;if(this.validBits<a){if(24<a)return this.readBits(24)+(this.readBits(a-24)<<24);0==this.validBits&&(this.acc=0);for(;;){if(0!=this.bytesInSeg||!this.lastSeg&&0!=this.next())this.bytesInSeg--,this.inputPosition+=1,this.acc+=this.input.readByte()<<this.validBits,this.validBits+=8;else{this.validBits=-1;break}if(!(this.validBits<a))break}if(0>this.validBits)return 0;var b=this.acc&
(1<<a)-1;this.acc>>>=a;this.validBits-=a;return b}b=this.acc&(1<<a)-1;this.acc>>>=a;this.validBits-=a;return b},firstPageValidate:function(){if(1!=this.segments.length)throw new r(new H(q.INVALID_FIRST_PAGE,"segmentCount",{fileName:"VorbisDecodeState.hx",lineNumber:307,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new r(new H(q.INVALID_FIRST_PAGE,"decodeState head",{fileName:"VorbisDecodeState.hx",lineNumber:310,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",
methodName:"firstPageValidate"}));},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition;this.firstDecode=!0},prepHuffman:function(){if(24>=this.validBits)for(0==this.validBits&&(this.acc=0);;){if(0!=this.bytesInSeg||!this.lastSeg&&0!=this.next())this.bytesInSeg--,this.inputPosition+=1,this.acc+=this.input.readByte()<<this.validBits,this.validBits+=8;else break;if(!(24>=this.validBits))break}},finishDecodePacket:function(a,b,c){a=c.left.start;var d=!1,f=b>>1;this.firstDecode?(this.currentLoc=
-f,this.discardSamplesDeferred=b-c.right.end,d=!0,this.firstDecode=!1):0!=this.discardSamplesDeferred&&(c.left.start+=this.discardSamplesDeferred,a=c.left.start,this.discardSamplesDeferred=0);if(this.lastSegWhich==this.endSegWithKnownLoc){if(d&&0!=(this.page.flag&4)&&(b=this.knownLocForPacket-(b-c.right.end),b<this.currentLoc+c.right.end))return b=b<this.currentLoc?0:b-this.currentLoc,b+=c.left.start,this.currentLoc+=b,{len:b,left:a,right:c.right.start};this.currentLoc=this.knownLocForPacket-(f-c.left.start);
d=!0}d&&(this.currentLoc+=c.right.start-c.left.start);return{len:c.right.end,left:a,right:c.right.start}},getSampleNumber:function(a,b){var c=this.inputPosition,d=S.gte(b,65536)&&S.gte(b-65536,this.firstAudioPageOffset)?b-65536:this.firstAudioPageOffset;a(this.inputPosition=d);var f=0,h=!1,g=this.findPage(a,b);switch(g[1]){case 0:h=g[3];f=g[2];break;case 1:throw new r(new H(q.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecodeState.hx",lineNumber:518,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",
methodName:"getSampleNumber"}));}g=this.inputPosition;try{for(;!h;){a(this.inputPosition=f);var e=this.findPage(a,b);switch(e[1]){case 0:var k=e[3];f=e[2];h=k;break;case 1:throw"__break__";}d=g+1;g=this.inputPosition}}catch(y){if("__break__"!=y)throw y;}a(this.inputPosition=g);this.inputPosition+=6;e=Array(6);for(k=0;6>k;)h=k++,e[h]=this.input.readByte();this.inputPosition+=4;e=this.input.readInt32();this.inputPosition+=4;k=this.input.readInt32();if(-1==e&&-1==k||0<k)throw new r(new H(q.CANT_FIND_LAST_PAGE,
null,{fileName:"VorbisDecodeState.hx",lineNumber:552,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));this.pLast=new yd;this.pLast.pageStart=g;this.pLast.pageEnd=f;this.pLast.lastDecodedSample=e;this.pLast.firstDecodedSample=null;this.pLast.afterPreviousPageStart=d;a(this.inputPosition=c);return e},findPage:function(a,b){try{for(;;)if(this.inputPosition+=1,79==this.input.readByte()){var c=this.inputPosition;if(c-25>b)return Gb.NotFound;this.inputPosition+=1;if(103==
this.input.readByte()){this.inputPosition+=1;var d=103!=this.input.readByte()}else d=!0;if(d)var f=!0;else this.inputPosition+=1,f=83!=this.input.readByte();if(!f){var h=Array(27);h[0]=79;h[1]=103;h[2]=103;h[3]=83;for(var g=4;27>g;){var e=g++;this.inputPosition+=1;h[e]=this.input.readByte()}if(0!=h[4])a(this.inputPosition=c);else{var k=h[22]+(h[23]<<8)+(h[24]<<16)+(h[25]<<24);for(g=22;26>g;){var y=g++;h[y]=0}for(var M=g=0;27>M;){var p=M++;g=g<<8^Fb.table[h[p]^g>>>24]}M=0;try{for(var m=0,B=h[26];m<
B;){m++;this.inputPosition+=1;var v=this.input.readByte();g=g<<8^Fb.table[v^g>>>24];M+=v}for(m=0;m<M;){m++;this.inputPosition+=1;var u=this.input.readByte();g=g<<8^Fb.table[u^g>>>24]}}catch(lc){lc instanceof r&&(lc=lc.val);if(E.__instanceof(lc,qb))return Gb.NotFound;throw lc;}if(g==k){var q=this.inputPosition;a(this.inputPosition=c-1);return Gb.Found(q,0!=(h[5]&4))}}}}}catch(lc){lc instanceof r&&(lc=lc.val);if(E.__instanceof(lc,qb))return Gb.NotFound;throw lc;}},analyzePage:function(a,b){var c=new yd,
d=Array(255);c.pageStart=this.inputPosition;this.inputPosition+=27;for(var f=Array(27),h=0;27>h;){var g=h++;f[g]=this.input.readByte()}g=f[26];this.inputPosition+=g;h=Array(g);for(var e=0;e<g;){var k=e++;h[k]=this.input.readByte()}e=g=0;for(k=f[26];e<k;){var y=e++;g+=h[y]}c.pageEnd=c.pageStart+27+f[26]+g;c.lastDecodedSample=f[6]+(f[7]<<8)+(f[8]<<16)+(f[9]<<16);if(0!=(f[5]&4))return c.firstDecodedSample=null,a(this.inputPosition=c.pageStart),c;g=0;var M=0==(f[5]&1);e=b.modes.length;k=0;for(f=f[26];k<
f;){y=k++;if(M){if(0==h[y])return a(this.inputPosition=c.pageStart),null;this.inputPosition+=1;M=this.input.readByte();if(0!=(M&1))return a(this.inputPosition=c.pageStart),null;M>>=1;var p=e-1,m=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];M&=(1<<(16384>p?16>p?m[p]:512>p?5+m[p>>5]:10+m[p>>10]:16777216>p?524288>p?15+m[p>>15]:20+m[p>>20]:536870912>p?25+m[p>>25]:-2147483648>p?30+m[p>>30]:0))-1;if(M>=e)return a(this.inputPosition=c.pageStart),null;d[g++]=b.modes[M].blockflag;m=h[y]-1;this.inputPosition+=m;M=Array(m);
for(p=0;p<m;){var B=p++;M[B]=this.input.readByte()}}else for(m=h[y],this.inputPosition+=m,M=Array(m),p=0;p<m;)B=p++,M[B]=this.input.readByte();M=255>h[y]}h=0;1<g&&(h+=d[g-1]?b.blocksize1:b.blocksize0);for(g-=2;1<=g;)--g,h=d[g]?d[g+1]?h+(b.blocksize1>>1):h+((b.blocksize1-b.blocksize0>>2)+(b.blocksize0>>1)):h+(b.blocksize0>>1),--g;c.firstDecodedSample=c.lastDecodedSample-h;a(this.inputPosition=c.pageStart);return c},decodeScalarRaw:function(a){this.prepHuffman();var b=a.codewordLengths,c=a.codewords,
d=a.sortedCodewords;if(8<a.entries?null!=d:null!=c){c=this.acc;c=(c&-1431655766)>>>1|(c&1431655765)<<1;c=(c&-858993460)>>>2|(c&858993459)<<2;c=(c&-252645136)>>>4|(c&252645135)<<4;c=(c&-16711936)>>>8|(c&16711935)<<8;var f=c>>>16|c<<16;c=0;for(var h=a.sortedEntries;1<h;){var g=c+(h>>1);S.gte(f,d[g])?(c=g,h-=h>>1):h>>=1}a.sparse||(c=a.sortedValues[c]);b=b[c];if(this.validBits>=b)return this.acc>>>=b,this.validBits-=b,c;this.validBits=0;return-1}d=0;for(a=a.entries;d<a;)if(f=d++,h=b[f],255!=h&&c[f]==
(this.acc&(1<<h)-1)){if(this.validBits>=h)return this.acc>>>=h,this.validBits-=h,f;this.validBits=0;return-1}this.error=new H(q.INVALID_STREAM,null,{fileName:"VorbisDecodeState.hx",lineNumber:846,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"});this.validBits=0;return-1},__class__:Rb};var Gb=m["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"]};Gb.Found=function(a,b){var c=["Found",0,a,b];c.__enum__=Gb;c.toString=
w;return c};Gb.NotFound=["NotFound",1];Gb.NotFound.toString=w;Gb.NotFound.__enum__=Gb;var kc=function(a,b){this.header=a;this.decodeState=b;this.totalSample=null;this.previousLength=this.currentSample=0;this.channelBuffers=Array(a.channel);this.previousWindow=Array(a.channel);this.finalY=Array(a.channel);for(var c=0,d=a.channel;c<d;){var f=c++;this.channelBuffers[f]=Array(a.blocksize1);this.previousWindow[f]=Array(a.blocksize1/2|0);this.finalY[f]=[]}this.a=Array(2);this.b=Array(2);this.c=Array(2);
this.window=Array(2);this.bitReverseData=Array(2);this.initBlocksize(0,a.blocksize0);this.initBlocksize(1,a.blocksize1)};m["kha.audio2.ogg.vorbis.VorbisDecoder"]=kc;kc.__name__=!0;kc.start=function(a){a=new Rb(a);var b=ad.read(a);b=new kc(b,a);a.startFirstDecode();b.pumpFirstFrame();return b};kc.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,
totalSample:null,decodeState:null,read:function(a,b,c,d,f){var h=this.header.sampleRate;if(0!=(S.toFloat(d)%S.toFloat(h)|0))throw new r("Unsupported sampleRate : can't convert "+Ga.string(S.toFloat(this.header.sampleRate))+" to "+d);if(0!=c%this.header.channel)throw new r("Unsupported channels : can't convert "+this.header.channel+" to "+c);h=this.header.sampleRate;d=S.toFloat(d)/S.toFloat(h)|0;c=c/this.header.channel|0;var g=0;b=Math.floor(b/d);null!=this.totalSample&&b>this.totalSample-this.currentSample&&
(b=this.totalSample-this.currentSample);for(h=0;g<b;){var e=this.channelBufferEnd-this.channelBufferStart;e>=b-g&&(e=b-g);for(var k=this.channelBufferStart,y=this.channelBufferStart+e;k<y;)for(var M=k++,p=0,m=d;p<m;){p++;for(var B=0,v=this.header.channel;B<v;)for(var u=B++,q=0,n=c;q<n;){q++;var z=this.channelBuffers[u][M];1<z?z=1:-1>z&&(z=-1);f&&(a[h]=z,++h)}}g+=e;this.channelBufferStart+=e;if(g==b||0==this.getFrameFloat())break}for(e=b;g<e;)for(g++,k=0,y=d;k<y;)for(k++,M=0,p=this.header.channel;M<
p;)for(M++,m=0,B=c;m<B;)m++,f&&(a[h]=0,++h);this.currentSample+=b;return b*d},skipSamples:function(a){var b=0;for(null!=this.totalSample&&a>this.totalSample-this.currentSample&&(a=this.totalSample-this.currentSample);b<a;){var c=this.channelBufferEnd-this.channelBufferStart;c>=a-b&&(c=a-b);b+=c;this.channelBufferStart+=c;if(b==a||0==this.getFrameFloat())break}this.currentSample+=a;return a},setupSampleNumber:function(a,b){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(a,
b))},seek:function(a,b,c){if(this.currentSample!=c){if(null==this.totalSample&&(this.setupSampleNumber(a,b),0==this.totalSample))throw new r(new H(q.CANT_FIND_LAST_PAGE,null,{fileName:"VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));0>c&&(c=0);var d=this.decodeState.pFirst,f=this.decodeState.pLast;c>=f.lastDecodedSample&&(c=f.lastDecodedSample-1);if(c<d.lastDecodedSample)this.seekFrameFromPage(a,d.pageStart,0,c);else{for(var h=0;d.pageEnd<f.pageStart;){var e=
d.pageEnd,l=f.afterPreviousPageStart,k=d.lastDecodedSample,y=f.lastDecodedSample;if(null==k||null==y)throw new r(new H(q.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));S.gt(l,e+4E3)&&(l-=4E3);k=e+Math.floor(S.toFloat(l-e)/S.toFloat(y-k)*(c-k));4<=h&&(e+=l-e>>>1,k=8<=h?e:S.gt(e,k)?k+(e-k>>>1):e+(k-e>>>1));++h;a(this.decodeState.inputPosition=k);switch(this.decodeState.findPage(a,b)[1]){case 1:throw new r(new H(q.SEEK_FAILED,
null,{fileName:"VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));}e=this.decodeState.analyzePage(a,this.header);if(null==e)throw new r(new H(q.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));e.afterPreviousPageStart=k;e.pageStart==f.pageStart?f=e:c<e.lastDecodedSample?f=e:d=e}if(d.lastDecodedSample<=c&&c<f.lastDecodedSample)this.seekFrameFromPage(a,f.pageStart,d.lastDecodedSample,
c);else throw new r(new H(q.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));}}},seekFrameFromPage:function(a,b,c,d){var f=0;a(this.decodeState.inputPosition=b);this.decodeState.nextSeg=-1;for(b=null;;){var h=b;b=this.decodeState.clone(a);var e=this.decodeInitial();if(null==e){b=h;break}var l=e.left.start;h=e.left.end;h=0==f?h:l;if(d<c+e.right.start-h)break;for(l=this.decodeState;0!=l.bytesInSeg||!l.lastSeg&&0!=l.next();)l.bytesInSeg--,
l.inputPosition+=1,l.input.readByte();c+=e.right.start-h;++f}this.decodeState=b;a(this.decodeState.inputPosition);this.previousLength=0;this.pumpFirstFrame();this.currentSample=c;this.skipSamples(d-c)},ensurePosition:function(a){a(this.decodeState.inputPosition)},getFrameFloat:function(){var a=this.decodePacket();if(null==a)return this.channelBufferStart=this.channelBufferEnd=0;var b=this.finishFrame(a);this.channelBufferStart=a.left;this.channelBufferEnd=a.left+b;return b},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},
finishFrame:function(a){var b=a.len,c=a.right;a=a.left;if(0!=this.previousLength)for(var d=this.previousLength,f=this.getWindow(d),h=0,e=this.header.channel;h<e;){var l=h++,k=this.channelBuffers[l];l=this.previousWindow[l];for(var y=0,M=d;y<M;){var p=y++;k[a+p]=k[a+p]*f[p]+l[p]*f[d-1-p]}}d=this.previousLength;this.previousLength=b-c;f=0;for(h=this.header.channel;f<h;)for(k=f++,e=this.previousWindow[k],k=this.channelBuffers[k],l=0,y=b-c;l<y;)M=l++,e[M]=k[c+M];if(0==d)return 0;b<c&&(c=b);return c-a},
getWindow:function(a){a<<=1;return a==this.header.blocksize0?this.window[0]:a==this.header.blocksize1?this.window[1]:null},initBlocksize:function(a,b){var c=b>>1;this.a[a]=Array(c);this.b[a]=Array(c);this.c[a]=Array(b>>2);this.window[a]=Array(c);this.bitReverseData[a]=Array(b>>3);I.computeTwiddleFactors(b,this.a[a],this.b[a],this.c[a]);I.computeWindow(b,this.window[a]);I.computeBitReverse(b,this.bitReverseData[a])},inverseMdct:function(a,b,c){for(var d=c?1:0,f=this.a[d],h=this.b[d],e=this.c[d],l=
this.bitReverseData[d],k=b>>1,y=b>>2,M=b>>3,p=Array(k),m=k-2,B=0,v=0;v!=k;)p[m+1]=a[v]*f[B]-a[v+2]*f[B+1],p[m]=a[v]*f[B+1]+a[v+2]*f[B],m-=2,B+=2,v+=4;for(v=k-3;0<=m;)p[m+1]=-a[v+2]*f[B]- -a[v]*f[B+1],p[m]=-a[v+2]*f[B+1]+-a[v]*f[B],m-=2,B+=2,v-=4;for(var u=k-8,r=y,q=0,n=y,z=0;0<=u;){var w=p[r+1]-p[q+1],t=p[r]-p[q];a[n+1]=p[r+1]+p[q+1];a[n]=p[r]+p[q];a[z+1]=w*f[u+4]-t*f[u+5];a[z]=t*f[u+4]+w*f[u+5];w=p[r+3]-p[q+3];t=p[r+2]-p[q+2];a[n+3]=p[r+3]+p[q+3];a[n+2]=p[r+2]+p[q+2];a[z+3]=w*f[u]-t*f[u+1];a[z+2]=
t*f[u]+w*f[u+1];u-=8;n+=4;z+=4;r+=4;q+=4}for(var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],H=(16384>b?16>b?E[b]:512>b?5+E[b>>5]:10+E[b>>10]:16777216>b?524288>b?15+E[b>>15]:20+E[b>>20]:536870912>b?25+E[b>>25]:-2147483648>b?30+E[b>>30]:0)-1,F=k-1-0*y,C=F,A=F+-(b>>3),x=0,L=(b>>4>>2)+1;0<--L;){var Z=a[C]-a[A],G=a[C+-1]-a[A+-1],S=C,K=a;K[S]+=a[A];var N=C+-1,P=a;P[N]+=a[A+-1];a[A]=Z*f[x]-G*f[x+1];a[A+-1]=G*f[x]+Z*f[x+1];x+=8;Z=a[C+-2]-a[A+-2];G=a[C+-3]-a[A+-3];var U=C+-2,T=a;T[U]+=a[A+-2];var W=C+-3,ca=a;ca[W]+=
a[A+-3];a[A+-2]=Z*f[x]-G*f[x+1];a[A+-3]=G*f[x]+Z*f[x+1];x+=8;Z=a[C+-4]-a[A+-4];G=a[C+-5]-a[A+-5];var da=C+-4,aa=a;aa[da]+=a[A+-4];var ha=C+-5,X=a;X[ha]+=a[A+-5];a[A+-4]=Z*f[x]-G*f[x+1];a[A+-5]=G*f[x]+Z*f[x+1];x+=8;Z=a[C+-6]-a[A+-6];G=a[C+-7]-a[A+-7];var ba=C+-6,R=a;R[ba]+=a[A+-6];var ea=C+-7,ia=a;ia[ea]+=a[A+-7];a[A+-6]=Z*f[x]-G*f[x+1];a[A+-7]=G*f[x]+Z*f[x+1];x+=8;C-=8;A-=8}for(var V=k-1-y,I=V,ra=V+-(b>>3),J=0,na=(b>>4>>2)+1;0<--na;){var Q=a[I]-a[ra],mc=a[I+-1]-a[ra+-1],ta=I,fa=a;fa[ta]+=a[ra];var Y=
I+-1,pa=a;pa[Y]+=a[ra+-1];a[ra]=Q*f[J]-mc*f[J+1];a[ra+-1]=mc*f[J]+Q*f[J+1];J+=8;Q=a[I+-2]-a[ra+-2];mc=a[I+-3]-a[ra+-3];var ua=I+-2,oa=a;oa[ua]+=a[ra+-2];var za=I+-3,ya=a;ya[za]+=a[ra+-3];a[ra+-2]=Q*f[J]-mc*f[J+1];a[ra+-3]=mc*f[J]+Q*f[J+1];J+=8;Q=a[I+-4]-a[ra+-4];mc=a[I+-5]-a[ra+-5];var Aa=I+-4,Ga=a;Ga[Aa]+=a[ra+-4];var Ba=I+-5,qa=a;qa[Ba]+=a[ra+-5];a[ra+-4]=Q*f[J]-mc*f[J+1];a[ra+-5]=mc*f[J]+Q*f[J+1];J+=8;Q=a[I+-6]-a[ra+-6];mc=a[I+-7]-a[ra+-7];var Ca=I+-6,Ea=a;Ea[Ca]+=a[ra+-6];var Ja=I+-7,Ia=a;Ia[Ja]+=
a[ra+-7];a[ra+-6]=Q*f[J]-mc*f[J+1];a[ra+-7]=mc*f[J]+Q*f[J+1];J+=8;I-=8;ra-=8}for(var Ra=k-1-0*M,sa=0,Sa=Ra,Da=Ra+-(b>>4),xa=(b>>5>>2)+1;0<--xa;){var ka=a[Sa]-a[Da],wa=a[Sa+-1]-a[Da+-1],Ta=Sa,la=a;la[Ta]+=a[Da];var Qa=Sa+-1,cb=a;cb[Qa]+=a[Da+-1];a[Da]=ka*f[sa]-wa*f[sa+1];a[Da+-1]=wa*f[sa]+ka*f[sa+1];sa+=16;ka=a[Sa+-2]-a[Da+-2];wa=a[Sa+-3]-a[Da+-3];var Ya=Sa+-2,Za=a;Za[Ya]+=a[Da+-2];var Ua=Sa+-3,db=a;db[Ua]+=a[Da+-3];a[Da+-2]=ka*f[sa]-wa*f[sa+1];a[Da+-3]=wa*f[sa]+ka*f[sa+1];sa+=16;ka=a[Sa+-4]-a[Da+
-4];wa=a[Sa+-5]-a[Da+-5];var gb=Sa+-4,Xa=a;Xa[gb]+=a[Da+-4];var eb=Sa+-5,lb=a;lb[eb]+=a[Da+-5];a[Da+-4]=ka*f[sa]-wa*f[sa+1];a[Da+-5]=wa*f[sa]+ka*f[sa+1];sa+=16;ka=a[Sa+-6]-a[Da+-6];wa=a[Sa+-7]-a[Da+-7];var jb=Sa+-6,Ka=a;Ka[jb]+=a[Da+-6];var fb=Sa+-7,Ha=a;Ha[fb]+=a[Da+-7];a[Da+-6]=ka*f[sa]-wa*f[sa+1];a[Da+-7]=wa*f[sa]+ka*f[sa+1];Sa-=8;Da-=8;sa+=16}for(var ze=k-1-M,ma=0,Fa=ze,ja=ze+-(b>>4),tb=(b>>5>>2)+1;0<--tb;){var va=a[Fa]-a[ja],sb=a[Fa+-1]-a[ja+-1],kb=Fa,Va=a;Va[kb]+=a[ja];var hb=Fa+-1,xb=a;xb[hb]+=
a[ja+-1];a[ja]=va*f[ma]-sb*f[ma+1];a[ja+-1]=sb*f[ma]+va*f[ma+1];ma+=16;va=a[Fa+-2]-a[ja+-2];sb=a[Fa+-3]-a[ja+-3];var ib=Fa+-2,wb=a;wb[ib]+=a[ja+-2];var Wa=Fa+-3,pb=a;pb[Wa]+=a[ja+-3];a[ja+-2]=va*f[ma]-sb*f[ma+1];a[ja+-3]=sb*f[ma]+va*f[ma+1];ma+=16;va=a[Fa+-4]-a[ja+-4];sb=a[Fa+-5]-a[ja+-5];var Cb=Fa+-4,qb=a;qb[Cb]+=a[ja+-4];var Db=Fa+-5,Eb=a;Eb[Db]+=a[ja+-5];a[ja+-4]=va*f[ma]-sb*f[ma+1];a[ja+-5]=sb*f[ma]+va*f[ma+1];ma+=16;va=a[Fa+-6]-a[ja+-6];sb=a[Fa+-7]-a[ja+-7];var rb=Fa+-6,Fb=a;Fb[rb]+=a[ja+-6];
var Gb=Fa+-7,bb=a;bb[Gb]+=a[ja+-7];a[ja+-6]=va*f[ma]-sb*f[ma+1];a[ja+-7]=sb*f[ma]+va*f[ma+1];Fa-=8;ja-=8;ma+=16}for(var Jb=k-1-2*M,mb=0,yb=Jb,La=Jb+-(b>>4),Yb=(b>>5>>2)+1;0<--Yb;){var nc=a[yb]-a[La],oc=a[yb+-1]-a[La+-1],Kb=yb,Lb=a;Lb[Kb]+=a[La];var Nb=yb+-1,Ob=a;Ob[Nb]+=a[La+-1];a[La]=nc*f[mb]-oc*f[mb+1];a[La+-1]=oc*f[mb]+nc*f[mb+1];mb+=16;nc=a[yb+-2]-a[La+-2];oc=a[yb+-3]-a[La+-3];var Pb=yb+-2,Qb=a;Qb[Pb]+=a[La+-2];var Sb=yb+-3,Tb=a;Tb[Sb]+=a[La+-3];a[La+-2]=nc*f[mb]-oc*f[mb+1];a[La+-3]=oc*f[mb]+
nc*f[mb+1];mb+=16;nc=a[yb+-4]-a[La+-4];oc=a[yb+-5]-a[La+-5];var Ub=yb+-4,Vb=a;Vb[Ub]+=a[La+-4];var Wb=yb+-5,Xb=a;Xb[Wb]+=a[La+-5];a[La+-4]=nc*f[mb]-oc*f[mb+1];a[La+-5]=oc*f[mb]+nc*f[mb+1];mb+=16;nc=a[yb+-6]-a[La+-6];oc=a[yb+-7]-a[La+-7];var Zb=yb+-6,$b=a;$b[Zb]+=a[La+-6];var ac=yb+-7,cc=a;cc[ac]+=a[La+-7];a[La+-6]=nc*f[mb]-oc*f[mb+1];a[La+-7]=oc*f[mb]+nc*f[mb+1];yb-=8;La-=8;mb+=16}for(var dc=k-1-3*M,nb=0,zb=dc,Ma=dc+-(b>>4),Yc=(b>>5>>2)+1;0<--Yc;){var pc=a[zb]-a[Ma],qc=a[zb+-1]-a[Ma+-1],ec=zb,fc=
a;fc[ec]+=a[Ma];var gc=zb+-1,hc=a;hc[gc]+=a[Ma+-1];a[Ma]=pc*f[nb]-qc*f[nb+1];a[Ma+-1]=qc*f[nb]+pc*f[nb+1];nb+=16;pc=a[zb+-2]-a[Ma+-2];qc=a[zb+-3]-a[Ma+-3];var ic=zb+-2,jc=a;jc[ic]+=a[Ma+-2];var kc=zb+-3,zc=a;zc[kc]+=a[Ma+-3];a[Ma+-2]=pc*f[nb]-qc*f[nb+1];a[Ma+-3]=qc*f[nb]+pc*f[nb+1];nb+=16;pc=a[zb+-4]-a[Ma+-4];qc=a[zb+-5]-a[Ma+-5];var Kc=zb+-4,Mc=a;Mc[Kc]+=a[Ma+-4];var Nc=zb+-5,Oc=a;Oc[Nc]+=a[Ma+-5];a[Ma+-4]=pc*f[nb]-qc*f[nb+1];a[Ma+-5]=qc*f[nb]+pc*f[nb+1];nb+=16;pc=a[zb+-6]-a[Ma+-6];qc=a[zb+-7]-a[Ma+
-7];var Pc=zb+-6,Rc=a;Rc[Pc]+=a[Ma+-6];var Sc=zb+-7,Tc=a;Tc[Sc]+=a[Ma+-7];a[Ma+-6]=pc*f[nb]-qc*f[nb+1];a[Ma+-7]=qc*f[nb]+pc*f[nb+1];zb-=8;Ma-=8;nb+=16}for(var Uc=2,rd=H-3>>1;Uc<rd;)for(var Mb=Uc++,Vc=b>>Mb+2,sd=Vc>>1,Xc=0,td=1<<Mb+1;Xc<td;)for(var ud=Xc++,$c=k-1-Vc*ud,Rb=1<<Mb+3,ob=0,Ab=$c,Na=$c+-sd,yd=(b>>Mb+4>>2)+1;0<--yd;){var rc=a[Ab]-a[Na],sc=a[Ab+-1]-a[Na+-1],ad=Ab,bd=a;bd[ad]+=a[Na];var cd=Ab+-1,dd=a;dd[cd]+=a[Na+-1];a[Na]=rc*f[ob]-sc*f[ob+1];a[Na+-1]=sc*f[ob]+rc*f[ob+1];ob+=Rb;rc=a[Ab+-2]-
a[Na+-2];sc=a[Ab+-3]-a[Na+-3];var ed=Ab+-2,fd=a;fd[ed]+=a[Na+-2];var gd=Ab+-3,hd=a;hd[gd]+=a[Na+-3];a[Na+-2]=rc*f[ob]-sc*f[ob+1];a[Na+-3]=sc*f[ob]+rc*f[ob+1];ob+=Rb;rc=a[Ab+-4]-a[Na+-4];sc=a[Ab+-5]-a[Na+-5];var id=Ab+-4,jd=a;jd[id]+=a[Na+-4];var kd=Ab+-5,ld=a;ld[kd]+=a[Na+-5];a[Na+-4]=rc*f[ob]-sc*f[ob+1];a[Na+-5]=sc*f[ob]+rc*f[ob+1];ob+=Rb;rc=a[Ab+-6]-a[Na+-6];sc=a[Ab+-7]-a[Na+-7];var md=Ab+-6,nd=a;nd[md]+=a[Na+-6];var od=Ab+-7,pd=a;pd[od]+=a[Na+-7];a[Na+-6]=rc*f[ob]-sc*f[ob+1];a[Na+-7]=sc*f[ob]+
rc*f[ob+1];Ab-=8;Na-=8;ob+=Rb}for(var qd=H-3>>1,Od=H-6;qd<Od;)for(var bc=qd++,Wc=b>>bc+2,ie=1<<bc+3,Wd=Wc>>1,Xd=1<<bc+1,zd=0,Zc=k-1,Yd=(b>>bc+6)+1;0<--Yd;){for(var vd=f[zd],wd=f[zd+1],xd=f[zd+ie],Dd=f[zd+ie+1],Ed=f[zd+2*ie],Fd=f[zd+2*ie+1],Gd=f[zd+3*ie],Hd=f[zd+3*ie+1],Oa=Zc,Pa=Zc+-Wd,ge=Xd+1;0<--ge;){var tc=a[Oa]-a[Pa],uc=a[Oa+-1]-a[Pa+-1];a[Oa]+=a[Pa];a[Oa+-1]+=a[Pa+-1];a[Pa]=tc*vd-uc*wd;a[Pa+-1]=uc*vd+tc*wd;tc=a[Oa+-2]-a[Pa+-2];uc=a[Oa+-3]-a[Pa+-3];a[Oa+-2]+=a[Pa+-2];a[Oa+-3]+=a[Pa+-3];a[Pa+-2]=
tc*xd-uc*Dd;a[Pa+-3]=uc*xd+tc*Dd;tc=a[Oa+-4]-a[Pa+-4];uc=a[Oa+-5]-a[Pa+-5];a[Oa+-4]+=a[Pa+-4];a[Oa+-5]+=a[Pa+-5];a[Pa+-4]=tc*Ed-uc*Fd;a[Pa+-5]=uc*Ed+tc*Fd;tc=a[Oa+-6]-a[Pa+-6];uc=a[Oa+-7]-a[Pa+-7];a[Oa+-6]+=a[Pa+-6];a[Oa+-7]+=a[Pa+-7];a[Pa+-6]=tc*Gd-uc*Hd;a[Pa+-7]=uc*Gd+tc*Hd;Oa-=Wc;Pa-=Wc}zd+=4*ie;Zc-=8}for(var Id=k-1,Qc=f[b>>3],O=Id,he=Id-16*(b>>5);O>he;){var $a=a[O],ab=a[O+-8];a[O+-8]=$a-ab;a[O]=$a+ab;$a=a[O+-1];ab=a[O+-9];a[O+-9]=$a-ab;a[O+-1]=$a+ab;$a=a[O+-2];ab=a[O+-10];var je=$a-ab;a[O+-2]=
$a+ab;$a=a[O+-3];ab=a[O+-11];var ke=$a-ab;a[O+-3]=$a+ab;a[O+-10]=(je+ke)*Qc;a[O+-11]=(ke-je)*Qc;$a=a[O+-4];ab=a[O+-12];je=ab-$a;a[O+-4]=$a+ab;$a=a[O+-5];ab=a[O+-13];ke=$a-ab;a[O+-5]=$a+ab;a[O+-12]=ke;a[O+-13]=je;$a=a[O+-6];ab=a[O+-14];je=ab-$a;a[O+-6]=$a+ab;$a=a[O+-7];ab=a[O+-15];ke=$a-ab;a[O+-7]=$a+ab;a[O+-14]=(je+ke)*Qc;a[O+-15]=(je-ke)*Qc;var be=a[O],ce=a[O+-4],Jd=be-ce,Kd=be+ce;be=a[O+-2];ce=a[O+-6];var Ld=be+ce,Md=be-ce;a[O]=Kd+Ld;a[O+-2]=Kd-Ld;var Nd=a[O+-3]-a[O+-7];a[O+-4]=Jd+Nd;a[O+-6]=Jd-
Nd;be=a[O+-1];ce=a[O+-5];var Pd=be-ce,Qd=be+ce,Rd=a[O+-3]+a[O+-7];a[O+-1]=Qd+Rd;a[O+-3]=Qd-Rd;a[O+-5]=Pd-Md;a[O+-7]=Pd+Md;var ub=O-8,de=a[ub],ee=a[ub+-4],Sd=de-ee,Td=de+ee;de=a[ub+-2];ee=a[ub+-6];var Ud=de+ee,Vd=de-ee;a[ub]=Td+Ud;a[ub+-2]=Td-Ud;var Zd=a[ub+-3]-a[ub+-7];a[ub+-4]=Sd+Zd;a[ub+-6]=Sd-Zd;de=a[ub+-1];ee=a[ub+-5];var $d=de-ee,ae=de+ee,fe=a[ub+-3]+a[ub+-7];a[ub+-1]=ae+fe;a[ub+-3]=ae-fe;a[ub+-5]=$d-Vd;a[ub+-7]=$d+Vd;O-=16}for(var Cd=0,le=y-4,vc=k-4;0<=le;){var Ad=l[Cd];p[vc+3]=a[Ad];p[vc+2]=
a[Ad+1];p[le+3]=a[Ad+2];p[le+2]=a[Ad+3];Ad=l[Cd+1];p[vc+1]=a[Ad];p[vc]=a[Ad+1];p[le+1]=a[Ad+2];p[le]=a[Ad+3];le-=4;vc-=4;Cd+=2}for(var Bd=0,Hb=0,Ib=k-4;Hb<Ib;){var wc=p[Hb]-p[Ib+2],xc=p[Hb+1]+p[Ib+3],yc=e[Bd+1]*wc+e[Bd]*xc,Ac=e[Bd+1]*xc-e[Bd]*wc,Bc=p[Hb]+p[Ib+2],Cc=p[Hb+1]-p[Ib+3];p[Hb]=Bc+yc;p[Hb+1]=Cc+Ac;p[Ib+2]=Bc-yc;p[Ib+3]=Ac-Cc;wc=p[Hb+2]-p[Ib];xc=p[Hb+3]+p[Ib+1];yc=e[Bd+3]*wc+e[Bd+2]*xc;Ac=e[Bd+3]*xc-e[Bd+2]*wc;Bc=p[Hb+2]+p[Ib];Cc=p[Hb+3]-p[Ib+1];p[Hb+2]=Bc+yc;p[Hb+3]=Cc+Ac;p[Ib]=Bc-yc;p[Ib+
1]=Ac-Cc;Bd+=4;Hb+=4;Ib-=4}for(var Bb=k-8,vb=k-8,Dc=0,Ec=k-4,Fc=k,Gc=b-4;0<=vb;){var Hc=p[vb+6]*h[Bb+7]-p[vb+7]*h[Bb+6],Ic=-p[vb+6]*h[Bb+6]-p[vb+7]*h[Bb+7];a[Dc]=Hc;a[Ec+3]=-Hc;a[Fc]=Ic;a[Gc+3]=Ic;var Jc=p[vb+4]*h[Bb+5]-p[vb+5]*h[Bb+4],Lc=-p[vb+4]*h[Bb+4]-p[vb+5]*h[Bb+5];a[Dc+1]=Jc;a[Ec+2]=-Jc;a[Fc+1]=Lc;a[Gc+2]=Lc;Hc=p[vb+2]*h[Bb+3]-p[vb+3]*h[Bb+2];Ic=-p[vb+2]*h[Bb+2]-p[vb+3]*h[Bb+3];a[Dc+2]=Hc;a[Ec+1]=-Hc;a[Fc+2]=Ic;a[Gc+1]=Ic;Jc=p[vb]*h[Bb+1]-p[vb+1]*h[Bb];Lc=-p[vb]*h[Bb]-p[vb+1]*h[Bb+1];a[Dc+
3]=Jc;a[Ec]=-Jc;a[Fc+3]=Lc;a[Gc]=Lc;Bb-=8;vb-=8;Dc+=4;Fc+=4;Ec-=4;Gc-=4}},decodePacket:function(){var a=this.decodeInitial();return null==a?null:this.decodePacketRest(a)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;var a=this.decodeState;if(0>a.validBits)a=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<
a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}if(0>a.validBits)a=0;else{var b=a.acc&1;a.acc>>>=1;--a.validBits;a=b}}else b=a.acc&1,a.acc>>>=1,--a.validBits,a=b;if(0!=a)for(;a=this.decodeState,0!=a.bytesInSeg||!a.lastSeg&&0!=a.next()?(a.bytesInSeg--,a.inputPosition+=1,b=a.input.readByte()):b=-1,a.validBits=0,-1!=b;);else break}a=this.decodeState;b=this.header.modes.length-1;var c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];b=16384>b?16>b?c[b]:512>b?5+c[b>>5]:10+c[b>>10]:16777216>
b?524288>b?15+c[b>>15]:20+c[b>>20]:536870912>b?25+c[b>>25]:-2147483648>b?30+c[b>>30]:0;if(0>a.validBits)a=0;else if(a.validBits<b)if(24<b)a=a.readBits(24)+(a.readBits(b-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<b))break}0>a.validBits?a=0:(c=a.acc&(1<<b)-1,a.acc>>>=b,a.validBits-=b,a=c)}else c=a.acc&(1<<b)-1,a.acc>>>=b,
a.validBits-=b,a=c;if(-1==a||a>=this.header.modes.length)throw new r(new H(q.SEEK_FAILED,null,{fileName:"VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));b=this.header.modes[a];if(b.blockflag){c=this.header.blocksize1;var d=this.decodeState;if(0>d.validBits)d=0;else if(1>d.validBits){0==d.validBits&&(d.acc=0);for(;;){if(0!=d.bytesInSeg||!d.lastSeg&&0!=d.next())d.bytesInSeg--,d.inputPosition+=1,d.acc+=d.input.readByte()<<d.validBits,d.validBits+=
8;else{d.validBits=-1;break}if(!(1>d.validBits))break}if(0>d.validBits)d=0;else{var f=d.acc&1;d.acc>>>=1;--d.validBits;d=f}}else f=d.acc&1,d.acc>>>=1,--d.validBits,d=f;f=this.decodeState;if(0>f.validBits)f=0;else if(1>f.validBits){0==f.validBits&&(f.acc=0);for(;;){if(0!=f.bytesInSeg||!f.lastSeg&&0!=f.next())f.bytesInSeg--,f.inputPosition+=1,f.acc+=f.input.readByte()<<f.validBits,f.validBits+=8;else{f.validBits=-1;break}if(!(1>f.validBits))break}if(0>f.validBits)f=0;else{var h=f.acc&1;f.acc>>>=1;--f.validBits;
f=h}}else h=f.acc&1,f.acc>>>=1,--f.validBits,f=h}else d=f=0,c=this.header.blocksize0;h=c>>1;return{mode:a,left:b.blockflag&&0==d?{start:c-this.header.blocksize0>>2,end:c+this.header.blocksize0>>2}:{start:0,end:h},right:b.blockflag&&0==f?{start:3*c-this.header.blocksize0>>2,end:3*c+this.header.blocksize0>>2}:{start:h,end:c}}},decodePacketRest:function(a){for(var b=this.header.modes[a.mode],c=Array(256),d=Array(256),f=b.blockflag?this.header.blocksize1:this.header.blocksize0,h=this.header.mapping[b.mapping],
e=f>>1,l=[256,128,86,64],k=this.header.codebooks,y=0,m=this.header.channel;y<m;){var p=y++,D=h.chan[p].mux;c[p]=!1;var B=this.header.floorConfig[h.submapFloor[D]];if(0==B.type)throw new r(new H(q.INVALID_STREAM,null,{fileName:"VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var v=B.floor1,u=this.decodeState;if(0>u.validBits)var n=0;else if(1>u.validBits){0==u.validBits&&(u.acc=0);for(;;){if(0!=u.bytesInSeg||!u.lastSeg&&0!=u.next())u.bytesInSeg--,
u.inputPosition+=1,u.acc+=u.input.readByte()<<u.validBits,u.validBits+=8;else{u.validBits=-1;break}if(!(1>u.validBits))break}if(0>u.validBits)n=0;else{var z=u.acc&1;u.acc>>>=1;--u.validBits;n=z}}else{var w=u.acc&1;u.acc>>>=1;--u.validBits;n=w}if(0!=n){var A=[],C=Array(256),t=l[v.floor1Multiplier-1],E=2;A=this.finalY[p];var x=this.decodeState,F=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],G=(16384>t?16>t?F[t]:512>t?5+F[t>>5]:10+F[t>>10]:16777216>t?524288>t?15+F[t>>15]:20+F[t>>20]:536870912>t?25+F[t>>25]:-2147483648>
t?30+F[t>>30]:0)-1;if(0>x.validBits)var J=0;else if(x.validBits<G)if(24<G)J=x.readBits(24)+(x.readBits(G-24)<<24);else{0==x.validBits&&(x.acc=0);for(;;){if(0!=x.bytesInSeg||!x.lastSeg&&0!=x.next())x.bytesInSeg--,x.inputPosition+=1,x.acc+=x.input.readByte()<<x.validBits,x.validBits+=8;else{x.validBits=-1;break}if(!(x.validBits<G))break}if(0>x.validBits)J=0;else{var L=x.acc&(1<<G)-1;x.acc>>>=G;x.validBits-=G;J=L}}else{var S=x.acc&(1<<G)-1;x.acc>>>=G;x.validBits-=G;J=S}A[0]=J;var Z=this.decodeState,
K=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],I=(16384>t?16>t?K[t]:512>t?5+K[t>>5]:10+K[t>>10]:16777216>t?524288>t?15+K[t>>15]:20+K[t>>20]:536870912>t?25+K[t>>25]:-2147483648>t?30+K[t>>30]:0)-1;if(0>Z.validBits)var P=0;else if(Z.validBits<I)if(24<I)P=Z.readBits(24)+(Z.readBits(I-24)<<24);else{0==Z.validBits&&(Z.acc=0);for(;;){if(0!=Z.bytesInSeg||!Z.lastSeg&&0!=Z.next())Z.bytesInSeg--,Z.inputPosition+=1,Z.acc+=Z.input.readByte()<<Z.validBits,Z.validBits+=8;else{Z.validBits=-1;break}if(!(Z.validBits<I))break}if(0>
Z.validBits)P=0;else{var N=Z.acc&(1<<I)-1;Z.acc>>>=I;Z.validBits-=I;P=N}}else{var U=Z.acc&(1<<I)-1;Z.acc>>>=I;Z.validBits-=I;P=U}A[1]=P;for(var T=0,W=v.partitions;T<W;){var ca=T++,Q=v.partitionClassList[ca],da=v.classDimensions[Q],aa=v.classSubclasses[Q],ha=(1<<aa)-1,X=0;if(0!=aa){var ba=k[v.classMasterbooks[Q]],R=this.decodeState;10>R.validBits&&R.prepHuffman();var ea=ba.fastHuffman[R.acc&1023];if(0<=ea){var ia=ba.codewordLengths[ea];R.acc>>>=ia;R.validBits-=ia;if(0>R.validBits){R.validBits=0;var V=
-1}else V=ea}else V=R.decodeScalarRaw(ba);ba.sparse&&(V=ba.sortedValues[V]);X=V}for(var na=v.subclassBooks[Q],ra=0,ta=da;ra<ta;){ra++;var ka=na[X&ha];X>>=aa;var wa=E++;if(0<=ka){var fa=this.decodeState,Y=k[ka];10>fa.validBits&&fa.prepHuffman();var pa=Y.fastHuffman[fa.acc&1023];if(0<=pa){var ua=Y.codewordLengths[pa];fa.acc>>>=ua;fa.validBits-=ua;if(0>fa.validBits){fa.validBits=0;var oa=-1}else oa=pa}else oa=fa.decodeScalarRaw(Y);Y.sparse&&(oa=Y.sortedValues[oa]);var za=oa}else za=0;A[wa]=za}}if(-1==
this.decodeState.validBits)c[p]=!0;else{C[0]=C[1]=!0;for(var ya=v.neighbors,Aa=v.xlist,Ga=2,Ba=v.values;Ga<Ba;){var qa=Ga++,Ca=ya[qa][0],Ea=ya[qa][1],Ja=Aa[Ca],Ia=A[Ca],Ra=A[Ea]-Ia,Ta=Math.abs(Ra)*(Aa[qa]-Ja)/(Aa[Ea]-Ja)|0,la=0>Ra?Ia-Ta:Ia+Ta,sa=A[qa],Sa=t-la,Da=Sa<la?2*Sa:2*la;0!=sa?(C[Ca]=C[Ea]=!0,C[qa]=!0,A[qa]=sa>=Da?Sa>la?sa-la+la:la-sa+Sa-1:0!=(sa&1)?la-(sa+1>>1):la+(sa>>1)):(C[qa]=!1,A[qa]=la)}for(var Qa=0,cb=v.values;Qa<cb;){var Ya=Qa++;C[Ya]||(A[Ya]=-1)}}}else c[p]=!0}for(var Za=0,xa=this.header.channel;Za<
xa;){var Ua=Za++;d[Ua]=c[Ua]}for(var db=0,gb=h.couplingSteps;db<gb;){var Xa=db++;c[h.chan[Xa].magnitude]&&c[h.chan[Xa].angle]||(c[h.chan[Xa].magnitude]=c[h.chan[Xa].angle]=!1)}for(var eb=0,lb=h.submaps;eb<lb;){for(var jb=eb++,Ka=Array(this.header.channel),fb=Array(256),Ha=0,kb=0,Va=this.header.channel;kb<Va;){var hb=kb++;h.chan[hb].mux==jb&&(c[hb]?(fb[Ha]=!0,Ka[Ha]=null):(fb[Ha]=!1,Ka[Ha]=this.channelBuffers[hb]),++Ha)}this.header.residueConfig[h.submapResidue[jb]].decode(this.decodeState,this.header,
Ka,Ha,e,fb,this.channelBuffers)}for(var ib=h.couplingSteps,tb=f>>1;0<=--ib;)for(var ma=this.channelBuffers[h.chan[ib].magnitude],Fa=this.channelBuffers[h.chan[ib].angle],ja=0,wb=tb;ja<wb;){var va=ja++;if(0<ma[va])if(0<Fa[va]){var sb=ma[va];var Wa=ma[va]-Fa[va]}else Wa=ma[va],sb=ma[va]+Fa[va];else 0<Fa[va]?(sb=ma[va],Wa=ma[va]+Fa[va]):(Wa=ma[va],sb=ma[va]-Fa[va]);ma[va]=sb;Fa[va]=Wa}for(var pb=0,Cb=this.header.channel;pb<Cb;){var xb=pb++;if(d[xb])for(var qb=0,Db=tb;qb<Db;){var Eb=qb++;this.channelBuffers[xb][Eb]=
0}else h.doFloor(this.header.floorConfig,xb,f,this.channelBuffers[xb],this.finalY[xb],null)}for(var rb=0,Fb=this.header.channel;rb<Fb;){var Gb=rb++;this.inverseMdct(this.channelBuffers[Gb],f,b.blockflag)}for(var bb=this.decodeState;0!=bb.bytesInSeg||!bb.lastSeg&&0!=bb.next();)bb.bytesInSeg--,bb.inputPosition+=1,bb.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,f,a)},__class__:kc};var I=function(){};m["kha.audio2.ogg.vorbis.VorbisTools"]=I;I.__name__=!0;I.pointCompare=
function(a,b){return a.x<b.x?-1:a.x>b.x?1:0};I.uintAsc=function(a,b){return S.gt(b,a)?-1:a==b?0:1};I.lookup1Values=function(a,b){var c=Math.exp(Math.log(a)/b)|0;(Math.pow(c+1,b)|0)<=a&&++c;return c};I.computeWindow=function(a,b){for(var c=a>>1,d=0;d<c;){var f=d++;b[f]=Math.sin(1.5707963267948966*I.square(Math.sin((f+.5)/c*1.5707963267948966)))}};I.square=function(a){return a*a};I.computeBitReverse=function(a,b){var c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];c=(16384>a?16>a?c[a]:512>a?5+c[a>>5]:10+c[a>>10]:
16777216>a?524288>a?15+c[a>>15]:20+c[a>>20]:536870912>a?25+c[a>>25]:-2147483648>a?30+c[a>>30]:0)-1;for(var d=0,f=a>>3;d<f;){var h=d++,e=h;e=(e&-1431655766)>>>1|(e&1431655765)<<1;e=(e&-858993460)>>>2|(e&858993459)<<2;e=(e&-252645136)>>>4|(e&252645135)<<4;e=(e&-16711936)>>>8|(e&16711935)<<8;b[h]=(e>>>16|e<<16)>>>32-c+3<<2}};I.computeTwiddleFactors=function(a,b,c,d){for(var f=0,h=0,e=a>>2;h<e;){var l=h++;b[f]=Math.cos(12.566370614359172*l/a);b[f+1]=-Math.sin(12.566370614359172*l/a);c[f]=.5*Math.cos(3.141592653589793*
(f+1)/a/2);c[f+1]=.5*Math.sin(3.141592653589793*(f+1)/a/2);f+=2}c=b=0;for(f=a>>3;c<f;)c++,d[b]=Math.cos(6.283185307179586*(b+1)/a),d[b+1]=-Math.sin(6.283185307179586*(b+1)/a),b+=2};I.drawLine=function(a,b,c,d,f,h){if(null==I.integerDivideTable){I.integerDivideTable=Array(32);for(var e=0;32>e;){var l=e++;I.integerDivideTable[l]=Array(64);for(var k=1;64>k;){var y=k++;I.integerDivideTable[l][y]=l/y|0}}}y=f-c;f=d-b;e=0>y?-y:y;l=c;k=0;64>f&&32>e?0>y?(c=-I.integerDivideTable[e][f],y=c-1):(c=I.integerDivideTable[e][f],
y=c+1):(c=y/f|0,y=0>y?c-1:c+1);e-=(0>c?-c:c)*f;d>h&&(d=h);a[b]*=I.INVERSE_DB_TABLE[l];for(b+=1;b<d;){h=b++;k+=e;k>=f?(k-=f,l+=y):l+=c;var m=a;m[h]*=I.INVERSE_DB_TABLE[l]}};var bd=function(){};m["kha.audio2.ogg.vorbis.data.Codebook"]=bd;bd.__name__=!0;bd.read=function(a){var b=new bd;if(0>a.validBits)var c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=
-1;break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=8;if(66==c){if(0>a.validBits)c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=
8;c=67!=c}else c=!0;if(c)c=!0;else{if(0>a.validBits)c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=8;c=86!=c}if(c)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",
methodName:"read"}));if(0>a.validBits)c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=8;if(0>a.validBits)var d=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=
a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?d=0:(d=a.acc&255,a.acc>>>=8,a.validBits-=8)}else d=a.acc&255,a.acc>>>=8,a.validBits-=8;b.dimensions=(d<<8)+c;if(0>a.validBits)c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;
break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=8;if(0>a.validBits)d=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?d=0:(d=a.acc&255,a.acc>>>=8,a.validBits-=8)}else d=a.acc&255,a.acc>>>=8,a.validBits-=8;if(0>
a.validBits)var f=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?f=0:(f=a.acc&255,a.acc>>>=8,a.validBits-=8)}else f=a.acc&255,a.acc>>>=8,a.validBits-=8;b.entries=(f<<16)+(d<<8)+c;if(0>a.validBits)f=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=
a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>a.validBits?f=0:(c=a.acc&1,a.acc>>>=1,--a.validBits,f=c)}else c=a.acc&1,a.acc>>>=1,--a.validBits,f=c;if(0!=f)c=!1;else{if(0>a.validBits)c=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>
a.validBits))break}0>a.validBits?c=0:(c=a.acc&1,a.acc>>>=1,--a.validBits)}else c=a.acc&1,a.acc>>>=1,--a.validBits;c=0!=c}b.sparse=c;c=Array(b.entries);b.sparse||(b.codewordLengths=c);d=0;if(0!=f){f=0;if(0>a.validBits)var h=0;else if(5>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(5>a.validBits))break}0>a.validBits?h=0:(h=a.acc&31,a.acc>>>=
5,a.validBits-=5)}else h=a.acc&31,a.acc>>>=5,a.validBits-=5;for(h+=1;f<b.entries;){var e=b.entries-f,l=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];e=16384>e?16>e?l[e]:512>e?5+l[e>>5]:10+l[e>>10]:16777216>e?524288>e?15+l[e>>15]:20+l[e>>20]:536870912>e?25+l[e>>25]:-2147483648>e?30+l[e>>30]:0;if(0>a.validBits)e=0;else if(a.validBits<e)if(24<e)e=a.readBits(24)+(a.readBits(e-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<
a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<e))break}0>a.validBits?e=0:(l=a.acc&(1<<e)-1,a.acc>>>=e,a.validBits-=e,e=l)}else l=a.acc&(1<<e)-1,a.acc>>>=e,a.validBits-=e,e=l;if(f+e>b.entries)throw new r(new H(q.INVALID_SETUP,"codebook entrys",{fileName:"Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));l=0;for(var k=e;l<k;){var y=l++;c[f+y]=h}f+=e;++h}}else for(f=0,h=b.entries;f<h;){e=f++;if(b.sparse)if(0>a.validBits)l=0;else if(1>
a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>a.validBits?l=0:(l=a.acc&1,a.acc>>>=1,--a.validBits)}else l=a.acc&1,a.acc>>>=1,--a.validBits;else l=1;if(0!=l){if(0>a.validBits)l=0;else if(5>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=
a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(5>a.validBits))break}0>a.validBits?l=0:(l=a.acc&31,a.acc>>>=5,a.validBits-=5)}else l=a.acc&31,a.acc>>>=5,a.validBits-=5;c[e]=l+1;++d}else c[e]=255}b.sparse&&d>=b.entries>>2&&(b.codewordLengths=c,b.sparse=!1);if(!b.sparse)for(f=d=0,h=b.entries;f<h;)e=f++,e=c[e],10<e&&255!=e&&++d;b.sortedEntries=d;d=null;b.sparse?0!=b.sortedEntries&&(b.codewordLengths=Array(b.sortedEntries),b.codewords=Array(b.entries),d=Array(b.entries)):
b.codewords=Array(b.entries);if(!b.computeCodewords(c,b.entries,d))throw new r(new H(q.INVALID_SETUP,"compute codewords",{fileName:"Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));0!=b.sortedEntries&&(b.sortedCodewords=[],b.sortedValues=Array(b.sortedEntries),b.computeSortedHuffman(c,d));b.sparse&&(b.codewords=null);b.computeAcceleratedHuffman();if(0>a.validBits)c=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&
0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}0>a.validBits?c=0:(c=a.acc&15,a.acc>>>=4,a.validBits-=4)}else c=a.acc&15,a.acc>>>=4,a.validBits-=4;b.lookupType=c;if(2<b.lookupType)throw new r(new H(q.INVALID_SETUP,"codebook lookup type",{fileName:"Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<b.lookupType){0>a.validBits?c=0:32>a.validBits?
c=a.readBits(24)+(a.readBits(8)<<24):(c=a.acc&-1,a.acc>>>=32,a.validBits-=32);d=S.toFloat(c&2097151);b.minimumValue=(0!=(c&-2147483648)?-d:d)*Math.pow(2,((c&2145386496)>>>21)-788);0>a.validBits?c=0:32>a.validBits?c=a.readBits(24)+(a.readBits(8)<<24):(c=a.acc&-1,a.acc>>>=32,a.validBits-=32);d=S.toFloat(c&2097151);b.deltaValue=(0!=(c&-2147483648)?-d:d)*Math.pow(2,((c&2145386496)>>>21)-788);if(0>a.validBits)c=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&
0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}0>a.validBits?c=0:(c=a.acc&15,a.acc>>>=4,a.validBits-=4)}else c=a.acc&15,a.acc>>>=4,a.validBits-=4;b.valueBits=c+1;if(0>a.validBits)c=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>
a.validBits))break}0>a.validBits?c=0:(c=a.acc&1,a.acc>>>=1,--a.validBits)}else c=a.acc&1,a.acc>>>=1,--a.validBits;b.sequenceP=0!=c;b.lookupValues=1==b.lookupType?I.lookup1Values(b.entries,b.dimensions):b.entries*b.dimensions;c=Array(b.lookupValues);d=0;for(f=b.lookupValues;d<f;){h=d++;e=b.valueBits;if(0>a.validBits)e=0;else if(a.validBits<e)if(24<e)e=a.readBits(24)+(a.readBits(e-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=
1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<e))break}0>a.validBits?e=0:(l=a.acc&(1<<e)-1,a.acc>>>=e,a.validBits-=e,e=l)}else l=a.acc&(1<<e)-1,a.acc>>>=e,a.validBits-=e,e=l;if(-1==e)throw new r(new H(q.INVALID_SETUP,"fail lookup",{fileName:"Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));c[h]=e}b.multiplicands=Array(b.lookupValues);a=0;for(d=b.lookupValues;a<d;)f=a++,b.multiplicands[f]=c[f]*b.deltaValue+
b.minimumValue;if(2==b.lookupType&&b.sequenceP){a=1;for(c=b.lookupValues;a<c;)d=a++,b.multiplicands[d]=b.multiplicands[d-1];b.sequenceP=!1}}return b};bd.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,computeCodewords:function(a,b,c){for(var d=Array(32),f=0;32>f;){var h=
f++;d[h]=0}for(var e=0;e<b&&!(255>a[e]);)++e;if(e==b)return!0;f=0;h=f++;this.sparse?(this.codewords[h]=0,this.codewordLengths[h]=a[e],c[h]=e):this.codewords[e]=0;for(h=0;++h<=a[e];)d[h]=1<<32-h;for(h=e;++h<b;)if(e=a[h],255!=e){for(;0<e&&0==d[e];)--e;if(0==e)return!1;var l=d[e];d[e]=0;var k=l;k=(k&-1431655766)>>>1|(k&1431655765)<<1;k=(k&-858993460)>>>2|(k&858993459)<<2;k=(k&-252645136)>>>4|(k&252645135)<<4;k=(k&-16711936)>>>8|(k&16711935)<<8;k=k>>>16|k<<16;var y=f++;this.sparse?(this.codewords[y]=
k,this.codewordLengths[y]=a[h],c[y]=h):this.codewords[h]=k;if(e!=a[h])for(k=a[h];k>e;)d[k]=l+(1<<32-k),--k}return!0},computeSortedHuffman:function(a,b){if(this.sparse)for(var c=0,d=this.sortedEntries;c<d;){var f=c++,e=this.codewords[f];e=(e&-1431655766)>>>1|(e&1431655765)<<1;e=(e&-858993460)>>>2|(e&858993459)<<2;e=(e&-252645136)>>>4|(e&252645135)<<4;e=(e&-16711936)>>>8|(e&16711935)<<8;this.sortedCodewords[f]=e>>>16|e<<16}else for(d=c=0,f=this.entries;d<f;){e=d++;var g=a[e];if(this.sparse||(255==g?
0:10<g))e=this.codewords[e],e=(e&-1431655766)>>>1|(e&1431655765)<<1,e=(e&-858993460)>>>2|(e&858993459)<<2,e=(e&-252645136)>>>4|(e&252645135)<<4,e=(e&-16711936)>>>8|(e&16711935)<<8,this.sortedCodewords[c++]=e>>>16|e<<16}this.sortedCodewords[this.sortedEntries]=-1;this.sortedCodewords.sort(I.uintAsc);c=0;for(d=this.sparse?this.sortedEntries:this.entries;c<d;)if(f=c++,e=this.sparse?a[b[f]]:a[f],this.sparse||(255==e?0:10<e)){g=this.codewords[f];g=(g&-1431655766)>>>1|(g&1431655765)<<1;g=(g&-858993460)>>>
2|(g&858993459)<<2;g=(g&-252645136)>>>4|(g&252645135)<<4;g=(g&-16711936)>>>8|(g&16711935)<<8;g=g>>>16|g<<16;for(var l=0,k=this.sortedEntries;1<k;){var y=l+(k>>1);S.gte(g,this.sortedCodewords[y])?(l=y,k-=k>>1):k>>=1}this.sparse?(this.sortedValues[l]=b[f],this.codewordLengths[l]=e):this.sortedValues[l]=f}},computeAcceleratedHuffman:function(){this.fastHuffman=Array(1024);this.fastHuffman[0]=-1;for(var a=0;1024>a;){var b=a++;this.fastHuffman[b]=-1}a=0;for(b=this.sparse?this.sortedEntries:this.entries;a<
b;){var c=a++;if(10>=this.codewordLengths[c]){if(this.sparse){var d=this.sortedCodewords[c];d=(d&-1431655766)>>>1|(d&1431655765)<<1;d=(d&-858993460)>>>2|(d&858993459)<<2;d=(d&-252645136)>>>4|(d&252645135)<<4;d=(d&-16711936)>>>8|(d&16711935)<<8;d=d>>>16|d<<16}else d=this.codewords[c];for(;1024>d;)this.fastHuffman[d]=c,d+=1<<this.codewordLengths[c]}}},codebookDecode:function(a,b,c,d){10>a.validBits&&a.prepHuffman();var f=this.fastHuffman[a.acc&1023];if(0<=f){var e=this.codewordLengths[f];a.acc>>>=e;
a.validBits-=e;0>a.validBits?(a.validBits=0,a=-1):a=f}else a=a.decodeScalarRaw(this);this.sparse&&(a=this.sortedValues[a]);var g=this.lookupValues,l=this.sequenceP;f=this.multiplicands;e=this.minimumValue;if(0>a)return!1;d>this.dimensions&&(d=this.dimensions);if(1==this.lookupType){for(var k=1,y=0,m=0;m<d;){var p=m++,D=S.toFloat(a/k|0)%S.toFloat(g)|0;D=f[D]+y;p=c+p;var B=b;B[p]+=D;l&&(y=D+e);k*=g}return!0}a*=this.dimensions;if(l)for(g=l=0;g<d;)k=g++,l=f[a+k]+l,k=c+k,y=b,y[k]+=l,l+=e;else for(e=0;e<
d;)g=e++,l=c+g,k=b,k[l]+=f[a+g]+0;return!0},codebookDecodeStep:function(a,b,c,d,f){10>a.validBits&&a.prepHuffman();var e=this.fastHuffman[a.acc&1023];if(0<=e){var g=this.codewordLengths[e];a.acc>>>=g;a.validBits-=g;0>a.validBits?(a.validBits=0,a=-1):a=e}else a=a.decodeScalarRaw(this);this.sparse&&(a=this.sortedValues[a]);e=0;if(0>a)return!1;d>this.dimensions&&(d=this.dimensions);var l=this.lookupValues;g=this.sequenceP;var k=this.multiplicands;if(1==this.lookupType){for(var y=1,m=0;m<d;){var p=m++,
D=S.toFloat(a/y|0)%S.toFloat(l)|0;D=k[D]+e;p=c+p*f;var B=b;B[p]+=D;g&&(e=D);y*=l}return!0}a*=this.dimensions;l=0;for(y=d;l<y;)d=l++,m=k[a+d]+e,d=c+d*f,D=b,D[d]+=m,g&&(e=m);return!0},decodeDeinterleaveRepeat:function(a,b,c,d,f,e,g){var h=this.dimensions;if(0==this.lookupType)throw new r(new H(q.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var k=this.multiplicands,y=this.sequenceP,m=this.lookupValues;0<
g;){var p=0;10>a.validBits&&a.prepHuffman();var D=this.fastHuffman[a.acc&1023];if(0<=D){var B=this.codewordLengths[D];a.acc>>>=B;a.validBits-=B;0>a.validBits&&(a.validBits=0,D=-1)}else D=a.decodeScalarRaw(this);this.sparse&&(D=this.sortedValues[D]);if(0>D){if(0==a.bytesInSeg&&a.lastSeg)return null;throw new r(new H(q.INVALID_STREAM,null,{fileName:"Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));}d+f*c+h>e*c&&(h=e*c-(f*c-d));if(1==
this.lookupType)if(B=1,y)for(var v=0,u=h;v<u;){v++;var n=S.toFloat(D/B|0)%S.toFloat(m)|0;p=k[n]+p;n=f;var z=b[d];z[n]+=p;++d==c&&(d=0,++f);B*=m}else for(v=0,u=h;v<u;){v++;n=S.toFloat(D/B|0)%S.toFloat(m)|0;z=f;var t=b[d];t[z]+=k[n]+p;++d==c&&(d=0,++f);B*=m}else if(D*=this.dimensions,y)for(B=0,v=h;B<v;)u=B++,p=k[D+u]+p,u=f,n=b[d],n[u]+=p,++d==c&&(d=0,++f);else for(B=0,v=h;B<v;)u=B++,n=f,z=b[d],z[n]+=k[D+u]+p,++d==c&&(d=0,++f);g-=h}return{cInter:d,pInter:f}},residueDecode:function(a,b,c,d,f){if(0==f){f=
d/this.dimensions|0;for(var e=0;e<f;){var g=e++;if(!this.codebookDecodeStep(a,b,c+g,d-c-g,f))return!1}}else for(f=0;f<d;){if(!this.codebookDecode(a,b,c,d-f))return!1;f+=this.dimensions;c+=this.dimensions}return!0},__class__:bd};var fe=function(){this.data=new Oc};m["kha.audio2.ogg.vorbis.data.Comment"]=fe;fe.__name__=!0;fe.prototype={data:null,get_loopStart:function(){return Ga.parseInt(this.getString("loopstart"))},get_loopLength:function(){return Ga.parseInt(this.getString("looplength"))},add:function(a,
b){a=a.toLowerCase();var c=this.data;if(null!=pb[a]?c.existsReserved(a):c.h.hasOwnProperty(a))c=this.data,(null!=pb[a]?c.getReserved(a):c.h[a]).push(b);else{c=[b];var d=this.data;null!=pb[a]?d.setReserved(a,c):d.h[a]=c}},getString:function(a){a=a.toLowerCase();var b=this.data;return(null!=pb[a]?b.existsReserved(a):b.h.hasOwnProperty(a))?(b=this.data,(null!=pb[a]?b.getReserved(a):b.h[a])[0]):null},__class__:fe};var cd=function(){};m["kha.audio2.ogg.vorbis.data.Floor"]=cd;cd.__name__=!0;cd.read=function(a,
b){var c=new cd;if(0>a.validBits)var d=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}if(0>a.validBits)d=0;else{var f=a.acc&65535;a.acc>>>=16;a.validBits-=16;d=f}}else{var e=a.acc&65535;a.acc>>>=16;a.validBits-=16;d=e}c.type=d;if(1<c.type)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:28,
className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==c.type){var g=c.floor0=new Cd;if(0>a.validBits)var l=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}if(0>a.validBits)l=0;else{var k=a.acc&255;a.acc>>>=8;a.validBits-=8;l=k}}else{var y=a.acc&255;a.acc>>>=8;a.validBits-=8;l=y}g.order=l;
if(0>a.validBits)var m=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}if(0>a.validBits)m=0;else{var p=a.acc&65535;a.acc>>>=16;a.validBits-=16;m=p}}else{var D=a.acc&65535;a.acc>>>=16;a.validBits-=16;m=D}g.rate=m;if(0>a.validBits)var B=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||
!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}if(0>a.validBits)B=0;else{var v=a.acc&65535;a.acc>>>=16;a.validBits-=16;B=v}}else{var u=a.acc&65535;a.acc>>>=16;a.validBits-=16;B=u}g.barkMapSize=B;if(0>a.validBits)var n=0;else if(6>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,
a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}if(0>a.validBits)n=0;else{var z=a.acc&63;a.acc>>>=6;a.validBits-=6;n=z}}else{var t=a.acc&63;a.acc>>>=6;a.validBits-=6;n=t}g.amplitudeBits=n;if(0>a.validBits)var w=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}if(0>a.validBits)w=0;else{var x=
a.acc&255;a.acc>>>=8;a.validBits-=8;w=x}}else{var A=a.acc&255;a.acc>>>=8;a.validBits-=8;w=A}g.amplitudeOffset=w;if(0>a.validBits)var C=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}if(0>a.validBits)C=0;else{var E=a.acc&15;a.acc>>>=4;a.validBits-=4;C=E}}else{var F=a.acc&15;a.acc>>>=4;a.validBits-=4;C=F}g.numberOfBooks=
C+1;for(var G=0,J=g.numberOfBooks;G<J;){var K=G++,P=g.bookList;if(0>a.validBits)var L=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}if(0>a.validBits)L=0;else{var S=a.acc&255;a.acc>>>=8;a.validBits-=8;L=S}}else{var U=a.acc&255;a.acc>>>=8;a.validBits-=8;L=U}P[K]=L}throw new r(new H(q.FEATURE_NOT_SUPPORTED,
null,{fileName:"Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));}var R=[],N=c.floor1=new vc,Q=-1;if(0>a.validBits)var T=0;else if(5>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(5>a.validBits))break}if(0>a.validBits)T=0;else{var aa=a.acc&31;a.acc>>>=5;a.validBits-=5;T=aa}}else{var ba=a.acc&31;a.acc>>>=
5;a.validBits-=5;T=ba}N.partitions=T;N.partitionClassList=Array(N.partitions);for(var W=0,ca=N.partitions;W<ca;){var X=W++,da=N.partitionClassList;if(0>a.validBits)var V=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}if(0>a.validBits)V=0;else{var fa=a.acc&15;a.acc>>>=4;a.validBits-=4;V=fa}}else{var ha=a.acc&
15;a.acc>>>=4;a.validBits-=4;V=ha}da[X]=V;N.partitionClassList[X]>Q&&(Q=N.partitionClassList[X])}N.classDimensions=Array(Q+1);N.classMasterbooks=Array(Q+1);N.classSubclasses=Array(Q+1);N.subclassBooks=Array(Q+1);for(var ea=0,ia=Q+1;ea<ia;){var Y=ea++,na=N.classDimensions;if(0>a.validBits)var ra=0;else if(3>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=
-1;break}if(!(3>a.validBits))break}if(0>a.validBits)ra=0;else{var oa=a.acc&7;a.acc>>>=3;a.validBits-=3;ra=oa}}else{var pa=a.acc&7;a.acc>>>=3;a.validBits-=3;ra=pa}na[Y]=ra+1;var qa=N.classSubclasses;if(0>a.validBits)var ka=0;else if(2>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(2>a.validBits))break}if(0>a.validBits)ka=0;else{var ta=a.acc&
3;a.acc>>>=2;a.validBits-=2;ka=ta}}else{var ua=a.acc&3;a.acc>>>=2;a.validBits-=2;ka=ua}qa[Y]=ka;if(0!=N.classSubclasses[Y]){var wa=N.classMasterbooks;if(0>a.validBits)var la=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}if(0>a.validBits)la=0;else{var za=a.acc&255;a.acc>>>=8;a.validBits-=8;la=za}}else{var Aa=
a.acc&255;a.acc>>>=8;a.validBits-=8;la=Aa}wa[Y]=la;if(N.classMasterbooks[Y]>=b.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));}var ya=1<<N.classSubclasses[Y];N.subclassBooks[Y]=Array(ya);for(var Ca=0,Ga=ya;Ca<Ga;){var Ea=Ca++,Ia=N.subclassBooks[Y];if(0>a.validBits)var Ba=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=
1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}if(0>a.validBits)Ba=0;else{var Ja=a.acc&255;a.acc>>>=8;a.validBits-=8;Ba=Ja}}else{var Ra=a.acc&255;a.acc>>>=8;a.validBits-=8;Ba=Ra}Ia[Ea]=Ba-1;if(N.subclassBooks[Y][Ea]>=b.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));}}if(0>a.validBits)var Ha=0;else if(2>a.validBits){0==a.validBits&&(a.acc=
0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(2>a.validBits))break}if(0>a.validBits)Ha=0;else{var Ta=a.acc&3;a.acc>>>=2;a.validBits-=2;Ha=Ta}}else{var Xa=a.acc&3;a.acc>>>=2;a.validBits-=2;Ha=Xa}N.floor1Multiplier=Ha+1;if(0>a.validBits)var sa=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=
1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}if(0>a.validBits)sa=0;else{var Sa=a.acc&15;a.acc>>>=4;a.validBits-=4;sa=Sa}}else{var Da=a.acc&15;a.acc>>>=4;a.validBits-=4;sa=Da}N.rangebits=sa;N.xlist=Array(250);N.xlist[0]=0;N.xlist[1]=1<<N.rangebits;N.values=2;for(var Qa=0,Ya=N.partitions;Qa<Ya;)for(var Za=Qa++,Ua=0,bb=N.classDimensions[N.partitionClassList[Za]];Ua<bb;){Ua++;var cb=N.xlist,db=N.values,xa=N.rangebits;if(0>a.validBits)var Ka=
0;else if(a.validBits<xa)if(24<xa)Ka=a.readBits(24)+(a.readBits(xa-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<xa))break}if(0>a.validBits)Ka=0;else{var fb=a.acc&(1<<xa)-1;a.acc>>>=xa;a.validBits-=xa;Ka=fb}}else{var gb=a.acc&(1<<xa)-1;a.acc>>>=xa;a.validBits-=xa;Ka=gb}cb[db]=Ka;N.values++}for(var eb=0,jb=N.values;eb<jb;){var Wa=
eb++;R.push(new wc);R[Wa].x=N.xlist[Wa];R[Wa].y=Wa}R.sort(I.pointCompare);N.sortedOrder=Array(N.values);for(var hb=0,lb=N.values;hb<lb;){var ib=hb++;N.sortedOrder[ib]=R[ib].y}N.neighbors=Array(N.values);for(var kb=2,tb=N.values;kb<tb;){for(var Va=kb++,ma,Fa,ja=N.xlist,pb=-1,va=65536,sb=0,qb=0,rb=0,wb=Va;rb<wb;){var xb=rb++;ja[xb]>pb&&ja[xb]<ja[Va]&&(sb=xb,pb=ja[xb]);ja[xb]<va&&ja[xb]>ja[Va]&&(qb=xb,va=ja[xb])}ma=sb;Fa=qb;N.neighbors[Va]=Array(N.values);N.neighbors[Va][0]=ma;N.neighbors[Va][1]=Fa}return c};
cd.prototype={floor0:null,floor1:null,type:null,__class__:cd};var Cd=function(){};m["kha.audio2.ogg.vorbis.data.Floor0"]=Cd;Cd.__name__=!0;Cd.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Cd};var vc=function(){};m["kha.audio2.ogg.vorbis.data.Floor1"]=vc;vc.__name__=!0;vc.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,
sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:vc};var ad=function(){};m["kha.audio2.ogg.vorbis.data.Header"]=ad;ad.__name__=!0;ad.read=function(a){var b=a.page;b.start(a);if(0==(b.flag&2))throw new r(new H(q.INVALID_FIRST_PAGE,"not firstPage",{fileName:"Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(b.flag&4))throw new r(new H(q.INVALID_FIRST_PAGE,"lastPage",{fileName:"Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",
methodName:"read"}));if(0!=(b.flag&1))throw new r(new H(q.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));a.firstPageValidate();a.inputPosition+=1;if(1!=a.input.readByte())throw new r(new H(q.INVALID_FIRST_PAGE,"decodeState head",{fileName:"Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));b=new ha(new pa(6));for(var c=0;6>c;){var d=c++;if(0!=a.bytesInSeg||!a.lastSeg&&
0!=a.next()){a.bytesInSeg--;a.inputPosition+=1;var f=a.input.readByte()}else f=-1;a.validBits=0;b.b[d]=f&255}if("vorbis"!=b.toString())throw new r(new H(q.INVALID_SETUP,"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));a.inputPosition+=4;b=a.input.readInt32();if(0!=b)throw new r(new H(q.INVALID_FIRST_PAGE,"vorbis version : "+b,{fileName:"Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",
methodName:"read"}));b=new ad;a.inputPosition+=1;b.channel=a.input.readByte();if(0==b.channel)throw new r(new H(q.INVALID_FIRST_PAGE,"no channel",{fileName:"Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<b.channel)throw new r(new H(q.TOO_MANY_CHANNELS,"too many channels",{fileName:"Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));a.inputPosition+=4;b.sampleRate=a.input.readInt32();if(0==b.sampleRate)throw new r(new H(q.INVALID_FIRST_PAGE,
"no sampling rate",{fileName:"Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));a.inputPosition+=4;b.maximumBitRate=a.input.readInt32();a.inputPosition+=4;b.nominalBitRate=a.input.readInt32();a.inputPosition+=4;b.minimumBitRate=a.input.readInt32();a.inputPosition+=1;d=a.input.readByte();c=d&15;d>>=4;b.blocksize0=1<<c;b.blocksize1=1<<d;if(6>c||13<c)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",
methodName:"read"}));if(6>d||13<d)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(c>d)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));a.inputPosition+=1;if(0==(a.input.readByte()&1))throw new r(new H(q.INVALID_FIRST_PAGE,null,{fileName:"Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));
a.page.start(a);a.startPacket();for(d=new Pc;;){c=a.next();if(0==c)break;a.inputPosition+=c;d.write(a.input.read(c));a.bytesInSeg=0}c=new Zb(d.getBytes());c.readByte();c.read(6);d=c.readInt32();b.vendor=c.readString(d);b.comment=new fe;d=0;for(f=c.readInt32();d<f;){d++;var e=c.readInt32();e=c.readString(e);var g=e.indexOf("=");-1!=g&&b.comment.add(e.substring(0,g),e.substring(g+1))}if(0==(c.readByte()&1))throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",
methodName:"read"}));a.startPacket();0!=a.bytesInSeg||!a.lastSeg&&0!=a.next()?(a.bytesInSeg--,a.inputPosition+=1,c=a.input.readByte()):c=-1;a.validBits=0;if(5!=c)throw new r(new H(q.INVALID_SETUP,"setup packet",{fileName:"Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));c=new ha(new pa(6));for(d=0;6>d;)f=d++,0!=a.bytesInSeg||!a.lastSeg&&0!=a.next()?(a.bytesInSeg--,a.inputPosition+=1,e=a.input.readByte()):e=-1,a.validBits=0,c.b[f]=e&255;if("vorbis"!=c.toString())throw new r(new H(q.INVALID_SETUP,
"vorbis header",{fileName:"VorbisDecodeState.hx",lineNumber:300,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));if(0>a.validBits)c=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?c=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8)}else c=a.acc&255,a.acc>>>=8,a.validBits-=
8;c+=1;b.codebooks=Array(c);for(d=0;d<c;)f=d++,b.codebooks[f]=bd.read(a);if(0>a.validBits)d=0;else if(6>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?d=0:(c=a.acc&63,a.acc>>>=6,a.validBits-=6,d=c)}else c=a.acc&63,a.acc>>>=6,a.validBits-=6,d=c;c=0;for(d+=1;c<d;){c++;if(0>a.validBits)f=0;else if(16>a.validBits){0==
a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}0>a.validBits?f=0:(f=a.acc&65535,a.acc>>>=16,a.validBits-=16)}else f=a.acc&65535,a.acc>>>=16,a.validBits-=16;if(0!=f)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));}if(0>a.validBits)c=0;else if(6>
a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?c=0:(c=a.acc&63,a.acc>>>=6,a.validBits-=6)}else c=a.acc&63,a.acc>>>=6,a.validBits-=6;c+=1;b.floorConfig=Array(c);for(d=0;d<c;)f=d++,b.floorConfig[f]=cd.read(a,b.codebooks);if(0>a.validBits)c=0;else if(6>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=
a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?c=0:(c=a.acc&63,a.acc>>>=6,a.validBits-=6)}else c=a.acc&63,a.acc>>>=6,a.validBits-=6;c+=1;b.residueConfig=Array(c);for(d=0;d<c;)f=d++,b.residueConfig[f]=dd.read(a,b.codebooks);if(0>a.validBits)c=0;else if(6>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,
a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?c=0:(c=a.acc&63,a.acc>>>=6,a.validBits-=6)}else c=a.acc&63,a.acc>>>=6,a.validBits-=6;c+=1;b.mapping=Array(c);for(d=0;d<c;)for(e=d++,f=ed.read(a,b.channel),b.mapping[e]=f,e=0,g=f.submaps;e<g;){var l=e++;if(f.submapFloor[l]>=b.floorConfig.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",
methodName:"read"}));if(f.submapResidue[l]>=b.residueConfig.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));}if(0>a.validBits)c=0;else if(6>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?c=0:(c=a.acc&63,
a.acc>>>=6,a.validBits-=6)}else c=a.acc&63,a.acc>>>=6,a.validBits-=6;c+=1;b.modes=Array(c);for(d=0;d<c;)if(f=d++,e=fd.read(a),b.modes[f]=e,e.mapping>=b.mapping.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));for(;0!=a.bytesInSeg||!a.lastSeg&&0!=a.next();)a.bytesInSeg--,a.inputPosition+=1,a.input.readByte();return b};ad.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,
channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:ad};var wc=function(){};m["kha.audio2.ogg.vorbis.data.IntPoint"]=wc;wc.__name__=!0;wc.prototype={x:null,y:null,__class__:wc};var ed=function(){};m["kha.audio2.ogg.vorbis.data.Mapping"]=ed;ed.__name__=!0;ed.read=function(a,b){var c=new ed;if(0>a.validBits)var d=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&
0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}0>a.validBits?d=0:(d=a.acc&65535,a.acc>>>=16,a.validBits-=16)}else d=a.acc&65535,a.acc>>>=16,a.validBits-=16;if(0!=d)throw new r(new H(q.INVALID_SETUP,"mapping type "+d,{fileName:"Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));c.chan=Array(b);for(d=0;d<b;){var f=d++;c.chan[f]=new xc}if(0>a.validBits)d=
0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>a.validBits?d=0:(d=a.acc&1,a.acc>>>=1,--a.validBits)}else d=a.acc&1,a.acc>>>=1,--a.validBits;if(0!=d){if(0>a.validBits)d=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=
1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}0>a.validBits?d=0:(d=a.acc&15,a.acc>>>=4,a.validBits-=4)}else d=a.acc&15,a.acc>>>=4,a.validBits-=4;c.submaps=d+1}else c.submaps=1;if(0>a.validBits)d=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>
a.validBits?d=0:(d=a.acc&1,a.acc>>>=1,--a.validBits)}else d=a.acc&1,a.acc>>>=1,--a.validBits;if(0!=d){if(0>a.validBits)d=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?d=0:(d=a.acc&255,a.acc>>>=8,a.validBits-=8)}else d=a.acc&255,a.acc>>>=8,a.validBits-=8;c.couplingSteps=d+1;d=0;for(f=c.couplingSteps;d<
f;){var e=d++,g=c.chan[e],l=b-1,k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];l=16384>l?16>l?k[l]:512>l?5+k[l>>5]:10+k[l>>10]:16777216>l?524288>l?15+k[l>>15]:20+k[l>>20]:536870912>l?25+k[l>>25]:-2147483648>l?30+k[l>>30]:0;if(0>a.validBits)l=0;else if(a.validBits<l)if(24<l)l=a.readBits(24)+(a.readBits(l-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<
l))break}0>a.validBits?l=0:(k=a.acc&(1<<l)-1,a.acc>>>=l,a.validBits-=l,l=k)}else k=a.acc&(1<<l)-1,a.acc>>>=l,a.validBits-=l,l=k;g.magnitude=l;g=c.chan[e];l=b-1;k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];l=16384>l?16>l?k[l]:512>l?5+k[l>>5]:10+k[l>>10]:16777216>l?524288>l?15+k[l>>15]:20+k[l>>20]:536870912>l?25+k[l>>25]:-2147483648>l?30+k[l>>30]:0;if(0>a.validBits)l=0;else if(a.validBits<l)if(24<l)l=a.readBits(24)+(a.readBits(l-24)<<24);else{0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&
0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(a.validBits<l))break}0>a.validBits?l=0:(k=a.acc&(1<<l)-1,a.acc>>>=l,a.validBits-=l,l=k)}else k=a.acc&(1<<l)-1,a.acc>>>=l,a.validBits-=l,l=k;g.angle=l;if(c.chan[e].magnitude>=b)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(c.chan[e].angle>=b)throw new r(new H(q.INVALID_SETUP,
null,{fileName:"Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(c.chan[e].magnitude==c.chan[e].angle)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));}}else c.couplingSteps=0;if(0>a.validBits)d=0;else if(2>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<
a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(2>a.validBits))break}0>a.validBits?d=0:(d=a.acc&3,a.acc>>>=2,a.validBits-=2)}else d=a.acc&3,a.acc>>>=2,a.validBits-=2;if(0!=d)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<c.submaps)for(d=0;d<b;){f=d++;e=c.chan[f];if(0>a.validBits)g=0;else if(4>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,
a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(4>a.validBits))break}0>a.validBits?g=0:(g=a.acc&15,a.acc>>>=4,a.validBits-=4)}else g=a.acc&15,a.acc>>>=4,a.validBits-=4;e.mux=g;if(c.chan[f].mux>=c.submaps)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));}else for(d=0;d<b;)f=d++,c.chan[f].mux=0;c.submapFloor=Array(c.submaps);c.submapResidue=Array(c.submaps);
d=0;for(f=c.submaps;d<f;){e=d++;if(0<=a.validBits)if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0<=a.validBits&&(a.acc>>>=8,a.validBits-=8)}else a.acc>>>=8,a.validBits-=8;g=c.submapFloor;if(0>a.validBits)l=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,
a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?l=0:(l=a.acc&255,a.acc>>>=8,a.validBits-=8)}else l=a.acc&255,a.acc>>>=8,a.validBits-=8;g[e]=l;g=c.submapResidue;if(0>a.validBits)l=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>
a.validBits?l=0:(l=a.acc&255,a.acc>>>=8,a.validBits-=8)}else l=a.acc&255,a.acc>>>=8,a.validBits-=8;g[e]=l}return c};ed.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(a,b,c,d,f,e){c>>=1;a=a[this.submapFloor[this.chan[b].mux]];if(0==a.type)throw new r(new H(q.INVALID_STREAM,null,{fileName:"Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));b=a.floor1;e=0;a=f[0]*b.floor1Multiplier;for(var h=1,l=b.values;h<
l;){var k=h++,y=b.sortedOrder[k];0<=f[y]&&(k=f[y]*b.floor1Multiplier,y=b.xlist[y],I.drawLine(d,e,a,y,k,c),e=y,a=k)}if(e<c)for(f=e;f<c;)b=f++,e=d,e[b]*=I.INVERSE_DB_TABLE[a]},__class__:ed};var xc=function(){};m["kha.audio2.ogg.vorbis.data.MappingChannel"]=xc;xc.__name__=!0;xc.prototype={magnitude:null,angle:null,mux:null,__class__:xc};var fd=function(){};m["kha.audio2.ogg.vorbis.data.Mode"]=fd;fd.__name__=!0;fd.read=function(a){var b=new fd;if(0>a.validBits)var c=0;else if(1>a.validBits){0==a.validBits&&
(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>a.validBits?c=0:(c=a.acc&1,a.acc>>>=1,--a.validBits)}else c=a.acc&1,a.acc>>>=1,--a.validBits;b.blockflag=0!=c;if(0>a.validBits)c=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,
a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}0>a.validBits?c=0:(c=a.acc&65535,a.acc>>>=16,a.validBits-=16)}else c=a.acc&65535,a.acc>>>=16,a.validBits-=16;b.windowtype=c;if(0>a.validBits)c=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}0>a.validBits?c=0:(c=a.acc&65535,a.acc>>>=16,
a.validBits-=16)}else c=a.acc&65535,a.acc>>>=16,a.validBits-=16;b.transformtype=c;if(0>a.validBits)a=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?a=0:(c=a.acc&255,a.acc>>>=8,a.validBits-=8,a=c)}else c=a.acc&255,a.acc>>>=8,a.validBits-=8,a=c;b.mapping=a;if(0!=b.windowtype)throw new r(new H(q.INVALID_SETUP,
null,{fileName:"Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=b.transformtype)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return b};fd.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:fd};var xd=function(){};m["kha.audio2.ogg.vorbis.data.Page"]=xd;xd.__name__=!0;xd.prototype={flag:null,clone:function(){var a=new xd;a.flag=
this.flag;return a},start:function(a){a.inputPosition+=1;if(79==a.input.readByte()){a.inputPosition+=1;var b=103!=a.input.readByte()}else b=!0;b?b=!0:(a.inputPosition+=1,b=103!=a.input.readByte());b?b=!0:(a.inputPosition+=1,b=83!=a.input.readByte());if(b)throw new r(new H(q.MISSING_CAPTURE_PATTERN,null,{fileName:"VorbisDecodeState.hx",lineNumber:323,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(a)},startWithoutCapturePattern:function(a){a.inputPosition+=
1;var b=a.input.readByte();if(0!=b)throw new r(new H(q.INVALID_STREAM_STRUCTURE_VERSION,""+b,{fileName:"Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));a.inputPosition+=1;this.flag=a.input.readByte();a.inputPosition+=4;b=a.input.readInt32();a.inputPosition+=4;var c=a.input.readInt32();a.inputPosition+=4;a.input.readInt32();a.inputPosition+=4;a.input.readInt32();a.inputPosition+=4;a.input.readInt32();a.setup(b,c)},__class__:xd};var yd=function(){};
m["kha.audio2.ogg.vorbis.data.ProbedPage"]=yd;yd.__name__=!0;yd.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:yd};var H=function(a,b,c){null==b&&(b="");this.type=a;this.message=b;this.posInfos=c};m["kha.audio2.ogg.vorbis.data.ReaderError"]=H;H.__name__=!0;H.prototype={type:null,message:null,posInfos:null,__class__:H};var q=m["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:"NEED_MORE_DATA INVALID_API_MIXING OUTOFMEM FEATURE_NOT_SUPPORTED TOO_MANY_CHANNELS FILE_OPEN_FAILURE SEEK_WITHOUT_LENGTH UNEXPECTED_EOF SEEK_INVALID INVALID_SETUP INVALID_STREAM MISSING_CAPTURE_PATTERN INVALID_STREAM_STRUCTURE_VERSION CONTINUED_PACKET_FLAG_INVALID INCORRECT_STREAM_SERIAL_NUMBER INVALID_FIRST_PAGE BAD_PACKET_TYPE CANT_FIND_LAST_PAGE SEEK_FAILED OTHER".split(" ")};
q.NEED_MORE_DATA=["NEED_MORE_DATA",0];q.NEED_MORE_DATA.toString=w;q.NEED_MORE_DATA.__enum__=q;q.INVALID_API_MIXING=["INVALID_API_MIXING",1];q.INVALID_API_MIXING.toString=w;q.INVALID_API_MIXING.__enum__=q;q.OUTOFMEM=["OUTOFMEM",2];q.OUTOFMEM.toString=w;q.OUTOFMEM.__enum__=q;q.FEATURE_NOT_SUPPORTED=["FEATURE_NOT_SUPPORTED",3];q.FEATURE_NOT_SUPPORTED.toString=w;q.FEATURE_NOT_SUPPORTED.__enum__=q;q.TOO_MANY_CHANNELS=["TOO_MANY_CHANNELS",4];q.TOO_MANY_CHANNELS.toString=w;q.TOO_MANY_CHANNELS.__enum__=q;
q.FILE_OPEN_FAILURE=["FILE_OPEN_FAILURE",5];q.FILE_OPEN_FAILURE.toString=w;q.FILE_OPEN_FAILURE.__enum__=q;q.SEEK_WITHOUT_LENGTH=["SEEK_WITHOUT_LENGTH",6];q.SEEK_WITHOUT_LENGTH.toString=w;q.SEEK_WITHOUT_LENGTH.__enum__=q;q.UNEXPECTED_EOF=["UNEXPECTED_EOF",7];q.UNEXPECTED_EOF.toString=w;q.UNEXPECTED_EOF.__enum__=q;q.SEEK_INVALID=["SEEK_INVALID",8];q.SEEK_INVALID.toString=w;q.SEEK_INVALID.__enum__=q;q.INVALID_SETUP=["INVALID_SETUP",9];q.INVALID_SETUP.toString=w;q.INVALID_SETUP.__enum__=q;q.INVALID_STREAM=
["INVALID_STREAM",10];q.INVALID_STREAM.toString=w;q.INVALID_STREAM.__enum__=q;q.MISSING_CAPTURE_PATTERN=["MISSING_CAPTURE_PATTERN",11];q.MISSING_CAPTURE_PATTERN.toString=w;q.MISSING_CAPTURE_PATTERN.__enum__=q;q.INVALID_STREAM_STRUCTURE_VERSION=["INVALID_STREAM_STRUCTURE_VERSION",12];q.INVALID_STREAM_STRUCTURE_VERSION.toString=w;q.INVALID_STREAM_STRUCTURE_VERSION.__enum__=q;q.CONTINUED_PACKET_FLAG_INVALID=["CONTINUED_PACKET_FLAG_INVALID",13];q.CONTINUED_PACKET_FLAG_INVALID.toString=w;q.CONTINUED_PACKET_FLAG_INVALID.__enum__=
q;q.INCORRECT_STREAM_SERIAL_NUMBER=["INCORRECT_STREAM_SERIAL_NUMBER",14];q.INCORRECT_STREAM_SERIAL_NUMBER.toString=w;q.INCORRECT_STREAM_SERIAL_NUMBER.__enum__=q;q.INVALID_FIRST_PAGE=["INVALID_FIRST_PAGE",15];q.INVALID_FIRST_PAGE.toString=w;q.INVALID_FIRST_PAGE.__enum__=q;q.BAD_PACKET_TYPE=["BAD_PACKET_TYPE",16];q.BAD_PACKET_TYPE.toString=w;q.BAD_PACKET_TYPE.__enum__=q;q.CANT_FIND_LAST_PAGE=["CANT_FIND_LAST_PAGE",17];q.CANT_FIND_LAST_PAGE.toString=w;q.CANT_FIND_LAST_PAGE.__enum__=q;q.SEEK_FAILED=["SEEK_FAILED",
18];q.SEEK_FAILED.toString=w;q.SEEK_FAILED.__enum__=q;q.OTHER=["OTHER",19];q.OTHER.toString=w;q.OTHER.__enum__=q;var dd=function(){};m["kha.audio2.ogg.vorbis.data.Residue"]=dd;dd.__name__=!0;dd.read=function(a,b){var c=new dd;if(0>a.validBits)var d=0;else if(16>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(16>a.validBits))break}0>a.validBits?
d=0:(d=a.acc&65535,a.acc>>>=16,a.validBits-=16)}else d=a.acc&65535,a.acc>>>=16,a.validBits-=16;c.type=d;if(2<c.type)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));d=Array(64);if(0>a.validBits)var f=0;else if(24>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=
-1;break}if(!(24>a.validBits))break}0>a.validBits?f=0:(f=a.acc&16777215,a.acc>>>=24,a.validBits-=24)}else f=a.acc&16777215,a.acc>>>=24,a.validBits-=24;c.begin=f;if(0>a.validBits)f=0;else if(24>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(24>a.validBits))break}0>a.validBits?f=0:(f=a.acc&16777215,a.acc>>>=24,a.validBits-=24)}else f=a.acc&
16777215,a.acc>>>=24,a.validBits-=24;c.end=f;if(0>a.validBits)f=0;else if(24>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(24>a.validBits))break}0>a.validBits?f=0:(f=a.acc&16777215,a.acc>>>=24,a.validBits-=24)}else f=a.acc&16777215,a.acc>>>=24,a.validBits-=24;c.partSize=f+1;if(0>a.validBits)f=0;else if(6>a.validBits){0==a.validBits&&(a.acc=
0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(6>a.validBits))break}0>a.validBits?f=0:(f=a.acc&63,a.acc>>>=6,a.validBits-=6)}else f=a.acc&63,a.acc>>>=6,a.validBits-=6;f=c.classifications=f+1;if(0>a.validBits)var e=0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<
a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?e=0:(e=a.acc&255,a.acc>>>=8,a.validBits-=8)}else e=a.acc&255,a.acc>>>=8,a.validBits-=8;c.classbook=e;e=0;for(var g=c.classifications;e<g;){var l=e++,k=0;if(0>a.validBits)var y=0;else if(3>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(3>a.validBits))break}0>
a.validBits?y=0:(y=a.acc&7,a.acc>>>=3,a.validBits-=3)}else y=a.acc&7,a.acc>>>=3,a.validBits-=3;if(0>a.validBits)var m=0;else if(1>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(1>a.validBits))break}0>a.validBits?m=0:(m=a.acc&1,a.acc>>>=1,--a.validBits)}else m=a.acc&1,a.acc>>>=1,--a.validBits;if(0!=m)if(0>a.validBits)k=0;else if(5>a.validBits){0==
a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(5>a.validBits))break}0>a.validBits?k=0:(k=a.acc&31,a.acc>>>=5,a.validBits-=5)}else k=a.acc&31,a.acc>>>=5,a.validBits-=5;d[l]=8*k+y}c.residueBooks=Array(c.classifications);e=0;for(g=c.classifications;e<g;)for(l=e++,c.residueBooks[l]=Array(8),k=0;8>k;)if(y=k++,0!=(d[l]&1<<y)){m=c.residueBooks[l];if(0>a.validBits)var p=
0;else if(8>a.validBits){0==a.validBits&&(a.acc=0);for(;;){if(0!=a.bytesInSeg||!a.lastSeg&&0!=a.next())a.bytesInSeg--,a.inputPosition+=1,a.acc+=a.input.readByte()<<a.validBits,a.validBits+=8;else{a.validBits=-1;break}if(!(8>a.validBits))break}0>a.validBits?p=0:(p=a.acc&255,a.acc>>>=8,a.validBits-=8)}else p=a.acc&255,a.acc>>>=8,a.validBits-=8;m[y]=p;if(c.residueBooks[l][y]>=b.length)throw new r(new H(q.INVALID_SETUP,null,{fileName:"Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",
methodName:"read"}));}else c.residueBooks[l][y]=-1;d=b[c.classbook].entries;e=b[c.classbook].dimensions;c.classdata=Array(d);for(g=0;g<d;)for(l=y=g++,k=e,y=c.classdata[y]=Array(e);0<=--k;)y[k]=l%f,l=l/f|0;return c};dd.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(a,b,c,d,f,e,g){g=b.codebooks;var h=g[this.classbook].dimensions,k=this.partSize,y=S.toFloat(this.end-this.begin)/S.toFloat(k)|0;b=Array(b.channel*
y+1);for(var m=0;m<d;){var p=m++;if(!e[p]){p=c[p];for(var D=0,B=p.length;D<B;){var v=D++;p[v]=0}}}if(2==this.type&&1!=d){for(m=0;m<d&&(p=m++,e[p]);)if(p==d-1)return;for(e=0;8>e;)if(m=e++,p=0,2==d)for(;p<y;){B=this.begin+p*k;D=B&1;B>>>=1;if(0==m){v=g[this.classbook];10>a.validBits&&a.prepHuffman();var u=v.fastHuffman[a.acc&1023];if(0<=u){var n=v.codewordLengths[u];a.acc>>>=n;a.validBits-=n;0>a.validBits&&(a.validBits=0,u=-1)}else u=a.decodeScalarRaw(v);v.sparse&&(u=v.sortedValues[u]);v=u;if(-1==v)return;
for(u=h;0<=--u;)b[u+p]=v%this.classifications,v=v/this.classifications|0}v=0;for(u=h;v<u;){v++;if(p>=y)break;n=this.begin+p*k;var r=this.residueBooks[b[p]][m];if(0<=r){B=g[r].decodeDeinterleaveRepeat(a,c,d,D,B,f,k);if(null==B)return;D=B.cInter;B=B.pInter}else n+=k,D=n&1,B=n>>>1;++p}}else if(1==d)for(;p<y;){D=0;B=this.begin+p*k;if(0==m){v=g[this.classbook];10>a.validBits&&a.prepHuffman();u=v.fastHuffman[a.acc&1023];0<=u?(n=v.codewordLengths[u],a.acc>>>=n,a.validBits-=n,0>a.validBits&&(a.validBits=
0,u=-1)):u=a.decodeScalarRaw(v);v.sparse&&(u=v.sortedValues[u]);v=u;if(-1==v)return;for(u=h;0<=--u;)b[u+p]=v%this.classifications,v=v/this.classifications|0}v=0;for(u=h;v<u;){v++;if(p>=y)break;n=this.begin+p*k;r=this.residueBooks[b[p]][m];if(0<=r){B=g[r].decodeDeinterleaveRepeat(a,c,d,D,B,f,k);if(null==B)return;D=B.cInter;B=B.pInter}else n+=k,D=0,B=n;++p}}else for(;p<y;){B=this.begin+p*k;D=S.toFloat(B)%S.toFloat(d)|0;B=S.toFloat(B)/S.toFloat(d)|0;if(0==m){v=g[this.classbook];10>a.validBits&&a.prepHuffman();
u=v.fastHuffman[a.acc&1023];0<=u?(n=v.codewordLengths[u],a.acc>>>=n,a.validBits-=n,0>a.validBits&&(a.validBits=0,u=-1)):u=a.decodeScalarRaw(v);v.sparse&&(u=v.sortedValues[u]);v=u;if(-1==v)return;for(u=h;0<=--u;)b[u+p]=v%this.classifications,v=v/this.classifications|0}v=0;for(u=h;v<u;){v++;if(p>=y)break;n=this.begin+p*k;r=this.residueBooks[b[p]][m];if(0<=r){B=g[r].decodeDeinterleaveRepeat(a,c,d,D,B,f,k);if(null==B)return;D=B.cInter;B=B.pInter}else n+=k,D=S.toFloat(n)%S.toFloat(d)|0,B=S.toFloat(n)/
S.toFloat(d)|0;++p}}}else for(f=0;8>f;)for(m=f++,p=0;p<y;){if(0==m)for(D=0,B=d;D<B;)if(v=D++,!e[v]){u=g[this.classbook];10>a.validBits&&a.prepHuffman();n=u.fastHuffman[a.acc&1023];0<=n?(r=u.codewordLengths[n],a.acc>>>=r,a.validBits-=r,0>a.validBits&&(a.validBits=0,n=-1)):n=a.decodeScalarRaw(u);u.sparse&&(n=u.sortedValues[n]);u=n;if(-1==u)return;for(n=h;0<=--n;)b[v*y+n+p]=u%this.classifications,u=u/this.classifications|0}D=0;for(B=h;D<B;){D++;if(p>=y)break;v=0;for(u=d;v<u;)if(n=v++,!e[n]&&(r=this.residueBooks[b[n*
y+p]][m],0<=r&&!g[r].residueDecode(a,c[n],this.begin+p*k,k,this.type)))return;++p}}},__class__:dd};var te=function(){};m["kha.graphics1.Graphics"]=te;te.__name__=!0;var ib=function(){this.transformations=[];this.transformations.push(new yc(1,0,0,0,1,0,0,0,1));this.opacities=[];this.opacities.push(1);this.myFontSize=12;this.myFontGlyphs=[];for(var a=32;256>a;){var b=a++;this.myFontGlyphs.push(b)}this.pipe=null};m["kha.graphics2.Graphics"]=ib;ib.__name__=!0;ib.prototype={begin:function(a,b){},end:function(){},
drawRect:function(a,b,c,d,f){},fillRect:function(a,b,c,d){},drawString:function(a,b,c){},drawLine:function(a,b,c,d,f){},set_color:function(a){return-16777216},set_font:function(a){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(a){return this.myFontSize=a},get_fontGlyphs:function(){return this.myFontGlyphs},get_opacity:function(){return this.opacities[this.opacities.length-1]},scissor:function(a,b,c,d){},pipe:null,transformations:null,opacities:null,myFontSize:null,
myFontGlyphs:null,__class__:ib};var td=function(a){this.canvas=a};m["kha.graphics2.Graphics1"]=td;td.__name__=!0;td.__interfaces__=[te];td.prototype={canvas:null,__class__:td};var zc=m["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"]};zc.Low=["Low",0];zc.Low.toString=w;zc.Low.__enum__=zc;zc.High=["High",1];zc.High.toString=w;zc.High.__enum__=zc;var Ac=function(){};m["kha.graphics2.truetype.VectorOfIntPointer"]=Ac;Ac.__name__=!0;Ac.prototype={value:null,__class__:Ac};
var Bc=function(){};m["kha.graphics2.truetype.Stbtt_temp_rect"]=Bc;Bc.__name__=!0;Bc.prototype={x0:null,y0:null,x1:null,y1:null,__class__:Bc};var Cc=function(){};m["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Cc;Cc.__name__=!0;Cc.prototype={advanceWidth:null,leftSideBearing:null,__class__:Cc};var Dc=function(){};m["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Dc;Dc.__name__=!0;Dc.prototype={ascent:null,descent:null,lineGap:null,__class__:Dc};var Td=function(){};m["kha.graphics2.truetype.Stbtt_bakedchar"]=
Td;Td.__name__=!0;Td.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Td};var Wc=function(){};m["kha.graphics2.truetype.Stbtt_fontinfo"]=Wc;Wc.__name__=!0;Wc.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:Wc};var Ec=function(){};m["kha.graphics2.truetype.Stbtt_vertex"]=Ec;Ec.__name__=!0;Ec.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:Ec};
var Fc=function(){};m["kha.graphics2.truetype.Stbtt__bitmap"]=Fc;Fc.__name__=!0;Fc.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:Fc};var Gc=function(){};m["kha.graphics2.truetype.Stbtt__edge"]=Gc;Gc.__name__=!0;Gc.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:Gc};var Hc=function(){};m["kha.graphics2.truetype.Stbtt__active_edge"]=Hc;Hc.__name__=!0;Hc.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Hc};var Ic=
function(){};m["kha.graphics2.truetype.Stbtt__point"]=Ic;Ic.__name__=!0;Ic.prototype={x:null,y:null,__class__:Ic};var z=function(){};m["kha.graphics2.truetype.StbTruetype"]=z;z.__name__=!0;z.stbtt__find_table=function(a,b,c){var d=b+4,f=a.readU8(d),e=a.readU8(d+1);b+=12;d=0;for(f=e|f<<8;d<f;){e=d++;e=b+16*e;var g=G.cca(c,0),l=G.cca(c,1),k=G.cca(c,2),m=G.cca(c,3);if(a.readU8(e)==g&&a.readU8(e+1)==l&&a.readU8(e+2)==k&&a.readU8(e+3)==m)return c=e+8,b=a.readU8(c),d=a.readU8(c+1),f=a.readU8(c+2),a.readU8(c+
3)|f<<8|d<<16|b<<24}return 0};z.stbtt_InitFont=function(a,b,c){a.data=b;a.fontstart=c;var d=z.stbtt__find_table(b,c,"cmap");a.loca=z.stbtt__find_table(b,c,"loca");a.head=z.stbtt__find_table(b,c,"head");a.glyf=z.stbtt__find_table(b,c,"glyf");a.hhea=z.stbtt__find_table(b,c,"hhea");a.hmtx=z.stbtt__find_table(b,c,"hmtx");a.kern=z.stbtt__find_table(b,c,"kern");if(0==d||0==a.loca||0==a.head||0==a.glyf||0==a.hhea||0==a.hmtx)return!1;c=z.stbtt__find_table(b,c,"maxp");if(0!=c){var f=c+4;c=b.readU8(f);f=b.readU8(f+
1);a.numGlyphs=f|c<<8}else a.numGlyphs=65535;c=d+2;f=b.readU8(c);var e=b.readU8(c+1);c=a.index_map=0;for(f=e|f<<8;c<f;){e=c++;e=d+4+8*e;var g=b.readU8(e);switch(b.readU8(e+1)|g<<8){case 0:var l=e+4;e=b.readU8(l);g=b.readU8(l+1);var k=b.readU8(l+2);l=b.readU8(l+3);a.index_map=d+(l|k<<8|g<<16|e<<24);break;case 3:switch(g=e+2,k=b.readU8(g),b.readU8(g+1)|k<<8){case 1:case 10:l=e+4,e=b.readU8(l),g=b.readU8(l+1),k=b.readU8(l+2),l=b.readU8(l+3),a.index_map=d+(l|k<<8|g<<16|e<<24)}}}if(0==a.index_map)return!1;
c=a.head+50;d=b.readU8(c);b=b.readU8(c+1);a.indexToLocFormat=b|d<<8;return!0};z.stbtt_FindGlyphIndex=function(a,b){var c=a.data,d=a.index_map,f=c.readU8(d);f=c.readU8(d+1)|f<<8;if(0==f){var e=d+2;f=c.readU8(e);e=c.readU8(e+1);return b<(e|f<<8)-6?c.readU8(d+6+b):0}if(6==f){f=d+6;e=c.readU8(f);f=c.readU8(f+1)|e<<8;var g=d+8;e=c.readU8(g);g=c.readU8(g+1);return b>=f&&b<f+(g|e<<8)?(d=d+10+2*(b-f),f=c.readU8(d),c.readU8(d+1)|f<<8):0}if(2!=f){if(4==f){f=d+6;e=c.readU8(f);f=(c.readU8(f+1)|e<<8)>>1;e=d+8;
g=c.readU8(e);e=(c.readU8(e+1)|g<<8)>>1;g=d+10;var l=c.readU8(g);g=c.readU8(g+1)|l<<8;l=d+12;var k=c.readU8(l),m=(c.readU8(l+1)|k<<8)>>1;k=l=d+14;if(65535<b)return 0;var M=k+2*m,p=c.readU8(M);M=c.readU8(M+1);b>=(M|p<<8)&&(k+=2*m);for(k-=2;0!=g;)e>>=1,p=k+2*e,m=c.readU8(p),p=c.readU8(p+1),b>(p|m<<8)&&(k+=2*e),--g;e=k+2-l>>1;l+=2*e;g=c.readU8(l);l=c.readU8(l+1);if(b>(l|g<<8))throw new r("Error");g=d+14+2*f+2+2*e;l=c.readU8(g);g=c.readU8(g+1)|l<<8;if(b<g)return 0;l=d+14+6*f+2+2*e;k=c.readU8(l);l=c.readU8(l+
1)|k<<8;if(0==l)return d=d+14+4*f+2+2*e,f=c.readU8(d),c=c.readU8(d+1)|f<<8,b+(0!=(c&32768)?c-65536:c);d=l+2*(b-g)+d+14+6*f+2+2*e;f=c.readU8(d);return c.readU8(d+1)|f<<8}if(12==f||13==f){e=d+12;g=c.readU8(e);l=c.readU8(e+1);k=c.readU8(e+2);m=c.readU8(e+3);e=0;for(l=m|k<<8|l<<16|g<<24;e<l;){k=e+(l-e>>1);g=d+16+12*k;m=c.readU8(g);p=c.readU8(g+1);M=c.readU8(g+2);g=c.readU8(g+3)|M<<8|p<<16|m<<24;m=d+16+12*k+4;p=c.readU8(m);M=c.readU8(m+1);var n=c.readU8(m+2);m=c.readU8(m+3)|n<<8|M<<16|p<<24;if(b<g)l=k;
else if(b>m)e=k+1;else return d=d+16+12*k+8,e=c.readU8(d),l=c.readU8(d+1),k=c.readU8(d+2),c=c.readU8(d+3)|k<<8|l<<16|e<<24,12==f?c+b-g:c}return 0}}throw new r("Error");};z.stbtt_setvertex=function(a,b,c,d,f,e){a.type=b;a.x=c;a.y=d;a.cx=f;a.cy=e};z.stbtt__GetGlyfOffset=function(a,b){if(b>=a.numGlyphs||2<=a.indexToLocFormat)return-1;if(0==a.indexToLocFormat){var c=a.glyf;var d=a.data,f=a.loca+2*b;var e=d.readU8(f);d=d.readU8(f+1);c+=2*(d|e<<8);e=a.glyf;f=a.data;var g=a.loca+2*b+2;d=f.readU8(g);f=f.readU8(g+
1);e+=2*(f|d<<8)}else{c=a.glyf;g=a.data;var l=a.loca+4*b;e=g.readU8(l);d=g.readU8(l+1);f=g.readU8(l+2);g=g.readU8(l+3);c+=g|f<<8|d<<16|e<<24;e=a.glyf;l=a.data;var k=a.loca+4*b+4;d=l.readU8(k);f=l.readU8(k+1);g=l.readU8(k+2);l=l.readU8(k+3);e+=l|g<<8|f<<16|d<<24}return c==e?-1:c};z.stbtt_GetGlyphBox=function(a,b,c){b=z.stbtt__GetGlyfOffset(a,b);if(0>b)return!1;var d=a.data,f=b+2,e=d.readU8(f);d=d.readU8(f+1)|e<<8;c.x0=0!=(d&32768)?d-65536:d;d=a.data;f=b+4;e=d.readU8(f);d=d.readU8(f+1)|e<<8;c.y0=0!=
(d&32768)?d-65536:d;d=a.data;f=b+6;e=d.readU8(f);d=d.readU8(f+1)|e<<8;c.x1=0!=(d&32768)?d-65536:d;a=a.data;b+=8;d=a.readU8(b);a=a.readU8(b+1)|d<<8;c.y1=0!=(a&32768)?a-65536:a;return!0};z.stbtt__close_shape=function(a,b,c,d,f,e,g,l,k,m){d?(c&&z.stbtt_setvertex(a[b++],3,k+g>>1,m+l>>1,k,m),z.stbtt_setvertex(a[b++],3,f,e,g,l)):c?z.stbtt_setvertex(a[b++],3,f,e,k,m):z.stbtt_setvertex(a[b++],2,f,e,0,0);return b};z.copyVertices=function(a,b,c,d){for(var f=0;f<d;){var e=f++;b[c+e]=a[e]}};z.stbtt_GetGlyphShape=
function(a,b){var c=a.data,d=null,f=0,e=z.stbtt__GetGlyfOffset(a,b);if(0>e)return null;var g=c.readU8(e);g=c.readU8(e+1)|g<<8;var l=0!=(g&32768)?g-65536:g;if(0<l){var k=0,m,n=0,p=!1,D=!1,B,v,u;f=0;g=c.sub(e+10,c.get_length()-(e+10));d=e+10+2*l;var q=c.readU8(d);d=c.readU8(d+1)|q<<8;q=c.sub(e+10+2*l+2+d,c.get_length()-(e+10+2*l+2+d));d=2*l-2;c=g.readU8(d);c=1+(g.readU8(d+1)|c<<8);l=c+2*l;d=Array(l);if(null==d)return null;e=0;for(m=d.length;e<m;){var t=e++;d[t]=new Ec}m=e=0;l-=c;for(t=0;t<c;){var w=
t++;0==m?(k=q.readU8(f++),0!=(k&8)&&(m=q.readU8(f++))):--m;d[l+w].type=k}for(t=m=0;t<c;){w=t++;k=d[l+w].type;if(0!=(k&2)){var x=q.readU8(f++);m+=0!=(k&16)?x:-x}else 0==(k&16)&&(k=q.readU8(f),k=q.readU8(f+1)|k<<8,m+=0!=(k&32768)?k-65536:k,f+=2);d[l+w].x=m}for(m=t=0;m<c;)w=m++,k=d[l+w].type,0!=(k&4)?(x=q.readU8(f++),t+=0!=(k&32)?x:-x):0==(k&32)&&(k=q.readU8(f),k=q.readU8(f+1)|k<<8,t+=0!=(k&32768)?k-65536:k,f+=2),d[l+w].y=t;for(var A=x=B=q=w=v=u=f=0;A<c;)k=d[l+A].type,m=d[l+A].x,t=d[l+A].y,e==A?(0!=
A&&(f=z.stbtt__close_shape(d,f,p,D,x,B,v,u,q,w)),(D=0==(k&1))?(v=m,u=t,0==(d[l+A+1].type&1)?(x=m+d[l+A+1].x>>1,B=t+d[l+A+1].y>>1):(x=d[l+A+1].x,B=d[l+A+1].y,++A)):(x=m,B=t),z.stbtt_setvertex(d[f++],1,x,B,0,0),p=!1,k=2*n,e=g.readU8(k),e=1+(g.readU8(k+1)|e<<8),++n):0==(k&1)?(p&&z.stbtt_setvertex(d[f++],3,q+m>>1,w+t>>1,q,w),q=m,w=t,p=!0):(p?z.stbtt_setvertex(d[f++],3,m,t,q,w):z.stbtt_setvertex(d[f++],2,m,t,0,0),p=!1),++A;f=z.stbtt__close_shape(d,f,p,D,x,B,v,u,q,w)}else if(-1==l)for(p=1,g=c.sub(e+10,
c.get_length()-(e+10)),f=n=0,d=null;0!=p;){D=1;l=c=0;m=1;p=g.readU8(n);p=g.readU8(n+1)|p<<8;p=0!=(p&32768)?p-65536:p;n+=2;k=g.readU8(n);k=g.readU8(n+1)|k<<8;q=0!=(k&32768)?k-65536:k;n+=2;if(0!=(p&2))0!=(p&1)?(k=g.readU8(n),k=g.readU8(n+1)|k<<8,k=0!=(k&32768)?k-65536:k,n+=2,e=g.readU8(n),e=g.readU8(n+1)|e<<8,e=0!=(e&32768)?e-65536:e,n+=2):(k=g.readU8(n),k=128<=k?k-256:k,++n,e=g.readU8(n),e=128<=e?e-256:e,++n);else throw new r("Error");0!=(p&8)?(D=g.readU8(n),D=g.readU8(n+1)|D<<8,D=m=(0!=(D&32768)?
D-65536:D)/16384,n+=2,c=l=0):0!=(p&64)?(D=g.readU8(n),D=g.readU8(n+1)|D<<8,D=(0!=(D&32768)?D-65536:D)/16384,n+=2,c=l=0,m=g.readU8(n),m=g.readU8(n+1)|m<<8,m=(0!=(m&32768)?m-65536:m)/16384,n+=2):0!=(p&128)&&(D=g.readU8(n),D=g.readU8(n+1)|D<<8,D=(0!=(D&32768)?D-65536:D)/16384,n+=2,c=g.readU8(n),c=g.readU8(n+1)|c<<8,c=(0!=(c&32768)?c-65536:c)/16384,n+=2,l=g.readU8(n),l=g.readU8(n+1)|l<<8,l=(0!=(l&32768)?l-65536:l)/16384,n+=2,m=g.readU8(n),m=g.readU8(n+1)|m<<8,m=(0!=(m&32768)?m-65536:m)/16384,n+=2);w=
Math.sqrt(D*D+c*c);x=Math.sqrt(l*l+m*m);t=z.stbtt_GetGlyphShape(a,q);q=null==t?0:t.length;if(0<q){B=0;for(v=q;B<v;){u=B++;u=t[u];A=u.x;var C=u.y;u.x=w*(D*A+l*C+k)|0;u.y=x*(c*A+m*C+e)|0;A=u.cx;C=u.cy;u.cx=w*(D*A+l*C+k)|0;u.cy=x*(c*A+m*C+e)|0}D=Array(f+q);if(null==D)return null;0<f&&z.copyVertices(d,D,0,f);z.copyVertices(t,D,f,q);d=D;f+=q}p&=32}else if(0>l)throw new r("Error");if(null==d)return null;if(d.length<f)throw new r("Error");return f<d.length?(g=Array(f),z.copyVertices(d,g,0,f),g):d};z.stbtt_GetGlyphHMetrics=
function(a,b){var c=a.data,d=a.hhea+34,f=c.readU8(d);d=c.readU8(d+1)|f<<8;c=new Cc;if(b<d){d=a.data;f=a.hmtx+4*b;var e=d.readU8(f);d=d.readU8(f+1)|e<<8;c.advanceWidth=0!=(d&32768)?d-65536:d;d=a.data;f=a.hmtx+4*b+2;e=d.readU8(f);d=d.readU8(f+1)|e<<8}else{f=a.data;e=a.hmtx+4*(d-1);var g=f.readU8(e);f=f.readU8(e+1)|g<<8;c.advanceWidth=0!=(f&32768)?f-65536:f;f=a.data;d=a.hmtx+4*d+2*(b-d);e=f.readU8(d);d=f.readU8(d+1)|e<<8}c.leftSideBearing=0!=(d&32768)?d-65536:d;return c};z.stbtt_GetFontVMetrics=function(a){var b=
new Dc,c=a.data,d=a.hhea+4,f=c.readU8(d);c=c.readU8(d+1)|f<<8;b.ascent=0!=(c&32768)?c-65536:c;c=a.data;d=a.hhea+6;f=c.readU8(d);c=c.readU8(d+1)|f<<8;b.descent=0!=(c&32768)?c-65536:c;c=a.data;a=a.hhea+8;d=c.readU8(a);a=c.readU8(a+1)|d<<8;b.lineGap=0!=(a&32768)?a-65536:a;return b};z.stbtt_ScaleForPixelHeight=function(a,b){var c=a.data,d=a.hhea+4,f=c.readU8(d);c=c.readU8(d+1)|f<<8;d=a.data;f=a.hhea+6;var e=d.readU8(f);d=d.readU8(f+1)|e<<8;return b/((0!=(c&32768)?c-65536:c)-(0!=(d&32768)?d-65536:d))};
z.stbtt_GetGlyphBitmapBoxSubpixel=function(a,b,c,d,f,e){var h=new Bc;if(z.stbtt_GetGlyphBox(a,b,h)){a=h.x1;b=h.y0;var l=h.y1;h.x0=Math.floor(h.x0*c+f);h.y0=Math.floor(-l*d+e);h.x1=Math.ceil(a*c+f);h.y1=Math.ceil(-b*d+e)}else h.x0=0,h.y0=0,h.x1=0,h.y1=0;return h};z.stbtt_GetGlyphBitmapBox=function(a,b,c,d){return z.stbtt_GetGlyphBitmapBoxSubpixel(a,b,c,d,0,0)};z.stbtt__new_active=function(a,b,c,d){var f=new Hc,e=(a[b].x1-a[b].x0)/(a[b].y1-a[b].y0);if(null==f)return f;f.fdx=e;f.fdy=0!=e?1/e:0;f.fx=
a[b].x0+e*(d-a[b].y0);f.fx-=c;f.direction=a[b].invert?1:-1;f.sy=a[b].y0;f.ey=a[b].y1;f.next=null;return f};z.stbtt__handle_clipped_edge=function(a,b,c,d,f,e,g,l){if(e!=l){if(!(e<l))throw new r("Error");if(!(d.sy<=d.ey))throw new r("Error");if(!(e>d.ey||l<d.sy)){e<d.sy&&(f+=(g-f)*(d.sy-e)/(l-e),e=d.sy);l>d.ey&&(g+=(g-f)*(d.ey-l)/(l-e),l=d.ey);if(f==c){if(!(g<=c+1))throw new r("Error");}else if(f==c+1){if(!(g>=c))throw new r("Error");}else if(f<=c){if(!(g<=c))throw new r("Error");}else if(f>=c+1){if(!(g>=
c+1))throw new r("Error");}else if(!(g>=c&&g<=c+1))throw new r("Error");if(f<=c&&g<=c)c=b+c,a[c]+=d.direction*(l-e);else if(!(f>=c+1&&g>=c+1)){if(!(f>=c&&f<=c+1&&g>=c&&g<=c+1))throw new r("Error");b+=c;a[b]+=d.direction*(l-e)*(1-(f-c+(g-c))/2)}}}};z.stbtt__fill_active_edges_new=function(a,b,c,d,f,e){for(var h=e+1;null!=f;){if(!(f.ey>=e))throw new r("Error");if(0==f.fdx){var l=f.fx;l<d&&(0<=l?(z.stbtt__handle_clipped_edge(a,0,l|0,f,l,e,l,h),z.stbtt__handle_clipped_edge(b,c-1,l+1|0,f,l,e,l,h)):z.stbtt__handle_clipped_edge(b,
c-1,0,f,l,e,l,h))}else{var k=f.fx,m=f.fdx,n=k+m,p=f.fdy;if(!(f.sy<=h&&f.ey>=e))throw new r("Error");if(f.sy>e){var q=k+m*(f.sy-e);var B=f.sy}else q=k,B=e;if(f.ey<h){l=k+m*(f.ey-e);var v=f.ey}else l=n,v=h;if(0<=q&&0<=l&&q<d&&l<d)if((q|0)==(l|0)){p=q|0;B=v-B;if(!(0<=p&&p<d))throw new r("Error");v=p;k=a;k[v]+=f.direction*(1-(q-p+(l-p))/2)*B;l=c+p;v=b;v[l]+=f.direction*B}else{q>l&&(B=h-(B-e),v=h-(v-e),k=B,B=v,v=k,k=l,l=q,q=k,p=-p,k=n);var u=q|0;n=l|0;m=(u+1-k)*p+e;k=f.direction;var t=k*(m-B);var w=u,
x=a;x[w]+=t*(1-(q-u+(u+1-u))/2);q=k*p;w=u+1;for(x=n;w<x;){var A=w++,C=a;C[A]+=t+q/2;t+=q}m+=p*(n-(u+1));if(!(1.01>=Math.abs(t)))throw new r("Error");p=n;q=a;q[p]+=t+k*(1-(n-n+(l-n))/2)*(v-m);l=c+n;p=b;p[l]+=k*(v-B)}else for(l=0,B=d;l<B;)v=l++,p=e,q=v,t=v+1,u=n,w=h,x=(v-k)/m+e,A=(v+1-k)/m+e,k<q&&u>t?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,q,x),z.stbtt__handle_clipped_edge(a,0,v,f,q,x,t,A),z.stbtt__handle_clipped_edge(a,0,v,f,t,A,u,w)):u<q&&k>t?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,t,A),z.stbtt__handle_clipped_edge(a,
0,v,f,t,A,q,x),z.stbtt__handle_clipped_edge(a,0,v,f,q,x,u,w)):k<q&&u>q?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,q,x),z.stbtt__handle_clipped_edge(a,0,v,f,q,x,u,w)):u<q&&k>q?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,q,x),z.stbtt__handle_clipped_edge(a,0,v,f,q,x,u,w)):k<t&&u>t?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,t,A),z.stbtt__handle_clipped_edge(a,0,v,f,t,A,u,w)):u<t&&k>t?(z.stbtt__handle_clipped_edge(a,0,v,f,k,p,t,A),z.stbtt__handle_clipped_edge(a,0,v,f,t,A,u,w)):z.stbtt__handle_clipped_edge(a,
0,v,f,k,p,u,w)}f=f.next}};z.stbtt__rasterize_sorted_edges=function(a,b,c,d,f,e){d=null;var h=0,l=0;var k=64<a.w?Array(2*a.w+1):Array(129);var m=a.w;var n=e;for(b[l+c].y0=e+a.h+1;h<a.h;){c=n+0;e=n+1;var p=d;var q=null;for(var B=0,v=a.w;B<v;){var u=B++;k[u]=0}B=0;for(v=a.w+1;B<v;)u=B++,k[m+u]=0;for(;null!=p;)if(B=p,B.ey<=c){null==q?d=B.next:q.next=B.next;p=B.next;if(0==B.direction)throw new r("Error");B.direction=0}else q=p,p=p.next;for(;b[l].y0<=e;){if(b[l].y0!=b[l].y1){p=z.stbtt__new_active(b,l,f,
c);if(!(p.ey>=c))throw new r("Error");p.next=d;d=p}++l}null!=d&&z.stbtt__fill_active_edges_new(k,k,m+1,a.w,d,c);e=c=0;for(p=a.w;e<p;)q=e++,c+=k[m+q],B=k[q]+c,B=255*Math.abs(B)+.5,B|=0,255<B&&(B=255),a.pixels.writeU8(a.pixels_offset+h*a.stride+q,B);for(p=d;null!=p;)c=p,c.fx+=c.fdx,p=p.next;++n;++h}};z.STBTT__COMPARE=function(a,b){return a.y0<b.y0};z.stbtt__sort_edges_ins_sort=function(a,b){for(var c,d=1;d<b;){var f=d++,e=a[f],g=e;for(c=f;0<c&&z.STBTT__COMPARE(g,a[c-1]);)a[c]=a[c-1],--c;f!=c&&(a[c]=
e)}};z.stbtt__sort_edges_quicksort=function(a,b,c){for(;12<c;){var d=c>>1;var f=z.STBTT__COMPARE(a[b],a[b+d]);var e=z.STBTT__COMPARE(a[b+d],a[b+c-1]);f!=e&&(f=z.STBTT__COMPARE(a[b],a[b+c-1]),f=f==e?0:c-1,e=a[b+f],a[b+f]=a[b+d],a[b+d]=e);e=a[b];a[b]=a[b+d];a[b+d]=e;d=1;for(f=c-1;;){for(;z.STBTT__COMPARE(a[b+d],a[b]);)++d;for(;z.STBTT__COMPARE(a[b],a[b+f]);)--f;if(d>=f)break;e=a[b+d];a[b+d]=a[b+f];a[b+f]=e;++d;--f}f<c-d?(z.stbtt__sort_edges_quicksort(a,b,f),b+=d,c-=d):(z.stbtt__sort_edges_quicksort(a,
b+d,c-d),c=f)}};z.stbtt__sort_edges=function(a,b){z.stbtt__sort_edges_quicksort(a,0,b);z.stbtt__sort_edges_ins_sort(a,b)};z.stbtt__rasterize=function(a,b,c,d,f,e,g,l,k,m,n){e=n?-e:e;var h,q;for(h=q=0;h<d;){var y=h++;q+=c[y]}h=Array(q+1);if(null!=h){q=0;for(y=h.length;q<y;){var r=q++;h[r]=new Gc}for(var u=r=q=0;u<d;){var t=u++,w=b,M=0+r;r+=c[t];y=c[t]-1;var x=0;for(t=c[t];x<t;){var A=x++,C=A,E=y;if(w[M+y].y!=w[M+A].y){h[q].invert=!1;if(n?w[M+y].y>w[M+A].y:w[M+y].y<w[M+A].y)h[q].invert=!0,C=y,E=A;h[q].x0=
w[M+C].x*f+g;h[q].y0=1*(w[M+C].y*e+l);h[q].x1=w[M+E].x*f+g;h[q].y1=1*(w[M+E].y*e+l);++q}y=A}}z.stbtt__sort_edges(h,q);z.stbtt__rasterize_sorted_edges(a,h,q,1,k,m)}};z.stbtt__add_point=function(a,b,c,d){null!=a&&(a[b].x=c,a[b].y=d)};z.stbtt__tesselate_curve=function(a,b,c,d,f,e,g,l,k,m){var h=(c+2*f+g)/4,p=(d+2*e+l)/4,n=(c+g)/2-h,q=(d+l)/2-p;if(16<m)return 1;n*n+q*q>k?(z.stbtt__tesselate_curve(a,b,c,d,(c+f)/2,(d+e)/2,h,p,k,m+1),z.stbtt__tesselate_curve(a,b,h,p,(f+g)/2,(e+l)/2,g,l,k,m+1)):(z.stbtt__add_point(a,
b.value,g,l),b.value+=1);return 1};z.stbtt_FlattenCurves=function(a,b,c,d,f){var e=null,g=0;c*=c;for(var l=0,k=0,m=0;m<b;){var n=m++;1==a[n].type&&++l}f.value=l;if(0==l)return null;d.value=Array(l);if(null==d.value)return f.value=0,null;for(m=0;2>m;){var p=n=0;if(1==m++){e=Array(g);if(null==e)return d.value=null,f.value=0,null;g=0;for(l=e.length;g<l;){var q=g++;e[q]=new Ic}}g=0;l=-1;q=0;for(var r=b;q<r;){var v=q++;switch(a[v].type){case 1:0<=l&&(d.value[l]=g-k);++l;k=g;n=a[v].x;p=a[v].y;z.stbtt__add_point(e,
g++,n,p);break;case 2:n=a[v].x;p=a[v].y;z.stbtt__add_point(e,g++,n,p);break;case 3:g={value:g},z.stbtt__tesselate_curve(e,g,n,p,a[v].cx,a[v].cy,a[v].x,a[v].y,c,0),g=g.value,n=a[v].x,p=a[v].y}}d.value[l]=g-k}return e};z.stbtt_Rasterize=function(a,b,c,d,e,h,g,l,k,m,n){var f=e>h?h:e;var q={value:0};var y=new Ac;b=z.stbtt_FlattenCurves(c,d,b/f,y,q);q=q.value;y=y.value;null!=b&&z.stbtt__rasterize(a,b,y,q,e,h,g,l,k,m,n)};z.stbtt_MakeGlyphBitmapSubpixel=function(a,b,c,d,e,h,g,l,k,m,n){var f=z.stbtt_GetGlyphShape(a,
n),q=null==f?0:f.length,y=new Fc;n=z.stbtt_GetGlyphBitmapBoxSubpixel(a,n,g,l,k,m);a=n.x0;n=n.y0;y.pixels=b;y.pixels_offset=c;y.w=d;y.h=e;y.stride=h;0!=y.w&&0!=y.h&&z.stbtt_Rasterize(y,.35,f,q,g,l,k,m,a,n,!0)};z.stbtt_MakeGlyphBitmap=function(a,b,c,d,e,h,g,l,k){z.stbtt_MakeGlyphBitmapSubpixel(a,b,c,d,e,h,g,l,0,0,k)};z.stbtt_BakeFontBitmap=function(a,b,c,d,e,h,g,l){var f=new Wc;if(!z.stbtt_InitFont(f,a,b))return-1;a=0;for(b=e*h;a<b;){var m=a++;d.writeU8(m,0)}m=a=b=1;c=z.stbtt_ScaleForPixelHeight(f,
c);for(var n=0,p=0;p<g.length;){var q=g[p];++p;var t=z.stbtt_FindGlyphIndex(f,q);q=z.stbtt_GetGlyphHMetrics(f,t).advanceWidth;var v=z.stbtt_GetGlyphBitmapBox(f,t,c,c);var u=v.x0;var w=v.y0;var x=v.x1;v=v.y1;x-=u;v-=w;a+x+1>=e&&(b=m,a=1);if(b+v+1>=h)return-n;if(a+x>=e)throw new r("Error");if(b+v>=h)throw new r("Error");z.stbtt_MakeGlyphBitmap(f,d,a+b*e,x,v,e,c,c,t);l[n].x0=a;l[n].y0=b;l[n].x1=a+x;l[n].y1=b+v;l[n].xadvance=c*q;l[n].xoff=u;l[n].yoff=w;a=a+x+1;b+v+1>m&&(m=b+v+1);++n}return m};var F=m["kha.graphics4.BlendingFactor"]=
{__ename__:!0,__constructs__:"Undefined BlendOne BlendZero SourceAlpha DestinationAlpha InverseSourceAlpha InverseDestinationAlpha SourceColor DestinationColor InverseSourceColor InverseDestinationColor".split(" ")};F.Undefined=["Undefined",0];F.Undefined.toString=w;F.Undefined.__enum__=F;F.BlendOne=["BlendOne",1];F.BlendOne.toString=w;F.BlendOne.__enum__=F;F.BlendZero=["BlendZero",2];F.BlendZero.toString=w;F.BlendZero.__enum__=F;F.SourceAlpha=["SourceAlpha",3];F.SourceAlpha.toString=w;F.SourceAlpha.__enum__=
F;F.DestinationAlpha=["DestinationAlpha",4];F.DestinationAlpha.toString=w;F.DestinationAlpha.__enum__=F;F.InverseSourceAlpha=["InverseSourceAlpha",5];F.InverseSourceAlpha.toString=w;F.InverseSourceAlpha.__enum__=F;F.InverseDestinationAlpha=["InverseDestinationAlpha",6];F.InverseDestinationAlpha.toString=w;F.InverseDestinationAlpha.__enum__=F;F.SourceColor=["SourceColor",7];F.SourceColor.toString=w;F.SourceColor.__enum__=F;F.DestinationColor=["DestinationColor",8];F.DestinationColor.toString=w;F.DestinationColor.__enum__=
F;F.InverseSourceColor=["InverseSourceColor",9];F.InverseSourceColor.toString=w;F.InverseSourceColor.__enum__=F;F.InverseDestinationColor=["InverseDestinationColor",10];F.InverseDestinationColor.toString=w;F.InverseDestinationColor.__enum__=F;var za=m["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"]};za.Add=["Add",0];za.Add.toString=w;za.Add.__enum__=za;za.Subtract=["Subtract",1];za.Subtract.toString=w;za.Subtract.__enum__=za;za.ReverseSubtract=
["ReverseSubtract",2];za.ReverseSubtract.toString=w;za.ReverseSubtract.__enum__=za;za.Min=["Min",3];za.Min.toString=w;za.Min.__enum__=za;za.Max=["Max",4];za.Max.toString=w;za.Max.__enum__=za;var aa=m["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:"Always Never Equal NotEqual Less LessEqual Greater GreaterEqual".split(" ")};aa.Always=["Always",0];aa.Always.toString=w;aa.Always.__enum__=aa;aa.Never=["Never",1];aa.Never.toString=w;aa.Never.__enum__=aa;aa.Equal=["Equal",2];aa.Equal.toString=
w;aa.Equal.__enum__=aa;aa.NotEqual=["NotEqual",3];aa.NotEqual.toString=w;aa.NotEqual.__enum__=aa;aa.Less=["Less",4];aa.Less.toString=w;aa.Less.__enum__=aa;aa.LessEqual=["LessEqual",5];aa.LessEqual.toString=w;aa.LessEqual.__enum__=aa;aa.Greater=["Greater",6];aa.Greater.toString=w;aa.Greater.__enum__=aa;aa.GreaterEqual=["GreaterEqual",7];aa.GreaterEqual.toString=w;aa.GreaterEqual.__enum__=aa;var ue=function(){};m["kha.graphics4.ConstantLocation"]=ue;ue.__name__=!0;var wa=function(a,b,c,d){this.isDepthAttachment=
!1;this.frameBuffer=this.texture=this.depthTexture=null;this.myHeight=this.myWidth=a;this.format=b;this.renderTarget=c;this.depthStencilFormat=d;c&&this.createTexture()};m["kha.graphics4.CubeMap"]=wa;wa.__name__=!0;wa.__interfaces__=[Nb,Mb];wa.createRenderTarget=function(a,b,c,d){null==b&&(b=U.RGBA32);null==c&&(c=0);return new wa(a,b,!0,c)};wa.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,
isDepthAttachment:null,createTexture:function(){if(null!=e.gl){this.texture=e.gl.createTexture();e.gl.bindTexture(34067,this.texture);e.gl.texParameteri(34067,10240,9729);e.gl.texParameteri(34067,10241,9729);e.gl.texParameteri(34067,10242,33071);e.gl.texParameteri(34067,10243,33071);if(this.renderTarget){this.frameBuffer=e.gl.createFramebuffer();e.gl.bindFramebuffer(36160,this.frameBuffer);switch(this.format[1]){case 0:for(var a=0;6>a;){var b=a++;e.gl.texImage2D(34069+b,0,6408,this.myWidth,this.myHeight,
0,6408,5121,null)}break;case 2:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,e.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,e.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,e.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,e.halfFloat.HALF_FLOAT_OES,null);break;case 5:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,e.gl2?33326:6406,this.myWidth,this.myHeight,
0,6406,5126,null);break;case 6:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,e.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,e.halfFloat.HALF_FLOAT_OES,null);break;default:for(a=0;6>a;)b=a++,e.gl.texImage2D(34069+b,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(this.format==U.DEPTH16&&(e.gl.texParameteri(34067,10240,9728),e.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,-1==navigator.appVersion.indexOf("Win"))){a=e.gl.createTexture();e.gl.bindTexture(34067,a);for(b=0;6>b;){var c=
b++;e.gl.texImage2D(34069+c,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);e.gl.framebufferTexture2D(36160,36064,34069+c,a,0)}e.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat);e.gl.bindFramebuffer(36160,null)}e.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(a){switch(a){case 1:case 5:this.depthTexture=e.gl.createTexture();e.gl.bindTexture(34067,this.depthTexture);1==a?e.gl.texImage2D(34067,0,e.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,
5125,null):e.gl.texImage2D(34067,0,e.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);e.gl.texParameteri(34067,10240,9728);e.gl.texParameteri(34067,10241,9728);e.gl.texParameteri(34067,10242,33071);e.gl.texParameteri(34067,10243,33071);e.gl.bindFramebuffer(36160,this.frameBuffer);e.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=e.gl.createTexture(),e.gl.bindTexture(34067,this.depthTexture),e.gl.texImage2D(34067,0,e.gl2?35056:
34041,this.myWidth,this.myHeight,0,34041,e.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),e.gl.texParameteri(34067,10240,9728),e.gl.texParameteri(34067,10241,9728),e.gl.texParameteri(34067,10242,33071),e.gl.texParameteri(34067,10243,33071),e.gl.bindFramebuffer(36160,this.frameBuffer),e.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){null==this.graphics4&&(this.graphics4=new ka(this));
return this.graphics4},__class__:wa};var jb=m["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"]};jb.Clockwise=["Clockwise",0];jb.Clockwise.toString=w;jb.Clockwise.__enum__=jb;jb.CounterClockwise=["CounterClockwise",1];jb.CounterClockwise.toString=w;jb.CounterClockwise.__enum__=jb;jb.None=["None",2];jb.None.toString=w;jb.None.__enum__=jb;var Yc=function(a,b){this.sources=[];for(var c=0;c<a.length;){var d=a[c];++c;this.sources.push(d.toString())}this.type=
35632;this.shader=null;this.files=b};m["kha.graphics4.FragmentShader"]=Yc;Yc.__name__=!0;Yc.prototype={sources:null,type:null,shader:null,files:null,__class__:Yc};var Ae=function(){};m["kha.graphics4.GeometryShader"]=Ae;Ae.__name__=!0;var Jc=function(){};m["kha.graphics4.Graphics"]=Jc;Jc.__name__=!0;Jc.prototype={begin:null,end:null,clear:null,scissor:null,setVertexBuffer:null,setIndexBuffer:null,setTexture:null,setTextureParameters:null,renderTargetsInvertedY:null,setPipeline:null,setMatrix:null,
drawIndexedVertices:null,__class__:Jc};var V=function(a){this.myPipeline=null;this.bilinear=this.bilinearMipmaps=!1;this.g=a;this.bufferIndex=0;V.initShaders();this.initBuffers();this.projectionLocation=V.shaderPipeline.getConstantLocation("projectionMatrix");this.textureLocation=V.shaderPipeline.getTextureUnit("tex")};m["kha.graphics4.ImageShaderPainter"]=V;V.__name__=!0;V.initShaders=function(){null==V.shaderPipeline&&(V.shaderPipeline=new Sb,V.shaderPipeline.fragmentShader=A.painter_image_frag,
V.shaderPipeline.vertexShader=A.painter_image_vert,V.structure=new Kc,V.structure.add("vertexPosition",ba.Float3),V.structure.add("texPosition",ba.Float2),V.structure.add("vertexColor",ba.Float4),V.shaderPipeline.inputLayout=[V.structure],V.shaderPipeline.blendSource=F.BlendOne,V.shaderPipeline.blendDestination=F.InverseSourceAlpha,V.shaderPipeline.alphaBlendSource=F.SourceAlpha,V.shaderPipeline.alphaBlendDestination=F.InverseSourceAlpha,V.shaderPipeline.compile())};V.prototype={projectionMatrix:null,
projectionLocation:null,textureLocation:null,bufferIndex:null,rectVertexBuffer:null,rectVertices:null,indexBuffer:null,lastTexture:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},setProjection:function(a){this.projectionMatrix=a},initBuffers:function(){this.rectVertexBuffer=new Tb(4*V.bufferSize,V.structure,ua.DynamicUsage);this.rectVertices=this.rectVertexBuffer.lock();this.indexBuffer=new Ub(6*V.bufferSize,ua.StaticUsage);for(var a=
this.indexBuffer.lock(),b=0,c=V.bufferSize;b<c;){var d=b++;a[6*d]=4*d;a[6*d+1]=4*d+1;a[6*d+2]=4*d+2;a[6*d+3]=4*d;a[6*d+4]=4*d+2;a[6*d+5]=4*d+3}this.indexBuffer.unlock()},drawBuffer:function(){this.rectVertexBuffer.unlock();this.g.setVertexBuffer(this.rectVertexBuffer);this.g.setIndexBuffer(this.indexBuffer);this.g.setPipeline(null==this.get_pipeline()?V.shaderPipeline:this.get_pipeline());this.g.setTexture(this.textureLocation,this.lastTexture);this.g.setTextureParameters(this.textureLocation,Ta.Clamp,
Ta.Clamp,this.bilinear?Aa.LinearFilter:Aa.PointFilter,this.bilinear?Aa.LinearFilter:Aa.PointFilter,this.bilinearMipmaps?Ua.LinearMipFilter:Ua.NoMipFilter);this.g.setMatrix(this.projectionLocation,this.projectionMatrix);this.g.drawIndexedVertices(0,6*this.bufferIndex);this.g.setTexture(this.textureLocation,null);this.bufferIndex=0;this.rectVertices=this.rectVertexBuffer.lock()},end:function(){0<this.bufferIndex&&this.drawBuffer();this.lastTexture=null},__class__:V};var W=function(a){this.myPipeline=
null;this.g=a;this.triangleBufferIndex=this.bufferIndex=0;W.initShaders();this.initBuffers();this.projectionLocation=W.shaderPipeline.getConstantLocation("projectionMatrix")};m["kha.graphics4.ColoredShaderPainter"]=W;W.__name__=!0;W.initShaders=function(){null==W.shaderPipeline&&(W.shaderPipeline=new Sb,W.shaderPipeline.fragmentShader=A.painter_colored_frag,W.shaderPipeline.vertexShader=A.painter_colored_vert,W.structure=new Kc,W.structure.add("vertexPosition",ba.Float3),W.structure.add("vertexColor",
ba.Float4),W.shaderPipeline.inputLayout=[W.structure],W.shaderPipeline.blendSource=F.SourceAlpha,W.shaderPipeline.blendDestination=F.InverseSourceAlpha,W.shaderPipeline.alphaBlendSource=F.SourceAlpha,W.shaderPipeline.alphaBlendDestination=F.InverseSourceAlpha,W.shaderPipeline.compile())};W.prototype={projectionMatrix:null,projectionLocation:null,bufferIndex:null,rectVertexBuffer:null,rectVertices:null,indexBuffer:null,triangleBufferIndex:null,triangleVertexBuffer:null,triangleVertices:null,triangleIndexBuffer:null,
g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},setProjection:function(a){this.projectionMatrix=a},initBuffers:function(){this.rectVertexBuffer=new Tb(4*W.bufferSize,W.structure,ua.DynamicUsage);this.rectVertices=this.rectVertexBuffer.lock();this.indexBuffer=new Ub(6*W.bufferSize,ua.StaticUsage);for(var a=this.indexBuffer.lock(),b=0,c=W.bufferSize;b<c;){var d=b++;a[6*d]=4*d;a[6*d+1]=4*d+1;a[6*d+2]=4*d+2;a[6*d+3]=4*d;a[6*d+4]=4*d+2;a[6*d+5]=4*d+3}this.indexBuffer.unlock();this.triangleVertexBuffer=
new Tb(3*W.triangleBufferSize,W.structure,ua.DynamicUsage);this.triangleVertices=this.triangleVertexBuffer.lock();this.triangleIndexBuffer=new Ub(3*W.triangleBufferSize,ua.StaticUsage);a=this.triangleIndexBuffer.lock();b=0;for(c=W.bufferSize;b<c;)d=b++,a[3*d]=3*d,a[3*d+1]=3*d+1,a[3*d+2]=3*d+2;this.triangleIndexBuffer.unlock()},setRectVertices:function(a,b,c,d,e,h,g,l){var f=28*this.bufferIndex;this.rectVertices[f]=a;this.rectVertices[f+1]=b;this.rectVertices[f+2]=-5;this.rectVertices[f+7]=c;this.rectVertices[f+
8]=d;this.rectVertices[f+9]=-5;this.rectVertices[f+14]=e;this.rectVertices[f+15]=h;this.rectVertices[f+16]=-5;this.rectVertices[f+21]=g;this.rectVertices[f+22]=l;this.rectVertices[f+23]=-5},setRectColors:function(a,b){var c=28*this.bufferIndex,d=.00392156862745098*a*(b>>>24);this.rectVertices[c+3]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+4]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+5]=.00392156862745098*(b&255);this.rectVertices[c+6]=d;this.rectVertices[c+10]=.00392156862745098*
((b&16711680)>>>16);this.rectVertices[c+11]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+12]=.00392156862745098*(b&255);this.rectVertices[c+13]=d;this.rectVertices[c+17]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+18]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+19]=.00392156862745098*(b&255);this.rectVertices[c+20]=d;this.rectVertices[c+24]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+25]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+26]=
.00392156862745098*(b&255);this.rectVertices[c+27]=d},setTriVertices:function(a,b,c,d,e,h){var f=21*this.triangleBufferIndex;this.triangleVertices[f]=a;this.triangleVertices[f+1]=b;this.triangleVertices[f+2]=-5;this.triangleVertices[f+7]=c;this.triangleVertices[f+8]=d;this.triangleVertices[f+9]=-5;this.triangleVertices[f+14]=e;this.triangleVertices[f+15]=h;this.triangleVertices[f+16]=-5},setTriColors:function(a,b){var c=21*this.triangleBufferIndex,d=.00392156862745098*a*(b>>>24);this.triangleVertices[c+
3]=.00392156862745098*((b&16711680)>>>16);this.triangleVertices[c+4]=.00392156862745098*((b&65280)>>>8);this.triangleVertices[c+5]=.00392156862745098*(b&255);this.triangleVertices[c+6]=d;this.triangleVertices[c+10]=.00392156862745098*((b&16711680)>>>16);this.triangleVertices[c+11]=.00392156862745098*((b&65280)>>>8);this.triangleVertices[c+12]=.00392156862745098*(b&255);this.triangleVertices[c+13]=d;this.triangleVertices[c+17]=.00392156862745098*((b&16711680)>>>16);this.triangleVertices[c+18]=.00392156862745098*
((b&65280)>>>8);this.triangleVertices[c+19]=.00392156862745098*(b&255);this.triangleVertices[c+20]=d},drawBuffer:function(a){a||0<this.triangleBufferIndex&&this.drawTriBuffer(!0);this.rectVertexBuffer.unlock();this.g.setVertexBuffer(this.rectVertexBuffer);this.g.setIndexBuffer(this.indexBuffer);this.g.setPipeline(null==this.get_pipeline()?W.shaderPipeline:this.get_pipeline());this.g.setMatrix(this.projectionLocation,this.projectionMatrix);this.g.drawIndexedVertices(0,6*this.bufferIndex);this.bufferIndex=
0;this.rectVertices=this.rectVertexBuffer.lock()},drawTriBuffer:function(a){a||0<this.bufferIndex&&this.drawBuffer(!0);this.triangleVertexBuffer.unlock();this.g.setVertexBuffer(this.triangleVertexBuffer);this.g.setIndexBuffer(this.triangleIndexBuffer);this.g.setPipeline(null==this.get_pipeline()?W.shaderPipeline:this.get_pipeline());this.g.setMatrix(this.projectionLocation,this.projectionMatrix);this.g.drawIndexedVertices(0,3*this.triangleBufferIndex);this.triangleBufferIndex=0;this.triangleVertices=
this.triangleVertexBuffer.lock()},fillRect:function(a,b,c,d,e,h,g,l,k,m){0<this.triangleBufferIndex&&this.drawTriBuffer(!0);this.bufferIndex+1>=W.bufferSize&&this.drawBuffer(!1);this.setRectColors(a,b);this.setRectVertices(c,d,e,h,g,l,k,m);++this.bufferIndex},fillTriangle:function(a,b,c,d,e,h,g,l){0<this.bufferIndex&&this.drawBuffer(!0);this.triangleBufferIndex+1>=W.triangleBufferSize&&this.drawTriBuffer(!1);this.setTriColors(a,b);this.setTriVertices(c,d,e,h,g,l);++this.triangleBufferIndex},__class__:W};
var X=function(a){this.bilinear=!1;this.myPipeline=null;this.g=a;this.bufferIndex=0;X.initShaders();this.initBuffers();this.projectionLocation=X.shaderPipeline.getConstantLocation("projectionMatrix");this.textureLocation=X.shaderPipeline.getTextureUnit("tex")};m["kha.graphics4.TextShaderPainter"]=X;X.__name__=!0;X.initShaders=function(){null==X.shaderPipeline&&(X.shaderPipeline=new Sb,X.shaderPipeline.fragmentShader=A.painter_text_frag,X.shaderPipeline.vertexShader=A.painter_text_vert,X.structure=
new Kc,X.structure.add("vertexPosition",ba.Float3),X.structure.add("texPosition",ba.Float2),X.structure.add("vertexColor",ba.Float4),X.shaderPipeline.inputLayout=[X.structure],X.shaderPipeline.blendSource=F.SourceAlpha,X.shaderPipeline.blendDestination=F.InverseSourceAlpha,X.shaderPipeline.alphaBlendSource=F.SourceAlpha,X.shaderPipeline.alphaBlendDestination=F.InverseSourceAlpha,X.shaderPipeline.compile())};X.findIndex=function(a,b){for(var c=0,d=b.length;c<d;){var e=c++;if(b[e]==a)return e}return 0};
X.prototype={projectionMatrix:null,projectionLocation:null,textureLocation:null,bufferIndex:null,rectVertexBuffer:null,rectVertices:null,indexBuffer:null,font:null,lastTexture:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},setProjection:function(a){this.projectionMatrix=a},initBuffers:function(){this.rectVertexBuffer=new Tb(4*X.bufferSize,X.structure,ua.DynamicUsage);this.rectVertices=this.rectVertexBuffer.lock();this.indexBuffer=new Ub(6*X.bufferSize,
ua.StaticUsage);for(var a=this.indexBuffer.lock(),b=0,c=X.bufferSize;b<c;){var d=b++;a[6*d]=4*d;a[6*d+1]=4*d+1;a[6*d+2]=4*d+2;a[6*d+3]=4*d;a[6*d+4]=4*d+2;a[6*d+5]=4*d+3}this.indexBuffer.unlock()},setRectVertices:function(a,b,c,d,e,h,g,l){var f=36*this.bufferIndex;this.rectVertices[f]=a;this.rectVertices[f+1]=b;this.rectVertices[f+2]=-5;this.rectVertices[f+9]=c;this.rectVertices[f+10]=d;this.rectVertices[f+11]=-5;this.rectVertices[f+18]=e;this.rectVertices[f+19]=h;this.rectVertices[f+20]=-5;this.rectVertices[f+
27]=g;this.rectVertices[f+28]=l;this.rectVertices[f+29]=-5},setRectTexCoords:function(a,b,c,d){var e=36*this.bufferIndex;this.rectVertices[e+3]=a;this.rectVertices[e+4]=d;this.rectVertices[e+12]=a;this.rectVertices[e+13]=b;this.rectVertices[e+21]=c;this.rectVertices[e+22]=b;this.rectVertices[e+30]=c;this.rectVertices[e+31]=d},setRectColors:function(a,b){var c=36*this.bufferIndex,d=.00392156862745098*a*(b>>>24);this.rectVertices[c+5]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+6]=.00392156862745098*
((b&65280)>>>8);this.rectVertices[c+7]=.00392156862745098*(b&255);this.rectVertices[c+8]=d;this.rectVertices[c+14]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+15]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+16]=.00392156862745098*(b&255);this.rectVertices[c+17]=d;this.rectVertices[c+23]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+24]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+25]=.00392156862745098*(b&255);this.rectVertices[c+26]=d;this.rectVertices[c+
32]=.00392156862745098*((b&16711680)>>>16);this.rectVertices[c+33]=.00392156862745098*((b&65280)>>>8);this.rectVertices[c+34]=.00392156862745098*(b&255);this.rectVertices[c+35]=d},drawBuffer:function(){this.rectVertexBuffer.unlock();this.g.setVertexBuffer(this.rectVertexBuffer);this.g.setIndexBuffer(this.indexBuffer);this.g.setPipeline(null==this.get_pipeline()?X.shaderPipeline:this.get_pipeline());this.g.setTexture(this.textureLocation,this.lastTexture);this.g.setMatrix(this.projectionLocation,this.projectionMatrix);
this.g.setTextureParameters(this.textureLocation,Ta.Clamp,Ta.Clamp,this.bilinear?Aa.LinearFilter:Aa.PointFilter,this.bilinear?Aa.LinearFilter:Aa.PointFilter,Ua.NoMipFilter);this.g.drawIndexedVertices(0,6*this.bufferIndex);this.g.setTexture(this.textureLocation,null);this.bufferIndex=0;this.rectVertices=this.rectVertexBuffer.lock()},setFont:function(a){this.font=E.__cast(a,Ob)},text:null,startString:function(a){this.text=a},charCodeAt:function(a){return G.cca(this.text,a)},stringLength:function(){return this.text.length},
endString:function(){this.text=null},drawString:function(a,b,c,d,e,h,g){var f=this.font._get(this.fontSize,g),k=f.getTexture();null!=this.lastTexture&&k!=this.lastTexture&&this.drawBuffer();this.lastTexture=k;this.startString(a);a=0;for(var m=this.stringLength();a<m;){var n=a++;n=f.getBakedQuad(X.findIndex(this.charCodeAt(n),g),d,e);if(null!=n){this.bufferIndex+1>=X.bufferSize&&this.drawBuffer();this.setRectColors(b,c);this.setRectTexCoords(n.s0*k.get_width()/k.get_realWidth(),n.t0*k.get_height()/
k.get_realHeight(),n.s1*k.get_width()/k.get_realWidth(),n.t1*k.get_height()/k.get_realHeight());var p=n.x0;var q=n.y1;var r=h._02*p+h._12*q+h._22;var t=(h._01*p+h._11*q+h._21)/r;q=(h._00*p+h._10*q+h._20)/r;var u=n.x0;p=n.y0;var w=h._02*u+h._12*p+h._22;r=(h._01*u+h._11*p+h._21)/w;p=(h._00*u+h._10*p+h._20)/w;var x=n.x1;u=n.y0;var z=h._02*x+h._12*u+h._22;w=(h._01*x+h._11*u+h._21)/z;u=(h._00*x+h._10*u+h._20)/z;z=n.x1;x=n.y1;var A=h._02*z+h._12*x+h._22;this.setRectVertices(q,t,p,r,u,w,(h._00*z+h._10*x+
h._20)/A,(h._01*z+h._11*x+h._21)/A);d+=n.xadvance;++this.bufferIndex}}this.endString()},end:function(){0<this.bufferIndex&&this.drawBuffer();this.lastTexture=null},__class__:X};var Ia=function(a){ib.call(this);this.set_color(-1);this.canvas=a;this.g=a.get_g4();this.imagePainter=new V(this.g);this.coloredPainter=new W(this.g);this.textPainter=new X(this.g);this.textPainter.fontSize=this.get_fontSize();this.setProjection();null==Ia.videoPipeline&&(Ia.videoPipeline=new Sb,Ia.videoPipeline.fragmentShader=
A.painter_video_frag,Ia.videoPipeline.vertexShader=A.painter_video_vert,a=new Kc,a.add("vertexPosition",ba.Float3),a.add("texPosition",ba.Float2),a.add("vertexColor",ba.Float4),Ia.videoPipeline.inputLayout=[a],Ia.videoPipeline.compile())};m["kha.graphics4.Graphics2"]=Ia;Ia.__name__=!0;Ia.upperPowerOfTwo=function(a){--a;a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;a|=a>>>16;return++a};Ia.__super__=ib;Ia.prototype=na(ib.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,
textPainter:null,canvas:null,g:null,setProjection:function(){var a=this.canvas.get_width(),b=this.canvas.get_height();E.__instanceof(this.canvas,cc)?this.projectionMatrix=Vb.orthogonalProjection(0,a,b,0,.1,1E3):(qa.get_nonPow2Supported()||(a=Ia.upperPowerOfTwo(a),b=Ia.upperPowerOfTwo(b)),this.g.renderTargetsInvertedY()?this.projectionMatrix=Vb.orthogonalProjection(0,a,0,b,.1,1E3):this.projectionMatrix=Vb.orthogonalProjection(0,a,b,0,.1,1E3));this.imagePainter.setProjection(this.projectionMatrix);
this.coloredPainter.setProjection(this.projectionMatrix);this.textPainter.setProjection(this.projectionMatrix)},get_color:function(){return this.myColor},set_color:function(a){return this.myColor=a},drawRect:function(a,b,c,d,e){null==e&&(e=1);this.imagePainter.end();this.textPainter.end();var f=this.transformations[this.transformations.length-1],g=a-e/2;var l=b+e/2;var k=f._02*g+f._12*l+f._22;f=new J((f._00*g+f._10*l+f._20)/k,(f._01*g+f._11*l+f._21)/k);l=this.transformations[this.transformations.length-
1];k=a-e/2;g=b-e/2;var m=l._02*k+l._12*g+l._22;l=new J((l._00*k+l._10*g+l._20)/m,(l._01*k+l._11*g+l._21)/m);g=this.transformations[this.transformations.length-1];m=a+c+e/2;k=b-e/2;var n=g._02*m+g._12*k+g._22;g=new J((g._00*m+g._10*k+g._20)/n,(g._01*m+g._11*k+g._21)/n);k=this.transformations[this.transformations.length-1];n=a+c+e/2;m=b+e/2;var p=k._02*n+k._12*m+k._22;k=new J((k._00*n+k._10*m+k._20)/p,(k._01*n+k._11*m+k._21)/p);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f.x,f.y,
l.x,l.y,g.x,g.y,k.x,k.y);f=this.transformations[this.transformations.length-1];k=a-e/2;g=b+d+e/2;m=f._02*k+f._12*g+f._22;f=new J((f._00*k+f._10*g+f._20)/m,(f._01*k+f._11*g+f._21)/m);g=this.transformations[this.transformations.length-1];m=a+e/2;k=b-e/2;n=g._02*m+g._12*k+g._22;g=new J((g._00*m+g._10*k+g._20)/n,(g._01*m+g._11*k+g._21)/n);k=this.transformations[this.transformations.length-1];n=a+e/2;m=b+d+e/2;p=k._02*n+k._12*m+k._22;k=new J((k._00*n+k._10*m+k._20)/p,(k._01*n+k._11*m+k._21)/p);this.coloredPainter.fillRect(this.get_opacity(),
this.get_color(),f.x,f.y,l.x,l.y,g.x,g.y,k.x,k.y);l=this.transformations[this.transformations.length-1];k=a-e/2;g=b+d-e/2;m=l._02*k+l._12*g+l._22;l=new J((l._00*k+l._10*g+l._20)/m,(l._01*k+l._11*g+l._21)/m);g=this.transformations[this.transformations.length-1];m=a+c+e/2;k=b+d-e/2;n=g._02*m+g._12*k+g._22;g=new J((g._00*m+g._10*k+g._20)/n,(g._01*m+g._11*k+g._21)/n);k=this.transformations[this.transformations.length-1];n=a+c+e/2;m=b+d+e/2;p=k._02*n+k._12*m+k._22;k=new J((k._00*n+k._10*m+k._20)/p,(k._01*
n+k._11*m+k._21)/p);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f.x,f.y,l.x,l.y,g.x,g.y,k.x,k.y);f=this.transformations[this.transformations.length-1];g=a+c-e/2;l=b+d+e/2;k=f._02*g+f._12*l+f._22;f=new J((f._00*g+f._10*l+f._20)/k,(f._01*g+f._11*l+f._21)/k);l=this.transformations[this.transformations.length-1];k=a+c-e/2;g=b-e/2;m=l._02*k+l._12*g+l._22;l=new J((l._00*k+l._10*g+l._20)/m,(l._01*k+l._11*g+l._21)/m);g=this.transformations[this.transformations.length-1];m=a+c+e/2;k=b-
e/2;n=g._02*m+g._12*k+g._22;g=new J((g._00*m+g._10*k+g._20)/n,(g._01*m+g._11*k+g._21)/n);k=this.transformations[this.transformations.length-1];a=a+c+e/2;b=b+d+e/2;d=k._02*a+k._12*b+k._22;k=new J((k._00*a+k._10*b+k._20)/d,(k._01*a+k._11*b+k._21)/d);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),f.x,f.y,l.x,l.y,g.x,g.y,k.x,k.y)},fillRect:function(a,b,c,d){this.imagePainter.end();this.textPainter.end();var e=this.transformations[this.transformations.length-1];var h=b+d;var g=e._02*
a+e._12*h+e._22,l=(e._01*a+e._11*h+e._21)/g;e=(e._00*a+e._10*h+e._20)/g;g=this.transformations[this.transformations.length-1];var k=g._02*a+g._12*b+g._22;h=(g._01*a+g._11*b+g._21)/k;g=(g._00*a+g._10*b+g._20)/k;var m=this.transformations[this.transformations.length-1];var n=a+c,p=m._02*n+m._12*b+m._22;k=(m._01*n+m._11*b+m._21)/p;m=(m._00*n+m._10*b+m._20)/p;n=this.transformations[this.transformations.length-1];a+=c;d=b+d;c=n._02*a+n._12*d+n._22;b=(n._01*a+n._11*d+n._21)/c;d=(n._00*a+n._10*d+n._20)/
c;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),e,l,g,h,m,k,d,b)},drawString:function(a,b,c){this.imagePainter.end();var d=this.coloredPainter;0<d.triangleBufferIndex&&d.drawTriBuffer(!1);0<d.bufferIndex&&d.drawBuffer(!1);this.textPainter.drawString(a,this.get_opacity(),this.get_color(),b,c,this.transformations[this.transformations.length-1],this.get_fontGlyphs())},set_font:function(a){this.textPainter.setFont(a);return this.myFont=a},set_fontSize:function(a){return ib.prototype.set_fontSize.call(this,
this.textPainter.fontSize=a)},drawLine:function(a,b,c,d,e){null==e&&(e=1);this.imagePainter.end();this.textPainter.end();var f=d==b?new J(0,-1):new J(1,-(c-a)/(d-b));f.set_length(e);a=new J(a+.5*f.x,b+.5*f.y);c=new J(c+.5*f.x,d+.5*f.y);d=new J(a.x-f.x,a.y-f.y);f=new J(c.x-f.x,c.y-f.y);b=this.transformations[this.transformations.length-1];e=b._02*a.x+b._12*a.y+b._22;a=new J((b._00*a.x+b._10*a.y+b._20)/e,(b._01*a.x+b._11*a.y+b._21)/e);b=this.transformations[this.transformations.length-1];e=b._02*c.x+
b._12*c.y+b._22;c=new J((b._00*c.x+b._10*c.y+b._20)/e,(b._01*c.x+b._11*c.y+b._21)/e);b=this.transformations[this.transformations.length-1];e=b._02*d.x+b._12*d.y+b._22;d=new J((b._00*d.x+b._10*d.y+b._20)/e,(b._01*d.x+b._11*d.y+b._21)/e);b=this.transformations[this.transformations.length-1];e=b._02*f.x+b._12*f.y+b._22;f=new J((b._00*f.x+b._10*f.y+b._20)/e,(b._01*f.x+b._11*f.y+b._21)/e);this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,c.x,c.y,d.x,d.y);this.coloredPainter.fillTriangle(this.get_opacity(),
this.get_color(),d.x,d.y,c.x,c.y,f.x,f.y)},scissor:function(a,b,c,d){this.flush();this.g.scissor(a,b,c,d)},begin:function(a,b){null==a&&(a=!0);this.g.begin();a&&this.clear(b);this.setProjection()},clear:function(a){this.flush();this.g.clear(null==a?-16777216:a)},flush:function(){this.imagePainter.end();this.textPainter.end();var a=this.coloredPainter;0<a.triangleBufferIndex&&a.drawTriBuffer(!1);0<a.bufferIndex&&a.drawBuffer(!1)},end:function(){this.flush();this.g.end()},__class__:Ia});var Ub=function(a,
b,c){this.usage=b;this.mySize=a;this.buffer=e.gl.createBuffer();this._data=new Uint32Array(a)};m["kha.graphics4.IndexBuffer"]=Ub;Ub.__name__=!0;Ub.prototype={buffer:null,_data:null,mySize:null,usage:null,lock:function(a,b){null==a&&(a=0);null==b&&(b=this.mySize);return this._data.subarray(a,a+b)},unlock:function(){e.gl.bindBuffer(34963,this.buffer);var a=null==e.elementIndexUint?new Uint16Array(this._data):this._data;e.gl.bufferData(34963,a,this.usage==ua.DynamicUsage?35048:35044)},set:function(){e.gl.bindBuffer(34963,
this.buffer)},count:function(){return this.mySize},__class__:Ub};var Ua=m["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"]};Ua.NoMipFilter=["NoMipFilter",0];Ua.NoMipFilter.toString=w;Ua.NoMipFilter.__enum__=Ua;Ua.PointMipFilter=["PointMipFilter",1];Ua.PointMipFilter.toString=w;Ua.PointMipFilter.__enum__=Ua;Ua.LinearMipFilter=["LinearMipFilter",2];Ua.LinearMipFilter.toString=w;Ua.LinearMipFilter.__enum__=Ua;var gd=function(){this.tessellationEvaluationShader=
this.tessellationControlShader=this.geometryShader=this.fragmentShader=this.vertexShader=this.inputLayout=null;this.cullMode=jb.None;this.depthWrite=!1;this.stencilMode=this.depthMode=aa.Always;this.stencilFail=this.stencilDepthFail=this.stencilBothPass=ca.Keep;this.stencilReferenceValue=0;this.stencilWriteMask=this.stencilReadMask=255;this.blendSource=F.BlendOne;this.blendDestination=F.BlendZero;this.blendOperation=za.Add;this.alphaBlendSource=F.BlendOne;this.alphaBlendDestination=F.BlendZero;this.alphaBlendOperation=
za.Add;this.colorWriteMaskRed=this.colorWriteMaskBlue=this.colorWriteMaskGreen=this.colorWriteMaskAlpha=!0;this.conservativeRasterization=!1};m["kha.graphics4.PipelineStateBase"]=gd;gd.__name__=!0;gd.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,
stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMaskRed:null,colorWriteMaskGreen:null,colorWriteMaskBlue:null,colorWriteMaskAlpha:null,conservativeRasterization:null,__class__:gd};var Sb=function(){this.program=null;gd.call(this);this.textures=[];this.textureValues=[]};m["kha.graphics4.PipelineState"]=Sb;Sb.__name__=!0;Sb.__super__=gd;Sb.prototype=na(gd.prototype,{program:null,textures:null,
textureValues:null,compile:function(){null!=this.program&&e.gl.deleteProgram(this.program);this.program=e.gl.createProgram();this.compileShader(this.vertexShader);this.compileShader(this.fragmentShader);e.gl.attachShader(this.program,this.vertexShader.shader);e.gl.attachShader(this.program,this.fragmentShader.shader);for(var a=0,b=0,c=this.inputLayout;b<c.length;){var d=c[b];++b;var f=0;for(d=d.elements;f<d.length;){var h=d[f];++f;e.gl.bindAttribLocation(this.program,a,h.name);h.data==ba.Float4x4?
a+=4:++a}}e.gl.linkProgram(this.program);if(!e.gl.getProgramParameter(this.program,35714))throw new r("Could not link the shader program:\n"+e.gl.getProgramInfoLog(this.program));},set:function(){e.gl.useProgram(this.program);for(var a=0,b=this.textureValues.length;a<b;){var c=a++;e.gl.uniform1i(this.textureValues[c],c)}e.gl.colorMask(this.colorWriteMaskRed,this.colorWriteMaskGreen,this.colorWriteMaskBlue,this.colorWriteMaskAlpha)},compileShader:function(a){if(null==a.shader){for(var b=e.gl.createShader(a.type),
c=0!=e.gl.getShaderPrecisionFormat(35632,36338).precision,d=a.files,f=0,h=d.length;f<h;){var g=f++;if(e.gl2){if(0<=d[g].indexOf("-webgl2")||0<=d[g].indexOf("runtime-string")){e.gl.shaderSource(b,a.sources[g]);break}}else{if(!c&&(0<=d[g].indexOf("-relaxed")||0<=d[g].indexOf("runtime-string"))){e.gl.shaderSource(b,a.sources[g]);break}if(c&&(0>d[g].indexOf("-relaxed")||0<=d[g].indexOf("runtime-string"))){e.gl.shaderSource(b,a.sources[g]);break}}}e.gl.compileShader(b);if(!e.gl.getShaderParameter(b,35713))throw new r("Could not compile shader:\n"+
e.gl.getShaderInfoLog(b));a.shader=b}},getConstantLocation:function(a){for(var b=e.gl.getUniformLocation(this.program,a),c=5126,d=0,f=e.gl.getProgramParameter(this.program,35718);d<f;){var h=d++;h=e.gl.getActiveUniform(this.program,h);if(h.name==a||h.name==a+"[0]"){c=h.type;break}}return new hd(b,c)},getTextureUnit:function(a){var b=this.findTexture(a);if(0>b){var c=e.gl.getUniformLocation(this.program,a);b=this.textures.length;this.textureValues.push(c);this.textures.push(a)}return new Wb(b)},findTexture:function(a){for(var b=
0,c=this.textures.length;b<c;){var d=b++;if(this.textures[d]==a)return d}return-1},__class__:Sb});var ca=m["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:"Keep Zero Replace Increment IncrementWrap Decrement DecrementWrap Invert".split(" ")};ca.Keep=["Keep",0];ca.Keep.toString=w;ca.Keep.__enum__=ca;ca.Zero=["Zero",1];ca.Zero.toString=w;ca.Zero.__enum__=ca;ca.Replace=["Replace",2];ca.Replace.toString=w;ca.Replace.__enum__=ca;ca.Increment=["Increment",3];ca.Increment.toString=w;ca.Increment.__enum__=
ca;ca.IncrementWrap=["IncrementWrap",4];ca.IncrementWrap.toString=w;ca.IncrementWrap.__enum__=ca;ca.Decrement=["Decrement",5];ca.Decrement.toString=w;ca.Decrement.__enum__=ca;ca.DecrementWrap=["DecrementWrap",6];ca.DecrementWrap.toString=w;ca.DecrementWrap.__enum__=ca;ca.Invert=["Invert",7];ca.Invert.toString=w;ca.Invert.__enum__=ca;var Be=function(){};m["kha.graphics4.TessellationControlShader"]=Be;Be.__name__=!0;var Ce=function(){};m["kha.graphics4.TessellationEvaluationShader"]=Ce;Ce.__name__=
!0;var Ta=m["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"]};Ta.Repeat=["Repeat",0];Ta.Repeat.toString=w;Ta.Repeat.__enum__=Ta;Ta.Mirror=["Mirror",1];Ta.Mirror.toString=w;Ta.Mirror.__enum__=Ta;Ta.Clamp=["Clamp",2];Ta.Clamp.toString=w;Ta.Clamp.__enum__=Ta;var Aa=m["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"]};Aa.PointFilter=["PointFilter",0];Aa.PointFilter.toString=w;Aa.PointFilter.__enum__=
Aa;Aa.LinearFilter=["LinearFilter",1];Aa.LinearFilter.toString=w;Aa.LinearFilter.__enum__=Aa;Aa.AnisotropicFilter=["AnisotropicFilter",2];Aa.AnisotropicFilter.toString=w;Aa.AnisotropicFilter.__enum__=Aa;var U=m["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:"RGBA32 L8 RGBA128 DEPTH16 RGBA64 A32 A16".split(" ")};U.RGBA32=["RGBA32",0];U.RGBA32.toString=w;U.RGBA32.__enum__=U;U.L8=["L8",1];U.L8.toString=w;U.L8.__enum__=U;U.RGBA128=["RGBA128",2];U.RGBA128.toString=w;U.RGBA128.__enum__=U;U.DEPTH16=
["DEPTH16",3];U.DEPTH16.toString=w;U.DEPTH16.__enum__=U;U.RGBA64=["RGBA64",4];U.RGBA64.toString=w;U.RGBA64.__enum__=U;U.A32=["A32",5];U.A32.toString=w;U.A32.__enum__=U;U.A16=["A16",6];U.A16.toString=w;U.A16.__enum__=U;var ve=function(){};m["kha.graphics4.TextureUnit"]=ve;ve.__name__=!0;var ua=m["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"]};ua.StaticUsage=["StaticUsage",0];ua.StaticUsage.toString=w;ua.StaticUsage.__enum__=ua;ua.DynamicUsage=["DynamicUsage",
1];ua.DynamicUsage.toString=w;ua.DynamicUsage.__enum__=ua;ua.ReadableUsage=["ReadableUsage",2];ua.ReadableUsage.toString=w;ua.ReadableUsage.__enum__=ua;var Tb=function(a,b,c,d,f){null==d&&(d=0);this.usage=c;this.instanceDataStepRate=d;this.mySize=a;c=this.myStride=0;for(d=b.elements;c<d.length;)switch(f=d[c],++c,f.data[1]){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}this.buffer=e.gl.createBuffer();
this._data=new se(a*this.myStride/4|0);this.sizes=[];this.offsets=[];this.sizes[b.elements.length-1]=0;d=c=a=this.offsets[b.elements.length-1]=0;for(b=b.elements;d<b.length;){f=b[d];++d;switch(f.data[1]){case 0:var h=1;break;case 1:h=2;break;case 2:h=3;break;case 3:h=4;break;case 4:h=16}this.sizes[c]=h;this.offsets[c]=a;switch(f.data[1]){case 0:a+=4;break;case 1:a+=8;break;case 2:a+=12;break;case 3:a+=16;break;case 4:a+=64}++c}};m["kha.graphics4.VertexBuffer"]=Tb;Tb.__name__=!0;Tb.prototype={buffer:null,
_data:null,mySize:null,myStride:null,sizes:null,offsets:null,usage:null,instanceDataStepRate:null,lock:function(a,b){null==a&&(a=0);null==b&&(b=this.mySize);return this._data.subarray(a*this.stride(),(a+b)*this.stride())},unlock:function(){e.gl.bindBuffer(34962,this.buffer);e.gl.bufferData(34962,this._data,this.usage==ua.DynamicUsage?35048:35044)},stride:function(){return this.myStride},set:function(a){var b=e.gl2?!0:e.gl.getExtension("ANGLE_instanced_arrays");e.gl.bindBuffer(34962,this.buffer);for(var c=
0,d=0,f=this.sizes.length;d<f;){var h=d++;if(4<this.sizes[h])for(var g=this.sizes[h],l=0;0<g;)e.gl.enableVertexAttribArray(a+c),e.gl.vertexAttribPointer(a+c,4,5126,!1,this.myStride,this.offsets[h]+l),b&&(e.gl2?e.gl.vertexAttribDivisor(a+c,this.instanceDataStepRate):b.vertexAttribDivisorANGLE(a+c,this.instanceDataStepRate)),g-=4,l+=16,++c;else e.gl.enableVertexAttribArray(a+c),e.gl.vertexAttribPointer(a+c,this.sizes[h],5126,!1,this.myStride,this.offsets[h]),b&&(e.gl2?e.gl.vertexAttribDivisor(a+c,this.instanceDataStepRate):
b.vertexAttribDivisorANGLE(a+c,this.instanceDataStepRate)),++c}return c},__class__:Tb};var ba=m["kha.graphics4.VertexData"]={__ename__:!0,__constructs__:["Float1","Float2","Float3","Float4","Float4x4"]};ba.Float1=["Float1",0];ba.Float1.toString=w;ba.Float1.__enum__=ba;ba.Float2=["Float2",1];ba.Float2.toString=w;ba.Float2.__enum__=ba;ba.Float3=["Float3",2];ba.Float3.toString=w;ba.Float3.__enum__=ba;ba.Float4=["Float4",3];ba.Float4.toString=w;ba.Float4.__enum__=ba;ba.Float4x4=["Float4x4",4];ba.Float4x4.toString=
w;ba.Float4x4.__enum__=ba;var Lc=function(a,b){this.name=a;this.data=b};m["kha.graphics4.VertexElement"]=Lc;Lc.__name__=!0;Lc.prototype={name:null,data:null,__class__:Lc};var ec=function(a,b){this.sources=[];for(var c=0;c<a.length;){var d=a[c];++c;this.sources.push(d.toString())}this.type=35633;this.shader=null;this.files=b};m["kha.graphics4.VertexShader"]=ec;ec.__name__=!0;ec.prototype={sources:null,type:null,shader:null,files:null,__class__:ec};var Kc=function(){this.elements=[];this.instanced=
!1};m["kha.graphics4.VertexStructure"]=Kc;Kc.__name__=!0;Kc.prototype={elements:null,instanced:null,add:function(a,b){this.elements.push(new Lc(a,b))},size:function(){return this.elements.length},get:function(a){return this.elements[a]},__class__:Kc};var gc=tb.kha.input.Gamepad=function(a,b){null==a&&(a=0);this.index=a;this.axisListeners=[];this.buttonListeners=[];gc.instances[a]=this};m["kha.input.Gamepad"]=gc;gc.__name__=!0;gc.prototype={index:null,axisListeners:null,buttonListeners:null,sendAxisEvent:function(a,
b){for(var c=0,d=this.axisListeners;c<d.length;){var e=d[c];++c;e(a,b)}},sendButtonEvent:function(a,b){for(var c=0,d=this.buttonListeners;c<d.length;){var e=d[c];++c;e(a,b)}},__class__:gc};var bb=function(){this.__id=re.nextId++;this._inputBuffer=new ha(new pa(1))};m["kha.network.Controller"]=bb;bb.__name__=!0;bb.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:bb};var fc=tb.kha.input.Keyboard=function(){bb.call(this);this.downListeners=[];this.upListeners=
[];this.pressListeners=[];fc.instance=this};m["kha.input.Keyboard"]=fc;fc.__name__=!0;fc.__super__=bb;fc.prototype=na(bb.prototype,{downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(a){if(null!=ya.the()){var b=new ha(new pa(4));b.setInt32(0,0);ya.the().sendControllerUpdate(this._id(),b)}b=0;for(var c=this.downListeners;b<c.length;){var d=c[b];++b;d(a)}},sendUpEvent:function(a){if(null!=ya.the()){var b=new ha(new pa(4));b.setInt32(0,1);ya.the().sendControllerUpdate(this._id(),
b)}b=0;for(var c=this.upListeners;b<c.length;){var d=c[b];++b;d(a)}},sendPressEvent:function(a){if(null!=ya.the()){var b=new ha(new pa(5));b.setInt32(0,2);var c=G.cca(a,0);b.b[4]=c&255;ya.the().sendControllerUpdate(this._id(),b)}b=0;for(c=this.pressListeners;b<c.length;){var d=c[b];++b;d(a)}},__class__:fc});var fb=tb.kha.input.Mouse=function(){bb.call(this);fb.instance=this};m["kha.input.Mouse"]=fb;fb.__name__=!0;fb.get=function(a){null==a&&(a=0);return e.getMouse(a)};fb.__super__=bb;fb.prototype=
na(bb.prototype,{notify:function(a,b,c,d,e){this.notifyWindowed(0,a,b,c,d,e)},notifyWindowed:function(a,b,c,d,e,h){if(null!=b){null==this.windowDownListeners&&(this.windowDownListeners=[]);for(;this.windowDownListeners.length<=a;)this.windowDownListeners.push([]);this.windowDownListeners[a].push(b)}if(null!=c){null==this.windowUpListeners&&(this.windowUpListeners=[]);for(;this.windowUpListeners.length<=a;)this.windowUpListeners.push([]);this.windowUpListeners[a].push(c)}if(null!=d){null==this.windowMoveListeners&&
(this.windowMoveListeners=[]);for(;this.windowMoveListeners.length<=a;)this.windowMoveListeners.push([]);this.windowMoveListeners[a].push(d)}if(null!=e){null==this.windowWheelListeners&&(this.windowWheelListeners=[]);for(;this.windowWheelListeners.length<=a;)this.windowWheelListeners.push([]);this.windowWheelListeners[a].push(e)}if(null!=h){null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);for(;this.windowLeaveListeners.length<=a;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[a].push(h)}},
windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(a){if(null!=ya.the()){var b=new ha(new pa(8));b.setInt32(0,0);b.setInt32(4,a);ya.the().sendControllerUpdate(this._id(),b)}if(null!=this.windowLeaveListeners)for(b=0,a=this.windowLeaveListeners[a];b<a.length;){var c=a[b];++b;c()}},sendDownEvent:function(a,b,c,d){if(null!=ya.the()){var e=new ha(new pa(20));e.setInt32(0,1);e.setInt32(4,a);e.setInt32(8,b);
e.setInt32(12,c);e.setInt32(16,d);ya.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowDownListeners)for(e=0,a=this.windowDownListeners[a];e<a.length;){var h=a[e];++e;h(b,c,d)}},sendUpEvent:function(a,b,c,d){if(null!=ya.the()){var e=new ha(new pa(20));e.setInt32(0,2);e.setInt32(4,a);e.setInt32(8,b);e.setInt32(12,c);e.setInt32(16,d);ya.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowUpListeners)for(e=0,a=this.windowUpListeners[a];e<a.length;){var h=a[e];++e;h(b,c,d)}},sendMoveEvent:function(a,
b,c,d,e){if(null!=ya.the()){var f=new ha(new pa(24));f.setInt32(0,3);f.setInt32(4,a);f.setInt32(8,b);f.setInt32(12,c);f.setInt32(16,d);f.setInt32(20,e);ya.the().sendControllerUpdate(this._id(),f)}if(null!=this.windowMoveListeners)for(f=0,a=this.windowMoveListeners[a];f<a.length;){var g=a[f];++f;g(b,c,d,e)}},sendWheelEvent:function(a,b){if(null!=ya.the()){var c=new ha(new pa(12));c.setInt32(0,4);c.setInt32(4,a);c.setInt32(8,b);ya.the().sendControllerUpdate(this._id(),c)}if(null!=this.windowWheelListeners){c=
0;for(var d=this.windowWheelListeners[a];c<d.length;){var e=d[c];++c;e(b)}}},__class__:fb});var Wd=function(){fb.call(this)};m["kha.input.MouseImpl"]=Wd;Wd.__name__=!0;Wd.__super__=fb;Wd.prototype=na(fb.prototype,{__class__:Wd});var Xd=tb.kha.input.Surface=function(){this.touchStartListeners=[];this.touchEndListeners=[];this.moveListeners=[];Xd.instance=this};m["kha.input.Surface"]=Xd;Xd.__name__=!0;Xd.prototype={touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(a,
b,c){for(var d=0,e=this.touchStartListeners;d<e.length;){var h=e[d];++d;h(a,b,c)}},sendTouchEndEvent:function(a,b,c){for(var d=0,e=this.touchEndListeners;d<e.length;){var h=e[d];++d;h(a,b,c)}},sendMoveEvent:function(a,b,c){for(var d=0,e=this.moveListeners;d<e.length;){var h=e[d];++d;h(a,b,c)}},__class__:Xd};var P=function(a){this.bytes=a};m["kha.internal.BytesBlob"]=P;P.__name__=!0;P.__interfaces__=[Nb];P.fromBytes=function(a){return new P(a)};P.alloc=function(a){return new P(new ha(new pa(a)))};
P.readF32=function(a){var b=0==(a&-2147483648)?1:-1,c=a>>23&255;a&=8388607;switch(c){case 0:return 0;case 255:return 0!=a?NaN:0<b?Infinity:-Infinity;default:return(a+8388608)/8388608*b*Math.pow(2,c-127)}};P.bit=function(a,b){return 1==(a>>>b&1)?!0:!1};P.toText=function(a,b){for(var c="",d=0;d<b;){var e=d++;c+=String.fromCharCode(a[e])}return c};P.prototype={bytes:null,sub:function(a,b){return new P(this.bytes.sub(a,b))},length:null,get_length:function(){return this.bytes.length},writeU8:function(a,
b){this.bytes.b[a]=b&255},readU8:function(a){return this.bytes.b[a]},readS8:function(a){a=this.bytes.b[a];return(0==(a&128)?1:-1)*(a&127)},readU16BE:function(a){return 256*this.bytes.b[a]+this.bytes.b[a+1]},readU16LE:function(a){return 256*this.bytes.b[a+1]+this.bytes.b[a]},readU32LE:function(a){return this.bytes.b[a]+256*this.bytes.b[a+1]+65536*this.bytes.b[a+2]+16777216*this.bytes.b[a+3]},readU32BE:function(a){return this.bytes.b[a+3]+256*this.bytes.b[a+2]+65536*this.bytes.b[a+1]+16777216*this.bytes.b[a]},
readS16BE:function(a){var b=this.bytes.b[a];a=this.bytes.b[a+1];var c=0==(b&128)?1:-1;b&=127;return-1==c?-32767+256*b+a:256*b+a},readS16LE:function(a){var b=this.bytes.b[a];a=this.bytes.b[a+1];var c=0==(a&128)?1:-1;a&=127;return-1==c?-32767+256*a+b:256*a+b},readS32LE:function(a){var b=this.bytes.b[a],c=this.bytes.b[a+1],d=this.bytes.b[a+2];a=this.bytes.b[a+3];var e=0==(a&128)?1:-1;a&=127;return-1==e?-2147483647+b+256*c+65536*d+16777216*a:b+256*c+65536*d+16777216*a},readS32BE:function(a){var b=this.bytes.b[a],
c=this.bytes.b[a+1],d=this.bytes.b[a+2];a=this.bytes.b[a+3];var e=0==(b&128)?1:-1;b&=127;return-1==e?-2147483647+a+256*d+65536*c+16777216*b:a+256*d+65536*c+16777216*b},readF32LE:function(a){return P.readF32(this.readS32LE(a))},readF32BE:function(a){return P.readF32(this.readS32BE(a))},toString:function(){return this.bytes.toString()},readUtf8Char:function(a){if(a.value>=this.get_length())return-1;var b=this.readU8(a.value);++a.value;var c=0;P.bit(b,7)?P.bit(b,7)&&P.bit(b,6)&&!P.bit(b,5)?(b&=31,c=
this.readU8(a.value),++a.value,c=b<<6|c&63):P.bit(b,7)&&P.bit(b,6)&&P.bit(b,5)&&!P.bit(b,4)?a.value+=2:P.bit(b,7)&&P.bit(b,6)&&P.bit(b,5)&&P.bit(b,4)&&!P.bit(b,3)&&(a.value+=3):c=b;return c},readUtf8Block:function(a,b){var c=0;if(b.value>=this.get_length())return"";for(;2E3>c;){var d=this.readUtf8Char(b);if(0>d)break;a[c]=d;++c}return P.toText(a,c)},readUtf8String:function(){var a=Array(2E3),b="",c=0;3<=this.get_length()&&239==this.bytes.b[0]&&187==this.bytes.b[1]&&191==this.bytes.b[2]&&(c=3);for(c=
{value:c};c.value<this.get_length();)b+=this.readUtf8Block(a,c);return b},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:P};var K=function(){};m["kha.internal.HdrFormat"]=K;K.__name__=!0;K.readBuf=function(a){for(var b=0;a[b++]=K.buffer[K.fileOffset]&255,++K.fileOffset<K.bufferLength&&b<a.length;);return b};K.readBufOffset=function(a,b,c){for(var d=0;a[b+d++]=K.buffer[K.fileOffset]&255,++K.fileOffset<K.bufferLength&&d<c;);return d};K.readPixelsRaw=function(a,b,
c,d){a=4*d;b=K.readBufOffset(b,c,a);b<a&&T.trace("Error reading raw pixels: got "+b+" bytes, expected "+a,{fileName:"HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})};K.readPixelsRawRLE=function(a,b,c,d,e){for(var f=new la(4),g=null,l,k,m,n=new la(2);0<e;){if(K.readBuf(f)<f.length){T.trace("Error reading bytes: expected "+f.length,{fileName:"HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});break}if(2!=f[0]||2!=
f[1]||0!=(f[2]&128)){b[c++]=f[0]&255;b[c++]=f[1]&255;b[c++]=f[2]&255;b[c++]=f[3]&255;K.readPixelsRaw(a,b,c,d*e-1);break}if(((f[2]&255)<<8|f[3]&255)!=d){T.trace("Wrong scanline width "+((f[2]&255)<<8|f[3]&255)+", expected "+d,{fileName:"HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});break}null==g&&(g=new la(4*d));for(var p=l=0;4>p;)for(k=(p++ +1)*d;l<k;){if(K.readBuf(n)<n.length){T.trace("Error reading 2-byte buffer",{fileName:"HdrFormat.hx",lineNumber:88,
className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});return}if(128<(n[0]&255)){m=(n[0]&255)-128;if(0==m||m>k-l){T.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});return}for(;0<m--;)g[l++]=n[1]&255}else{m=n[0]&255;if(0==m||m>k-l){T.trace("Bad scanline data",{fileName:"HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});return}g[l++]=n[1]&255;if(0<--m){if(K.readBufOffset(g,
l,m)<m){T.trace("Error reading non-run data",{fileName:"HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});return}l+=m}}}l=0;for(k=d;l<k;)m=l++,b[c]=g[m]&255,b[c+1]=g[m+d]&255,b[c+2]=g[m+2*d]&255,b[c+3]=g[m+3*d]&255,c+=4;--e}};K.readLine=function(){for(var a="";;){var b=K.buffer[K.fileOffset];if(10==b){++K.fileOffset;break}a+=String.fromCharCode(b);if(!(++K.fileOffset<K.bufferLength))break}return a};K.parse=function(a){K.buffer=ne.fromBytes(a);K.bufferLength=
K.buffer.length;for(var b=a=K.fileOffset=0,c=!1,d=0;20>d;){d++;var e=K.readLine();if(K.formatPattern.match(e))c=!0;else if(K.exposurePattern.match(e))parseFloat(K.exposurePattern.matched(1));else if(K.widthHeightPattern.match(e)){b=Ga.parseInt(K.widthHeightPattern.matched(1));a=Ga.parseInt(K.widthHeightPattern.matched(2));break}}if(!c)return T.trace("File is not run length encoded!",{fileName:"HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;c=new la(a*b*4);
K.readPixelsRawRLE(K.buffer,c,0,a,b);d=new se(a*b*4);for(e=0;e<c.length;){var h=c[e]/255,g=c[e+1]/255,l=c[e+2]/255,k=Math.pow(2,c[e+3]-128);h*=k;g*=k;l*=k;d[e]=h;d[e+1]=g;d[e+2]=l;d[e+3]=1;e+=4}return{width:a,height:b,data:d}};var Mc=function(a){this.stopped=!1;this.element=a};m["kha.js.AEAudioChannel"]=Mc;Mc.__name__=!0;Mc.__interfaces__=[jc];Mc.prototype={element:null,stopped:null,play:function(){this.stopped=!1;e.mobile?e.insideInputEvent?(this.element.play(),e.mobileAudioPlaying=!0):e.mobileAudioPlaying?
this.element.play():Mc.todo.push(this):this.element.play()},__class__:Mc};var hc=function(){};m["kha.js.AudioElementAudio"]=hc;hc.__name__=!0;hc._compile=function(){};hc.play=function(a,b){null==b&&(b=!1);return hc.stream(a,b)};hc.stream=function(a,b){null==b&&(b=!1);a.element.loop=b;var c=new Mc(a.element);c.play();return c};var ud=function(a){ib.call(this);this.canvas=a;ud.instance=this;this.myColor=bc.fromBytes(0,0,0);a.save()};m["kha.js.CanvasGraphics"]=ud;ud.__name__=!0;ud.__super__=ib;ud.prototype=
na(ib.prototype,{canvas:null,webfont:null,myColor:null,begin:function(a,b){null==a&&(a=!0);a&&this.clear(b)},clear:function(a){null==a&&(a=0);this.canvas.strokeStyle="rgba("+((a&16711680)>>>16)+","+((a&65280)>>>8)+","+(a&255)+","+.00392156862745098*(a>>>24)+")";this.canvas.fillStyle="rgba("+((a&16711680)>>>16)+","+((a&65280)>>>8)+","+(a&255)+","+.00392156862745098*(a>>>24)+")";0==.00392156862745098*(a>>>24)?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,
0,this.canvas.canvas.width,this.canvas.canvas.height);this.set_color(this.myColor)},end:function(){},set_color:function(a){this.myColor=a;this.canvas.strokeStyle="rgba("+((a&16711680)>>>16)+","+((a&65280)>>>8)+","+(a&255)+","+.00392156862745098*(a>>>24)+")";this.canvas.fillStyle="rgba("+((a&16711680)>>>16)+","+((a&65280)>>>8)+","+(a&255)+","+.00392156862745098*(a>>>24)+")";return a},drawRect:function(a,b,c,d,e){null==e&&(e=1);this.canvas.beginPath();var f=this.canvas.lineWidth;this.canvas.lineWidth=
Math.round(e);this.canvas.rect(a,b,c,d);this.canvas.stroke();this.canvas.lineWidth=f},fillRect:function(a,b,c,d){var e=this.get_opacity();this.canvas.globalAlpha=.00392156862745098*e*(this.myColor>>>24);this.canvas.fillRect(a,b,c,d);this.canvas.globalAlpha=this.get_opacity()},drawString:function(a,b,c){var d=this.webfont.getImage(this.get_fontSize(),this.myColor,this.get_fontGlyphs());if(0<d.width)for(var e=0,h=a.length;e<h;){var g=e++;g=null!=this.get_fontGlyphs()?this.webfont.kravur._get(this.get_fontSize(),
this.get_fontGlyphs()).getBakedQuad(this.get_fontGlyphs().indexOf(G.cca(a,g)),b,c):this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(G.cca(a,g)-32,b,c);null!=g&&(0<g.s1-g.s0&&0<g.t1-g.t0&&0<g.x1-g.x0&&0<g.y1-g.y0&&this.canvas.drawImage(d,g.s0*d.width,g.t0*d.height,(g.s1-g.s0)*d.width,(g.t1-g.t0)*d.height,g.x0,g.y0,g.x1-g.x0,g.y1-g.y0),b+=g.xadvance)}},set_font:function(a){return this.webfont=E.__cast(a,Qb)},drawLine:function(a,b,c,d,e){null==e&&(e=1);this.canvas.beginPath();var f=this.canvas.lineWidth;
this.canvas.lineWidth=Math.round(e);this.canvas.moveTo(a,b);this.canvas.lineTo(c,d);this.canvas.moveTo(0,0);this.canvas.stroke();this.canvas.lineWidth=f},scissor:function(a,b,c,d){this.canvas.beginPath();this.canvas.rect(a,b,c,d);this.canvas.clip()},__class__:ud});var Zc=function(){};m["kha.js.EnvironmentVariables"]=Zc;Zc.__name__=!0;Zc.__super__=Vc;Zc.prototype=na(Vc.prototype,{__class__:Zc});var Qb=function(a){this.images=new Cb;this.kravur=new Ob(a)};m["kha.js.Font"]=Qb;Qb.__name__=!0;Qb.__interfaces__=
[Nb];Qb.fromBytes=function(a){return new Qb(P.fromBytes(a))};Qb.prototype={kravur:null,images:null,height:function(a){return this.kravur._get(a).getHeight()},width:function(a,b){return this.kravur._get(a).stringWidth(b)},widthOfCharacters:function(a,b,c,d){return this.kravur._get(a).charactersWidth(b,c,d)},baseline:function(a){return this.kravur._get(a).getBaselinePosition()},getImage:function(a,b,c){var d=null==c?a:1E4*a+c.length;if(!this.images.h.hasOwnProperty(d)){var e=this.images,h=new Cb;e.h[d]=
h}if(!this.images.h[d].h.hasOwnProperty(b)){h=this.kravur._get(a,c);a=window.document.createElement("canvas");a.width=h.width;a.height=h.height;c=a.getContext("2d");c.fillStyle="black";c.fillRect(0,0,h.width,h.height);e=c.getImageData(0,0,h.width,h.height);h=E.__cast(h.getTexture(),eb).bytes;for(var g=0,l=h.length;g<l;){var k=g++;e.data[4*k]=(b&16711680)>>>16;e.data[4*k+1]=(b&65280)>>>8;e.data[4*k+2]=b&255;e.data[4*k+3]=h.b[k]}c.putImageData(e,0,0);c=window.document.createElement("img");c.src=a.toDataURL("image/png");
return this.images.h[d].h[b]=c}return this.images.h[d].h[b]},unload:function(){this.images=this.kravur=null},__class__:Qb};var Ja=function(){};m["kha.js.MobileWebAudio"]=Ja;Ja.__name__=!0;Ja._init=function(){try{Ja._context=new AudioContext;return}catch(a){}try{this._context=new webkitAudioContext}catch(a){}};Ja.play=function(a,b){null==b&&(b=!1);var c=new Dd(a,b);c.play();return c};Ja.stream=function(a,b){null==b&&(b=!1);return Ja.play(a,b)};var Dd=function(a,b){this.paused=this.stopped=!1;this.buffer=
a._buffer;this.loop=b;this.createSource()};m["kha.js.MobileWebAudioChannel"]=Dd;Dd.__name__=!0;Dd.__interfaces__=[jc];Dd.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var a=this;this.source=Ja._context.createBufferSource();this.source.loop=this.loop;this.source.buffer=this.buffer;this.source.onended=function(){a.stopped=!0};this.gain=Ja._context.createGain();this.source.connect(this.gain);this.gain.connect(Ja._context.destination)},
play:function(){(this.paused||this.stopped)&&this.createSource();this.stopped=!1;this.paused?(this.paused=!1,this.startTime=Ja._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=Ja._context.currentTime,this.source.start())},__class__:Dd};var Xc=function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onerror=function(){T.trace("Error loading "+a,{fileName:"MobileWebAudioSound.hx",lineNumber:25,className:"kha.js.MobileWebAudioSound",
methodName:"new"})};d.onload=function(){c.compressedData=ha.ofData(d.response);c.uncompressedData=null;Ja._context.decodeAudioData(c.compressedData.b.bufferValue,function(a){c._buffer=a;b(c)},function(){throw new r("Audio format not supported");})};d.send(null)};m["kha.js.MobileWebAudioSound"]=Xc;Xc.__name__=!0;Xc.__super__=Ha;Xc.prototype=na(Ha.prototype,{_buffer:null,uncompress:function(a){a()},__class__:Xc});var Pb=function(a,b){this.done=b;Pb.loading.push(this);this.element=window.document.createElement("audio");
this.filenames=[];for(var c=0;c<a.length;){var d=a[c];++c;""!=this.element.canPlayType("audio/ogg")&&oa.endsWith(d,".ogg")&&this.filenames.push(d);""!=this.element.canPlayType("audio/mp4")&&oa.endsWith(d,".mp4")&&this.filenames.push(d)}this.element.addEventListener("error",wb(this,this.errorListener),!1);this.element.addEventListener("canplay",wb(this,this.canPlayThroughListener),!1);this.element.src=this.filenames[0];this.element.preload="auto";this.element.load()};m["kha.js.Sound"]=Pb;Pb.__name__=
!0;Pb.__super__=Ha;Pb.prototype=na(Ha.prototype,{filenames:null,done:null,element:null,errorListener:function(a){if(4==this.element.error.code){a=0;for(var b=this.filenames.length-1;a<b;){var c=a++;if(this.element.src==this.filenames[c]){this.element.src=this.filenames[c+1];return}}}T.trace("Error loading "+this.element.src,{fileName:"Sound.hx",lineNumber:108,className:"kha.js.Sound",methodName:"errorListener"});window.console.log("loadSound failed");this.finishAsset()},canPlayThroughListener:function(a){this.finishAsset()},
finishAsset:function(){this.element.removeEventListener("error",wb(this,this.errorListener),!1);this.element.removeEventListener("canplaythrough",wb(this,this.canPlayThroughListener),!1);this.done(this);G.remove(Pb.loading,this)},uncompress:function(a){a()},__class__:Pb});var dc=function(){};m["kha.js.Video"]=dc;dc.__name__=!0;dc.fromFile=function(a,b){var c=new dc;c.done=b;c.element=window.document.createElement("video");c.filenames=[];for(var d=0;d<a.length;){var e=a[d];++d;""!=c.element.canPlayType("video/webm")&&
oa.endsWith(e,".webm")&&c.filenames.push(e);""!=c.element.canPlayType("video/mp4")&&oa.endsWith(e,".mp4")&&c.filenames.push(e)}c.element.addEventListener("error",wb(c,c.errorListener),!1);c.element.addEventListener("canplaythrough",wb(c,c.canPlayThroughListener),!1);c.element.preload="auto";c.element.src=c.filenames[0]};dc.__super__=$c;dc.prototype=na($c.prototype,{filenames:null,element:null,done:null,texture:null,errorListener:function(a){if(4==this.element.error.code){a=0;for(var b=this.filenames.length-
1;a<b;){var c=a++;if(this.element.src==this.filenames[c]){this.element.src=this.filenames[c+1];return}}}T.trace("Error loading "+this.element.src,{fileName:"Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"});this.finishAsset()},canPlayThroughListener:function(a){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",wb(this,this.errorListener),!1);this.element.removeEventListener("canplaythrough",wb(this,this.canPlayThroughListener),!1);null!=
e.gl&&(this.texture=qa.fromVideo(this));this.done(this)},__class__:dc});var sd=function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onerror=function(){T.trace("Error loading "+a,{fileName:"WebAudioSound.hx",lineNumber:76,className:"kha.js.WebAudioSound",methodName:"new"})};d.onload=function(){c.compressedData=ha.ofData(d.response);c.uncompressedData=null;b(c)};d.send(null)};m["kha.js.WebAudioSound"]=sd;sd.__name__=!0;sd.__super__=Ha;sd.prototype=na(Ha.prototype,
{superUncompress:function(a){Ha.prototype.uncompress.call(this,a)},uncompress:function(a){var b=this;R._context.decodeAudioData(this.compressedData.b.bufferValue,function(c){var d=2*c.getChannelData(0).length;b.uncompressedData=Array(d);if(1==c.numberOfChannels){d=0;for(var e=c.getChannelData(0).length;d<e;){var h=d++;b.uncompressedData[2*h]=c.getChannelData(0)[h];b.uncompressedData[2*h+1]=c.getChannelData(0)[h]}}else for(d=0,e=c.getChannelData(0).length;d<e;)h=d++,b.uncompressedData[2*h]=c.getChannelData(0)[h],
b.uncompressedData[2*h+1]=c.getChannelData(1)[h];b.compressedData=null;a()},function(){b.superUncompress(a)})},__class__:sd});var hd=function(a,b){this.value=a;this.type=b};m["kha.js.graphics4.ConstantLocation"]=hd;hd.__name__=!0;hd.__interfaces__=[ue];hd.prototype={value:null,type:null,__class__:hd};var ka=function(a){this.matrixCache=Array(16);this.isCubeMap=this.isDepthAttachment=!1;this.colorMaskRed=this.colorMaskGreen=this.colorMaskBlue=this.colorMaskAlpha=!0;this.depthTest=this.depthMask=!1;
this.renderTarget=a;this.init();e.gl2?this.instancedExtension=!0:(this.instancedExtension=e.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=e.gl.getExtension("EXT_blend_minmax"))};m["kha.js.graphics4.Graphics"]=ka;ka.__name__=!0;ka.__interfaces__=[Jc];ka.getBlendFunc=function(a){switch(a[1]){case 0:case 2:return 0;case 1:return 1;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}};ka.getBlendOp=
function(a){switch(a[1]){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}};ka.prototype={depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=E.__instanceof(this.renderTarget,
wa)){var a=E.__cast(this.renderTarget,wa);this.renderTargetFrameBuffer=a.frameBuffer;this.renderTargetTexture=a.texture;this.isDepthAttachment=a.isDepthAttachment}else a=E.__cast(this.renderTarget,Ca),this.renderTargetFrameBuffer=a.frameBuffer,this.renderTargetTexture=a.texture},begin:function(a){e.gl.enable(3042);e.gl.blendFunc(770,771);if(null==this.renderTarget)e.gl.bindFramebuffer(36160,null),e.gl.viewport(0,0,L.windowWidth(),L.windowHeight());else if(e.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),
e.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=a){e.gl.framebufferTexture2D(36160,e.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var b=0,c=a.length;b<c;){var d=b++;e.gl.framebufferTexture2D(36160,e.drawBuffers.COLOR_ATTACHMENT0_WEBGL+d+1,3553,E.__cast(a[d],Ca).texture,0)}b=[e.drawBuffers.COLOR_ATTACHMENT0_WEBGL];c=0;for(a=a.length;c<a;)d=c++,b.push(e.drawBuffers.COLOR_ATTACHMENT0_WEBGL+d+1);e.gl2?e.gl.drawBuffers(b):e.drawBuffers.drawBuffersWEBGL(b)}},
end:function(){switch(e.gl.getError()){case 0:break;case 1280:T.trace("WebGL error: Invalid enum",{fileName:"Graphics.hx",lineNumber:130,className:"kha.js.graphics4.Graphics",methodName:"end"});break;case 1281:T.trace("WebGL error: Invalid value",{fileName:"Graphics.hx",lineNumber:132,className:"kha.js.graphics4.Graphics",methodName:"end"});break;case 1282:T.trace("WebGL error: Invalid operation",{fileName:"Graphics.hx",lineNumber:134,className:"kha.js.graphics4.Graphics",methodName:"end"});break;
case 1285:T.trace("WebGL error: Out of memory",{fileName:"Graphics.hx",lineNumber:138,className:"kha.js.graphics4.Graphics",methodName:"end"});break;case 1286:T.trace("WebGL error: Invalid framebuffer operation",{fileName:"Graphics.hx",lineNumber:136,className:"kha.js.graphics4.Graphics",methodName:"end"});break;case 37442:T.trace("WebGL error: Context lost",{fileName:"Graphics.hx",lineNumber:140,className:"kha.js.graphics4.Graphics",methodName:"end"});break;default:T.trace("Unknown WebGL error",
{fileName:"Graphics.hx",lineNumber:142,className:"kha.js.graphics4.Graphics",methodName:"end"})}},clear:function(a,b,c){var d=0;null!=a&&(d|=16384,e.gl.colorMask(!0,!0,!0,!0),e.gl.clearColor(.00392156862745098*((a&16711680)>>>16),.00392156862745098*((a&65280)>>>8),.00392156862745098*(a&255),.00392156862745098*(a>>>24)));null!=b&&(d|=256,e.gl.enable(2929),e.gl.depthMask(!0),e.gl.clearDepth(b));null!=c&&(d|=1024,e.gl.enable(2960),e.gl.stencilMask(255),e.gl.clearStencil(c));e.gl.clear(d);e.gl.colorMask(this.colorMaskRed,
this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha);this.depthTest?e.gl.enable(2929):e.gl.disable(2929);e.gl.depthMask(this.depthMask)},setDepthMode:function(a,b){switch(b[1]){case 0:a?e.gl.enable(2929):e.gl.disable(2929);this.depthTest=a;e.gl.depthFunc(519);break;case 1:e.gl.enable(2929);this.depthTest=!0;e.gl.depthFunc(512);break;case 2:e.gl.enable(2929);this.depthTest=!0;e.gl.depthFunc(514);break;case 3:e.gl.enable(2929);this.depthTest=!0;e.gl.depthFunc(517);break;case 4:e.gl.enable(2929);
this.depthTest=!0;e.gl.depthFunc(513);break;case 5:e.gl.enable(2929);this.depthTest=!0;e.gl.depthFunc(515);break;case 6:e.gl.enable(2929);this.depthTest=!0;e.gl.depthFunc(516);break;case 7:e.gl.enable(2929),this.depthTest=!0,e.gl.depthFunc(518)}e.gl.depthMask(a);this.depthMask=a},setBlendingMode:function(a,b,c,d,f,h){a==F.BlendOne&&b==F.BlendZero?e.gl.disable(3042):(e.gl.enable(3042),e.gl.blendFuncSeparate(ka.getBlendFunc(a),ka.getBlendFunc(b),ka.getBlendFunc(d),ka.getBlendFunc(f)),e.gl.blendEquationSeparate(ka.getBlendOp(c),
ka.getBlendOp(h)))},setVertexBuffer:function(a){E.__cast(a,Tb).set(0)},setIndexBuffer:function(a){this.indicesCount=a.count();E.__cast(a,Ub).set()},setTexture:function(a,b){null==b?(e.gl.activeTexture(33984+E.__cast(a,Wb).value),e.gl.bindTexture(3553,null)):E.__cast(b,Ca).set(E.__cast(a,Wb).value)},setTextureParameters:function(a,b,c,d,f,h){e.gl.activeTexture(33984+E.__cast(a,Wb).value);switch(b[1]){case 0:e.gl.texParameteri(3553,10242,10497);break;case 1:e.gl.texParameteri(3553,10242,33648);break;
case 2:e.gl.texParameteri(3553,10242,33071)}switch(c[1]){case 0:e.gl.texParameteri(3553,10243,10497);break;case 1:e.gl.texParameteri(3553,10243,33648);break;case 2:e.gl.texParameteri(3553,10243,33071)}switch(d[1]){case 0:switch(h[1]){case 0:e.gl.texParameteri(3553,10241,9728);break;case 1:e.gl.texParameteri(3553,10241,9984);break;case 2:e.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(h[1]){case 0:e.gl.texParameteri(3553,10241,9729);break;case 1:e.gl.texParameteri(3553,10241,9985);break;
case 2:e.gl.texParameteri(3553,10241,9987)}d==Aa.AnisotropicFilter&&e.gl.texParameteri(3553,e.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(f[1]){case 0:e.gl.texParameteri(3553,10240,9728);break;case 1:case 2:e.gl.texParameteri(3553,10240,9729)}},setCullMode:function(a){switch(a[1]){case 0:e.gl.enable(2884);e.gl.cullFace(1029);break;case 1:e.gl.enable(2884);e.gl.cullFace(1028);break;case 2:e.gl.disable(2884)}},setPipeline:function(a){this.setCullMode(a.cullMode);this.setDepthMode(a.depthWrite,
a.depthMode);this.setStencilParameters(a.stencilMode,a.stencilBothPass,a.stencilDepthFail,a.stencilFail,a.stencilReferenceValue,a.stencilReadMask,a.stencilWriteMask);this.setBlendingMode(a.blendSource,a.blendDestination,a.blendOperation,a.alphaBlendSource,a.alphaBlendDestination,a.alphaBlendOperation);a.set();this.colorMaskRed=a.colorWriteMaskRed;this.colorMaskGreen=a.colorWriteMaskGreen;this.colorMaskBlue=a.colorWriteMaskBlue;this.colorMaskAlpha=a.colorWriteMaskAlpha},matrixCache:null,setMatrix:function(a,
b){this.matrixCache[0]=b._00;this.matrixCache[1]=b._01;this.matrixCache[2]=b._02;this.matrixCache[3]=b._03;this.matrixCache[4]=b._10;this.matrixCache[5]=b._11;this.matrixCache[6]=b._12;this.matrixCache[7]=b._13;this.matrixCache[8]=b._20;this.matrixCache[9]=b._21;this.matrixCache[10]=b._22;this.matrixCache[11]=b._23;this.matrixCache[12]=b._30;this.matrixCache[13]=b._31;this.matrixCache[14]=b._32;this.matrixCache[15]=b._33;e.gl.uniformMatrix4fv(E.__cast(a,hd).value,!1,this.matrixCache)},drawIndexedVertices:function(a,
b){null==b&&(b=-1);null==a&&(a=0);var c=null==e.elementIndexUint?5123:5125;e.gl.drawElements(4,-1==b?this.indicesCount:b,c,a*(5123==c?2:4))},convertStencilAction:function(a){switch(a[1]){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},setStencilParameters:function(a,b,c,d,f,h,g){null==g&&(g=255);null==h&&(h=255);if(a==aa.Always&&b==ca.Keep&&c==ca.Keep&&d==ca.Keep)e.gl.disable(2960);else{e.gl.enable(2960);
var l=0;switch(a[1]){case 0:l=519;break;case 1:l=512;break;case 2:l=514;break;case 3:l=517;break;case 4:l=513;break;case 5:l=515;break;case 6:l=516;break;case 7:l=518}e.gl.stencilMask(g);e.gl.stencilOp(this.convertStencilAction(d),this.convertStencilAction(c),this.convertStencilAction(b));e.gl.stencilFunc(l,f,h)}},scissor:function(a,b,c,d){e.gl.enable(3089);null==this.renderTarget?e.gl.scissor(a,L.windowHeight(0)-b-d,c,d):e.gl.scissor(a,b,c,d)},renderTargetsInvertedY:function(){return!0},__class__:ka};
var Yd=function(a){Ia.call(this,a)};m["kha.js.graphics4.Graphics2"]=Yd;Yd.__name__=!0;Yd.__super__=Ia;Yd.prototype=na(Ia.prototype,{begin:function(a,b){null==a&&(a=!0);e.gl.colorMask(!0,!0,!0,!0);e.gl.disable(2929);e.gl.depthFunc(519);Ia.prototype.begin.call(this,a,b)},__class__:Yd});var Wb=function(a){this.value=a};m["kha.js.graphics4.TextureUnit"]=Wb;Wb.__name__=!0;Wb.__interfaces__=[ve];Wb.prototype={value:null,__class__:Wb};var ic=function(){};m["kha.vr.VrInterface"]=ic;ic.__name__=!0;ic.prototype=
{IsVrEnabled:function(){return!1},__class__:ic};var vd=function(){this.width=this.height=this.vrWidth=this.vrHeight=0;this.vrEnabled=!1;navigator.getVRDisplays&&(this.vrEnabled=!0,this.getVRDisplays(),T.trace("Display enabled.",{fileName:"VrInterface.hx",lineNumber:36,className:"kha.js.vr.VrInterface",methodName:"new"}))};m["kha.js.vr.VrInterface"]=vd;vd.__name__=!0;vd.__super__=ic;vd.prototype=na(ic.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,
getVRDisplays:function(){var a=this;navigator.getVRDisplays().then(function(b){if(0<b.length){a.frameData=new VRFrameData;a.vrDisplay=b[0];a.vrDisplay.depthNear=.1;a.vrDisplay.depthFar=1024;b=a.vrDisplay.getEyeParameters("left");var c=a.vrDisplay.getEyeParameters("right");a.width=e.khanvas.width;a.height=e.khanvas.height;a.vrWidth=2*Math.max(b.renderWidth,c.renderWidth)|0;a.vrHeight=Math.max(b.renderHeight,c.renderHeight)|0}else T.trace("There are no VR displays connected.",{fileName:"VrInterface.hx",
lineNumber:56,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:vd});var yc=function(a,b,c,d,e,h,g,l,k){this._00=a;this._10=b;this._20=c;this._01=d;this._11=e;this._21=h;this._02=g;this._12=l;this._22=k};m["kha.math.FastMatrix3"]=yc;yc.__name__=!0;yc.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:yc};var Vb=function(a,b,c,d,e,h,g,l,k,m,n,p,q,r,t,u){this._00=a;this._10=b;this._20=
c;this._30=d;this._01=e;this._11=h;this._21=g;this._31=l;this._02=k;this._12=m;this._22=n;this._32=p;this._03=q;this._13=r;this._23=t;this._33=u};m["kha.math.FastMatrix4"]=Vb;Vb.__name__=!0;Vb.orthogonalProjection=function(a,b,c,d,e,h){return new Vb(2/(b-a),0,0,-(b+a)/(b-a),0,2/(d-c),0,-(d+c)/(d-c),0,0,-2/(h-e),-(h+e)/(h-e),0,0,0,1)};Vb.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:Vb};
var J=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};m["kha.math.FastVector2"]=J;J.__name__=!0;J.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(a){var b=this.get_length();if(0==b)return 0;b=a/b;this.x*=b;this.y*=b;return a},__class__:J};var re=function(){};m["kha.network.ControllerBuilder"]=re;re.__name__=!0;var ya=function(){this.controllers=new Cb};m["kha.network.Session"]=ya;ya.__name__=!0;ya.the=function(){return ya.instance};
ya.prototype={controllers:null,sendControllerUpdate:function(a,b){if(this.controllers.h.hasOwnProperty(a)){if(this.controllers.h[a]._inputBuffer.length<this.controllers.h[a]._inputBufferIndex+4+b.length){var c=new ha(new pa(this.controllers.h[a]._inputBufferIndex+4+b.length));c.blit(0,this.controllers.h[a]._inputBuffer,0,this.controllers.h[a]._inputBufferIndex);this.controllers.h[a]._inputBuffer=c}this.controllers.h[a]._inputBuffer.setInt32(this.controllers.h[a]._inputBufferIndex,b.length);this.controllers.h[a]._inputBuffer.blit(this.controllers.h[a]._inputBufferIndex+
4,b,0,b.length);this.controllers.h[a]._inputBufferIndex+=4+b.length}},__class__:ya};var wd,De=0;m.Math=Math;String.prototype.__class__=m.String=String;String.__name__=!0;m.Array=Array;Array.__name__=!0;Date.prototype.__class__=m.Date=Date;Date.__name__=["Date"];var Fe=m.Int={__name__:["Int"]},Ee=m.Dynamic={__name__:["Dynamic"]},ye=m.Float=Number;ye.__name__=["Float"];var xe=m.Bool=Boolean;xe.__ename__=["Bool"];var Ge=m.Class={__name__:["Class"]},He={},pb={},pa=Ed.ArrayBuffer||Ra;null==pa.prototype.slice&&
(pa.prototype.slice=Ra.sliceImpl);var we=Ed.DataView||Qd,se=Ed.Float32Array||Eb._new,la=Ed.Uint8Array||rb._new;Y.DEFAULT_RESOLVER=new md;Y.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";Yb.count=0;Qa.i64tmp=new ge(0,0);E.__toStr={}.toString;Eb.BYTES_PER_ELEMENT=4;rb.BYTES_PER_ELEMENT=1;C.images=new Rc;C.sounds=new Sc;C.blobs=new Tc;C.fonts=new Uc;C.videos=new rd;pe.canvas_id="khanvas";n.DIF_COUNT=3;n.maxframetime=.5;n.startTime=0;A.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg";
A.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK";A.painter_colored_fragData2="s210:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7CgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IGZyYWdtZW50Q29sb3I7Cn0KCg";A.painter_colored_vertData0=
"s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo";A.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg";
A.painter_colored_vertData2="s354:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg";A.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo";
A.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK";A.painter_image_fragData2=
"s452:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCmluIHZlYzIgdGV4Q29vcmQ7CmluIHZlYzQgY29sb3I7Cm91dCB2ZWM0IEZyYWdDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBGcmFnQ29sb3IgPSB0ZXhjb2xvcjsKfQoK";A.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo";
A.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo";
A.painter_image_vertData2="s444:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgY29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK";A.painter_text_fragData0=
"s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo";A.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK";
A.painter_text_fragData2="s348:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCm91dCB2ZWM0IEZyYWdDb2xvcjsKaW4gdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWMyIHRleENvb3JkOwoKdm9pZCBtYWluKCkKewogICAgRnJhZ0NvbG9yID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZSh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK";A.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK";
A.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK";
A.painter_text_vertData2="s466:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKaW4gbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg";A.painter_video_fragData0=
"s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo";A.painter_video_fragData1=
"s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK";A.painter_video_fragData2="s452:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCmluIHZlYzIgdGV4Q29vcmQ7CmluIHZlYzQgY29sb3I7Cm91dCB2ZWM0IEZyYWdDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBGcmFnQ29sb3IgPSB0ZXhjb2xvcjsKfQoK";
A.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo";A.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo";
A.painter_video_vertData2="s444:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKaW4gbWVkaXVtcCB2ZWMzIHZlcnRleFBvc2l0aW9uOwpvdXQgbWVkaXVtcCB2ZWMyIHRleENvb3JkOwppbiBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247Cm91dCBtZWRpdW1wIHZlYzQgY29sb3I7CmluIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK";L.renderListeners=[];L.foregroundListeners=
[];L.backgroundListeners=[];e.mobile=!1;e.mobileAudioPlaying=!1;e.chrome=!1;e.firefox=!1;e.insideInputEvent=!1;e.leftMouseCtrlDown=!1;e.minimumScroll=999;e.lastFirstTouchX=0;e.lastFirstTouchY=0;e.iosSoundEnabled=!1;Rb.INVALID_BITS=-1;I.INVERSE_DB_TABLE=[1.0649863E-7,1.1341951E-7,1.2079015E-7,1.2863978E-7,1.3699951E-7,1.4590251E-7,1.5538408E-7,1.6548181E-7,1.7623575E-7,1.8768855E-7,1.9988561E-7,2.128753E-7,2.2670913E-7,2.4144197E-7,2.5713223E-7,2.7384213E-7,2.9163793E-7,3.1059021E-7,3.3077411E-7,3.5226968E-7,
3.7516214E-7,3.9954229E-7,4.255068E-7,4.5315863E-7,4.8260743E-7,5.1396998E-7,5.4737065E-7,5.8294187E-7,6.2082472E-7,6.6116941E-7,7.0413592E-7,7.4989464E-7,7.9862701E-7,8.505263E-7,9.0579828E-7,9.6466216E-7,1.0273513E-6,1.0941144E-6,1.1652161E-6,1.2409384E-6,1.3215816E-6,1.4074654E-6,1.4989305E-6,1.5963394E-6,1.7000785E-6,1.8105592E-6,1.9282195E-6,2.0535261E-6,2.1869758E-6,2.3290978E-6,2.4804557E-6,2.6416497E-6,2.813319E-6,2.9961443E-6,3.1908506E-6,3.3982101E-6,3.6190449E-6,3.8542308E-6,4.1047004E-6,
4.371447E-6,4.6555282E-6,4.9580707E-6,5.280274E-6,5.623416E-6,5.9888572E-6,6.3780469E-6,6.7925283E-6,7.2339451E-6,7.7040476E-6,8.2047E-6,8.7378876E-6,9.3057248E-6,9.9104632E-6,1.0554501E-5,1.1240392E-5,1.1970856E-5,1.2748789E-5,1.3577278E-5,1.4459606E-5,1.5399272E-5,1.6400004E-5,1.7465768E-5,1.8600792E-5,1.9809576E-5,2.1096914E-5,2.2467911E-5,2.3928002E-5,2.5482978E-5,2.7139006E-5,2.8902651E-5,3.0780908E-5,3.2781225E-5,3.4911534E-5,3.7180282E-5,3.9596466E-5,4.2169667E-5,4.491009E-5,4.7828601E-5,5.0936773E-5,
5.4246931E-5,5.7772202E-5,6.1526565E-5,6.5524908E-5,6.9783085E-5,7.4317983E-5,7.9147585E-5,8.429104E-5,8.9768747E-5,9.5602426E-5,1.0181521E-4,1.0843174E-4,1.1547824E-4,1.2298267E-4,1.3097477E-4,1.3948625E-4,1.4855085E-4,1.5820453E-4,1.6848555E-4,1.7943469E-4,1.9109536E-4,2.0351382E-4,2.1673929E-4,2.3082423E-4,2.4582449E-4,2.6179955E-4,2.7881276E-4,2.9693158E-4,3.1622787E-4,3.3677814E-4,3.5866388E-4,3.8197188E-4,4.0679456E-4,4.3323036E-4,4.6138411E-4,4.9136745E-4,5.2329927E-4,5.5730621E-4,5.9352311E-4,
6.3209358E-4,6.7317058E-4,7.16917E-4,7.635063E-4,8.1312324E-4,8.6596457E-4,9.2223983E-4,9.8217216E-4,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,
.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,
.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1];wa.GL_RGBA16F=34842;wa.GL_RGBA32F=34836;wa.GL_R16F=33325;wa.GL_R32F=33326;wa.GL_DEPTH_COMPONENT24=33190;wa.GL_DEPTH24_STENCIL8=35056;wa.GL_DEPTH32F_STENCIL8=36013;V.bufferSize=1500;W.bufferSize=100;W.triangleBufferSize=100;
X.bufferSize=100;gc.__meta__={fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}};gc.instances=[];fc.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}};fb.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}};P.bufferSize=2E3;K.exposurePattern=new Nc("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i");K.formatPattern=new Nc("FORMAT=32-bit_rle_rgbe",
"i");K.widthHeightPattern=new Nc("-Y ([0-9]+) \\+X ([0-9]+)","i");Mc.todo=[];Pb.loading=[];re.nextId=0;me.main()})("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);